"use strict";var customSelect=document.querySelector(".custom-select"),originalSelect=customSelect.querySelector("select"),originalSelectOptions=Array.from(originalSelect.querySelectorAll("option")),customSelectFocus=customSelect.querySelector(".custom-select__focus"),customSelectFocusText=customSelectFocus.querySelector("span"),customSelectOptionsContainer=customSelect.querySelector(".custom-select__options"),customSelectOptions=[],customSpinbutton=document.querySelector(".spinbutton"),spinButton=customSpinbutton.querySelector('[role="spinbutton"]'),decreaseSpinbutton=customSpinbutton.querySelector("#decrease-people"),increaseSpinbutton=customSpinbutton.querySelector("#increase-people"),reservationForm=document.querySelector(".reservation-form"),nameInput=reservationForm.querySelector('input[name="name"]'),emailInput=reservationForm.querySelector('input[name="email"]'),monthInput=reservationForm.querySelector('input[name="month"]'),dayInput=reservationForm.querySelector('input[name="day"]'),yearInput=reservationForm.querySelector('input[name="year"]'),hourInput=reservationForm.querySelector('input[name="hour"]'),minutesInput=reservationForm.querySelector('input[name="minute"]'),reservationSubmitBtn=reservationForm.querySelector('button[type="submit"]'),CHECK_ICON_URL="./dist/assets/images/icons/icon-check.svg",EMAIL_REGEX=/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,DAY_REGEX=/^(0[1-9])|([1-2]\d)|(3[0-1])$/,MAX_DAYS_IN_MONTH=31,MONTH_REGEX=/^(0[1-9])|(1[0-2])$/,YEAR_REGEX=/^\d{4}$/;function createCustomSelectOptions(){originalSelectOptions.forEach(function(e){e=createCustomOption(e);customSelectOptions.push(e),customSelectOptionsContainer.appendChild(e)})}function createCustomOption(e){var t=document.createElement("span"),r=(t.classList.add("custom-select__option"),t.setAttribute("data-selected",e.selected.toString()),t.setAttribute("data-value",e.value),t.addEventListener("click",handleCustomOption),document.createElement("img")),n=(r.setAttribute("src",CHECK_ICON_URL),r.setAttribute("alt",""),document.createElement("span"));return n.innerText=e.innerText,t.appendChild(r),t.appendChild(n),t}function handleCustomOption(e){var t=e.target;originalSelectOptions.forEach(function(e){return e.selected=e.value===t.dataset.value}),handleSelection(),closeCustomSelect()}function handleSelection(){var t=originalSelectOptions.filter(function(e){return e.selected})[0].value;customSelectFocusText.innerText=t.toUpperCase(),customSelectOptions.forEach(function(e){e.dataset.selected=(e.dataset.value===t).toString()})}function openCustomSelect(){customSelect.dataset.open="true"}function closeCustomSelect(){customSelect.dataset.open="false"}function handleSpinButton(e){switch(e.key){case"ArrowUp":e.preventDefault(),increasePeople();break;case"ArrowDown":e.preventDefault(),decreasePeople();break;case"Home":e.preventDefault(),setMinPeople();break;case"End":e.preventDefault(),setMaxPeople()}}function increasePeople(){var e=Number(spinButton.getAttribute("aria-valuenow")),t=Number(spinButton.getAttribute("aria-valuemax"));updateSpinButton(Math.min(e+1,t))}function decreasePeople(){var e=Number(spinButton.getAttribute("aria-valuenow")),t=Number(spinButton.getAttribute("aria-valuemin"));updateSpinButton(Math.max(e-1,t))}function setMaxPeople(){updateSpinButton(Number(spinButton.getAttribute("aria-valuemax")))}function setMinPeople(){updateSpinButton(Number(spinButton.getAttribute("aria-valuemin")))}function updateSpinButton(e){spinButton.setAttribute("aria-valuenow",e.toString()),spinButton.setAttribute("aria-valuetext","".concat(e," people")),spinButton.innerText="".concat(e," people")}function validateName(){return isBlank(nameInput.value)?displayFormError(nameInput,"This field is required"):removeFormError(nameInput)}function validateEmail(){var e=emailInput.value;return isBlank(e)?displayFormError(emailInput,"This field is required"):isValidEmail(e)?removeFormError(emailInput):displayFormError(emailInput,"Provide a valid email address")}function isValidEmail(e){return EMAIL_REGEX.test(e)}function validateDate(){var e,t,r;return!!(validateDay()&&validateMonth()&&validateYear())&&(e=Number(dayInput.value),t=Number(monthInput.value),r=Number(yearInput.value),new Date(r,t-1,e)<=new Date?displayFormError(yearInput,"Insert date after today"):removeFormError(yearInput))}function validateDay(){var e=dayInput.value;return isBlank(e)?displayFormError(dayInput,"This field is incomplete"):isValidDay(e)?isDayWithinMonthRange(e)?removeFormError(dayInput):displayFormError(dayInput,"Insert day in range of selected month."):displayFormError(dayInput,"Insert valid day value (01 - 31)")}function isDayWithinMonthRange(e){var t=monthInput.value,r=yearInput.value;return!r||!t||(r=new Date(Number(r),Number(t),0).getDate()||MAX_DAYS_IN_MONTH,Number(e)<=r)}function validateMonth(){var e=monthInput.value;return isBlank(e)?displayFormError(monthInput,"This field is incomplete"):isValidMonth(e)?removeFormError(monthInput):displayFormError(monthInput,"Insert valid month value (01 - 12)")}function validateYear(){var e=yearInput.value;return isBlank(e)?displayFormError(yearInput,"This field is incomplete"):isValidYear(e)?removeFormError(yearInput):displayFormError(yearInput,"Insert valid year (4 digit number)")}function isValidDay(e){return DAY_REGEX.test(e)}function isValidMonth(e){return MONTH_REGEX.test(e)}function isValidYear(e){return YEAR_REGEX.test(e)}function isBlank(e){return""===e}function displayFormError(e,t){for(var r,n=e.closest(".form-group");n;){if(n.classList.add("error"),r=n.querySelector(".form-error")){r.innerText=t;break}n=n.parentElement.closest(".form-group")}return!1}function removeFormError(e){for(var t,r=e.closest(".form-group");r;)r.classList.remove("error"),(t=r.querySelector(".form-error"))&&(t.innerText=""),r=r.parentElement.closest(".form-group");return!0}createCustomSelectOptions(),originalSelect.addEventListener("keyup",function(e){switch(e.key){case"ArrowUp":case"ArrowDown":handleSelection();break;case"Enter":handleSelection(),closeCustomSelect()}}),customSelectFocus.addEventListener("click",function(e){originalSelect.focus()}),originalSelect.addEventListener("focusin",openCustomSelect),spinButton.addEventListener("keydown",handleSpinButton),increaseSpinbutton.addEventListener("click",increasePeople),decreaseSpinbutton.addEventListener("click",decreasePeople),reservationSubmitBtn.addEventListener("click",function(e){e.preventDefault(),validateName(),validateEmail(),validateDate()});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInJlc2VydmF0aW9uLWZvcm0udHMiXSwibmFtZXMiOlsiY3VzdG9tU2VsZWN0IiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwib3JpZ2luYWxTZWxlY3QiLCJvcmlnaW5hbFNlbGVjdE9wdGlvbnMiLCJBcnJheSIsImZyb20iLCJxdWVyeVNlbGVjdG9yQWxsIiwiY3VzdG9tU2VsZWN0Rm9jdXMiLCJjdXN0b21TZWxlY3RGb2N1c1RleHQiLCJjdXN0b21TZWxlY3RPcHRpb25zQ29udGFpbmVyIiwiY3VzdG9tU2VsZWN0T3B0aW9ucyIsImN1c3RvbVNwaW5idXR0b24iLCJzcGluQnV0dG9uIiwiZGVjcmVhc2VTcGluYnV0dG9uIiwiaW5jcmVhc2VTcGluYnV0dG9uIiwicmVzZXJ2YXRpb25Gb3JtIiwibmFtZUlucHV0IiwiZW1haWxJbnB1dCIsIm1vbnRoSW5wdXQiLCJkYXlJbnB1dCIsInllYXJJbnB1dCIsImhvdXJJbnB1dCIsIm1pbnV0ZXNJbnB1dCIsInJlc2VydmF0aW9uU3VibWl0QnRuIiwiQ0hFQ0tfSUNPTl9VUkwiLCJFTUFJTF9SRUdFWCIsIkRBWV9SRUdFWCIsIk1BWF9EQVlTX0lOX01PTlRIIiwiTU9OVEhfUkVHRVgiLCJZRUFSX1JFR0VYIiwiY3JlYXRlQ3VzdG9tU2VsZWN0T3B0aW9ucyIsImZvckVhY2giLCJvcHRpb24iLCJjdXN0b21PcHRpb24iLCJjcmVhdGVDdXN0b21PcHRpb24iLCJwdXNoIiwiYXBwZW5kQ2hpbGQiLCJvcHRpb25XcmFwcGVyIiwiY3JlYXRlRWxlbWVudCIsImNoZWNrSW1hZ2UiLCJjbGFzc0xpc3QiLCJhZGQiLCJzZXRBdHRyaWJ1dGUiLCJzZWxlY3RlZCIsInRvU3RyaW5nIiwidmFsdWUiLCJhZGRFdmVudExpc3RlbmVyIiwiaGFuZGxlQ3VzdG9tT3B0aW9uIiwib3B0aW9uVGV4dCIsImlubmVyVGV4dCIsImUiLCJ0YXJnZXQiLCJvcHQiLCJkYXRhc2V0IiwiaGFuZGxlU2VsZWN0aW9uIiwiY2xvc2VDdXN0b21TZWxlY3QiLCJzZWxlY3RlZFZhbHVlIiwiZmlsdGVyIiwidG9VcHBlckNhc2UiLCJvcGVuQ3VzdG9tU2VsZWN0Iiwib3BlbiIsImhhbmRsZVNwaW5CdXR0b24iLCJrZXkiLCJwcmV2ZW50RGVmYXVsdCIsImluY3JlYXNlUGVvcGxlIiwiZGVjcmVhc2VQZW9wbGUiLCJzZXRNaW5QZW9wbGUiLCJzZXRNYXhQZW9wbGUiLCJjdXJyZW50VmFsdWUiLCJOdW1iZXIiLCJnZXRBdHRyaWJ1dGUiLCJtYXhWYWx1ZSIsInVwZGF0ZVNwaW5CdXR0b24iLCJNYXRoIiwibWluIiwibWluVmFsdWUiLCJtYXgiLCJuZXdWYWx1ZSIsImNvbmNhdCIsInZhbGlkYXRlTmFtZSIsImlzQmxhbmsiLCJkaXNwbGF5Rm9ybUVycm9yIiwicmVtb3ZlRm9ybUVycm9yIiwidmFsaWRhdGVFbWFpbCIsImVtYWlsVmFsdWUiLCJpc1ZhbGlkRW1haWwiLCJlbWFpbCIsInRlc3QiLCJ2YWxpZGF0ZURhdGUiLCJkYXkiLCJtb250aCIsInllYXIiLCJ2YWxpZGF0ZURheSIsInZhbGlkYXRlTW9udGgiLCJ2YWxpZGF0ZVllYXIiLCJEYXRlIiwiZGF5VmFsdWUiLCJpc1ZhbGlkRGF5IiwiaXNEYXlXaXRoaW5Nb250aFJhbmdlIiwibW9udGhEYXlzIiwiZ2V0RGF0ZSIsIm1vbnRoVmFsdWUiLCJpc1ZhbGlkTW9udGgiLCJ5ZWFyVmFsdWUiLCJpc1ZhbGlkWWVhciIsImlucHV0IiwibWVzc2FnZSIsImZvcm1FcnJvciIsImZvcm1Hcm91cCIsImNsb3Nlc3QiLCJwYXJlbnRFbGVtZW50IiwicmVtb3ZlIiwiZm9jdXMiXSwibWFwcGluZ3MiOiJhQUNBLElBQU1BLGFBQTRCQyxTQUFTQyxjQUFjLGdCQUFnQixFQUNuRUMsZUFBb0NILGFBQWFFLGNBQWMsUUFBUSxFQUN2RUUsc0JBQWtEQyxNQUFNQyxLQUFLSCxlQUFlSSxpQkFBaUIsUUFBUSxDQUFDLEVBQ3RHQyxrQkFBaUNSLGFBQWFFLGNBQWMsdUJBQXVCLEVBQ25GTyxzQkFBcUNELGtCQUFrQk4s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SXpCNUIsZUFBZTRDLGlCQUFpQixRQUFTLFNBQUNJLEdBQ3pDLE9BQVFBLEVBQUVZLEtBQ1QsSUFBSyxVQUNMLElBQUssWUFDSlIsZ0JBQWUsRUFDZixNQUNELElBQUssUUFDSkEsZ0JBQWUsRUFDZkMsa0JBQWlCLENBQ1gsQ0FFVCxDQUFDLEVBRURoRCxrQkFBa0J1QyxpQkFBaUIsUUFBUyxTQUFDSSxHQUM1Q2hELGVBQWU4RyxNQUFLLENBQ3JCLENBQUMsRUFFRDlHLGVBQWU0QyxpQkFBaUIsVUFBV2EsZ0JBQWdCLEVBRzNEL0MsV0FBV2tDLGlCQUFpQixVQUFXZSxnQkFBZ0IsRUFDdkQvQyxtQkFBbUJnQyxpQkFBaUIsUUFBU2tCLGNBQWMsRUFDM0RuRCxtQkFBbUJpQyxpQkFBaUIsUUFBU21CLGNBQWMsRUFHM0QxQyxxQkFBcUJ1QixpQkFBaUIsUUFBUyxTQUFDSSxHQUMvQ0EsRUFBRWEsZUFBYyxFQUNoQmdCLGFBQVksRUFDWkksY0FBYSxFQUNiSyxhQUFZLENBQ2IsQ0FBQyIsImZpbGUiOiJyZXNlcnZhdGlvbi1mb3JtLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qIGN1c3RvbSBzZWxlY3QgZWxlbWVudHMgKi9cclxuY29uc3QgY3VzdG9tU2VsZWN0OiBIVE1MRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jdXN0b20tc2VsZWN0Jyk7XHJcbmNvbnN0IG9yaWdpbmFsU2VsZWN0OiBIVE1MU2VsZWN0RWxlbWVudCA9IGN1c3RvbVNlbGVjdC5xdWVyeVNlbGVjdG9yKCdzZWxlY3QnKTtcclxuY29uc3Qgb3JpZ2luYWxTZWxlY3RPcHRpb25zOiBBcnJheTxIVE1MT3B0aW9uRWxlbWVudD4gPSBBcnJheS5mcm9tKG9yaWdpbmFsU2VsZWN0LnF1ZXJ5U2VsZWN0b3JBbGwoJ29wdGlvbicpKTtcclxuY29uc3QgY3VzdG9tU2VsZWN0Rm9jdXM6IEhUTUxFbGVtZW50ID0gY3VzdG9tU2VsZWN0LnF1ZXJ5U2VsZWN0b3IoJy5jdXN0b20tc2VsZWN0X19mb2N1cycpO1xyXG5jb25zdCBjdXN0b21TZWxlY3RGb2N1c1RleHQ6IEhUTUxFbGVtZW50ID0gY3VzdG9tU2VsZWN0Rm9jdXMucXVlcnlTZWxlY3Rvcignc3BhbicpO1xyXG5jb25zdCBjdXN0b21TZWxlY3RPcHRpb25zQ29udGFpbmVyOiBIVE1MRWxlbWVudCA9IGN1c3RvbVNlbGVjdC5xdWVyeVNlbGVjdG9yKCcuY3VzdG9tLXNlbGVjdF9fb3B0aW9ucycpO1xyXG5sZXQgY3VzdG9tU2VsZWN0T3B0aW9uczogQXJyYXk8SFRNTEVsZW1lbnQ+ID0gW107XHJcblxyXG4vKiBzcGluYnV0dG9uIGVsZW1lbnRzICovXHJcbmNvbnN0IGN1c3RvbVNwaW5idXR0b246IEhUTUxFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnNwaW5idXR0b24nKTtcclxuY29uc3Qgc3BpbkJ1dHRvbjogSFRNTEVsZW1lbnQgPSBjdXN0b21TcGluYnV0dG9uLnF1ZXJ5U2VsZWN0b3IoJ1tyb2xlPVwic3BpbmJ1dHRvblwiXScpO1xyXG5jb25zdCBkZWNyZWFzZVNwaW5idXR0b246IEhUTUxCdXR0b25FbGVtZW50ID0gY3VzdG9tU3BpbmJ1dHRvbi5xdWVyeVNlbGVjdG9yKCcjZGVjcmVhc2UtcGVvcGxlJyk7XHJcbmNvbnN0IGluY3JlYXNlU3BpbmJ1dHRvbjogSFRNTEJ1dHRvbkVsZW1lbnQgPSBjdXN0b21TcGluYnV0dG9uLnF1ZXJ5U2VsZWN0b3IoJyNpbmNyZWFzZS1wZW9wbGUnKTtcclxuXHJcbi8qIGZvcm0gZWxlbWVudHMgKi9cclxuY29uc3QgcmVzZXJ2YXRpb25Gb3JtOiBIVE1MRm9ybUVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucmVzZXJ2YXRpb24tZm9ybScpO1xyXG5jb25zdCBuYW1lSW5wdXQ6IEhUTUxJbnB1dEVsZW1lbnQgPSByZXNlcnZhdGlvbkZvcm0ucXVlcnlTZWxlY3RvcignaW5wdXRbbmFtZT1cIm5hbWVcIl0nKTtcclxuY29uc3QgZW1haWxJbnB1dDogSFRNTElucHV0RWxlbWVudCA9IHJlc2VydmF0aW9uRm9ybS5xdWVyeVNlbGVjdG9yKCdpbnB1dFtuYW1lPVwiZW1haWxcIl0nKTtcclxuY29uc3QgbW9udGhJbnB1dDogSFRNTElucHV0RWxlbWVudCA9IHJlc2VydmF0aW9uRm9ybS5xdWVyeVNlbGVjdG9yKCdpbnB1dFtuYW1lPVwibW9udGhcIl0nKTtcclxuY29uc3QgZGF5SW5wdXQ6IEhUTUxJbnB1dEVsZW1lbnQgPSByZXNlcnZhdGlvbkZvcm0ucXVlcnlTZWxlY3RvcignaW5wdXRbbmFtZT1cImRheVwiXScpO1xyXG5jb25zdCB5ZWFySW5wdXQ6IEhUTUxJbnB1dEVsZW1lbnQgPSByZXNlcnZhdGlvbkZvcm0ucXVlcnlTZWxlY3RvcignaW5wdXRbbmFtZT1cInllYXJcIl0nKTtcclxuY29uc3QgaG91cklucHV0OiBIVE1MSW5wdXRFbGVtZW50ID0gcmVzZXJ2YXRpb25Gb3JtLnF1ZXJ5U2VsZWN0b3IoJ2lucHV0W25hbWU9XCJob3VyXCJdJyk7XHJcbmNvbnN0IG1pbnV0ZXNJbnB1dDogSFRNTElucHV0RWxlbWVudCA9IHJlc2VydmF0aW9uRm9ybS5xdWVyeVNlbGVjdG9yKCdpbnB1dFtuYW1lPVwibWludXRlXCJdJyk7XHJcbmNvbnN0IHJlc2VydmF0aW9uU3VibWl0QnRuOiBIVE1MQnV0dG9uRWxlbWVudCA9IHJlc2VydmF0aW9uRm9ybS5xdWVyeVNlbGVjdG9yKCdidXR0b25bdHlwZT1cInN1Ym1pdFwiXScpO1xyXG5cclxuLyogY29uc3RhbnRzICovXHJcbmNvbnN0IENIRUNLX0lDT05fVVJMOiBzdHJpbmcgPSAnLi9kaXN0L2Fzc2V0cy9pbWFnZXMvaWNvbnMvaWNvbi1jaGVjay5zdmcnO1xyXG5jb25zdCBFTUFJTF9SRUdFWCA9XHJcblx0L14oKFtePD4oKVtcXF1cXFxcLiw7Olxcc0BcIl0rKFxcLltePD4oKVtcXF1cXFxcLiw7Olxcc0BcIl0rKSopfChcIi4rXCIpKUAoKFxcW1swLTldezEsM31cXC5bMC05XXsxLDN9XFwuWzAtOV17MSwzfVxcLlswLTldezEsM31cXF0pfCgoW2EtekEtWlxcLTAtOV0rXFwuKStbYS16QS1aXXsyLH0pKSQvO1xyXG5jb25zdCBEQVlfUkVHRVggPSAvXigwWzEtOV0pfChbMS0yXVxcZCl8KDNbMC0xXSkkLztcclxuY29uc3QgTUFYX0RBWVNfSU5fTU9OVEggPSAzMTtcclxuY29uc3QgTU9OVEhfUkVHRVggPSAvXigwWzEtOV0pfCgxWzAtMl0pJC87XHJcbmNvbnN0IFlFQVJfUkVHRVggPSAvXlxcZHs0fSQvO1xyXG5cclxuY3JlYXRlQ3VzdG9tU2VsZWN0T3B0aW9ucygpO1xyXG5cclxuLyogZXZlbnQgbGlzdGVuZXJzICovXHJcbi8qIC0tLSBmb3IgY3VzdG9tIHNlbGVjdCAqL1xyXG5vcmlnaW5hbFNlbGVjdC5hZGRFdmVudExpc3RlbmVyKCdrZXl1cCcsIChlOiBLZXlib2FyZEV2ZW50KSA9PiB7XHJcblx0c3dpdGNoIChlLmtleSkge1xyXG5cdFx0Y2FzZSAnQXJyb3dVcCc6XHJcblx0XHRjYXNlICdBcnJvd0Rvd24nOlxyXG5cdFx0XHRoYW5kbGVTZWxlY3Rpb24oKTtcclxuXHRcdFx0YnJlYWs7XHJcblx0XHRjYXNlICdFbnRlcic6XHJcblx0XHRcdGhhbmRsZVNlbGVjdGlvbigpO1xyXG5cdFx0XHRjbG9zZUN1c3RvbVNlbGVjdCgpO1xyXG5cdFx0XHRicmVhaztcclxuXHR9XHJcbn0pO1xyXG5cclxuY3VzdG9tU2VsZWN0Rm9jdXMuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZTogRXZlbnQpID0+IHtcclxuXHRvcmlnaW5hbFNlbGVjdC5mb2N1cygpO1xyXG59KTtcclxuXHJcbm9yaWdpbmFsU2VsZWN0LmFkZEV2ZW50TGlzdGVuZXIoJ2ZvY3VzaW4nLCBvcGVuQ3VzdG9tU2VsZWN0KTtcclxuXHJcbi8qIC0tLSBmb3Igc3BpbmJ1dHRvbiAqL1xyXG5zcGluQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCBoYW5kbGVTcGluQnV0dG9uKTtcclxuaW5jcmVhc2VTcGluYnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgaW5jcmVhc2VQZW9wbGUpO1xyXG5kZWNyZWFzZVNwaW5idXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBkZWNyZWFzZVBlb3BsZSk7XHJcblxyXG4vKiAtLS0gZm9yIHJlc2VydmF0aW9uIGZvcm0gKi9cclxucmVzZXJ2YXRpb25TdWJtaXRCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZTogRXZlbnQpID0+IHtcclxuXHRlLnByZXZlbnREZWZhdWx0KCk7XHJcblx0dmFsaWRhdGVOYW1lKCk7XHJcblx0dmFsaWRhdGVFbWFpbCgpO1xyXG5cdHZhbGlkYXRlRGF0ZSgpO1xyXG59KTtcclxuXHJcbi8qIGhlbHBlciBmdW5jdGlvbnMgKi9cclxuLyogLS0tIGZvciBjdXN0b20gc2VsZWN0ICovXHJcbmZ1bmN0aW9uIGNyZWF0ZUN1c3RvbVNlbGVjdE9wdGlvbnMoKTogdm9pZCB7XHJcblx0b3JpZ2luYWxTZWxlY3RPcHRpb25zLmZvckVhY2gob3B0aW9uID0+IHtcclxuXHRcdGNvbnN0IGN1c3RvbU9wdGlvbjogSFRNTEVsZW1lbnQgPSBjcmVhdGVDdXN0b21PcHRpb24ob3B0aW9uKTtcclxuXHRcdGN1c3RvbVNlbGVjdE9wdGlvbnMucHVzaChjdXN0b21PcHRpb24pO1xyXG5cdFx0Y3VzdG9tU2VsZWN0T3B0aW9uc0NvbnRhaW5lci5hcHBlbmRDaGlsZChjdXN0b21PcHRpb24pO1xyXG5cdH0pO1xyXG59XHJcblxyXG5mdW5jdGlvbiBjcmVhdGVDdXN0b21PcHRpb24ob3B0aW9uOiBIVE1MT3B0aW9uRWxlbWVudCk6IEhUTUxFbGVtZW50IHtcclxuXHRjb25zdCBvcHRpb25XcmFwcGVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpO1xyXG5cdG9wdGlvbldyYXBwZXIuY2xhc3NMaXN0LmFkZCgnY3VzdG9tLXNlbGVjdF9fb3B0aW9uJyk7XHJcblx0b3B0aW9uV3JhcHBlci5zZXRBdHRyaWJ1dGUoJ2RhdGEtc2VsZWN0ZWQnLCBvcHRpb24uc2VsZWN0ZWQudG9TdHJpbmcoKSk7XHJcblx0b3B0aW9uV3JhcHBlci5zZXRBdHRyaWJ1dGUoJ2RhdGEtdmFsdWUnLCBvcHRpb24udmFsdWUpO1xyXG5cdG9wdGlvbldyYXBwZXIuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBoYW5kbGVDdXN0b21PcHRpb24pO1xyXG5cclxuXHRjb25zdCBjaGVja0ltYWdlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW1nJyk7XHJcblx0Y2hlY2tJbWFnZS5zZXRBdHRyaWJ1dGUoJ3NyYycsIENIRUNLX0lDT05fVVJMKTtcclxuXHRjaGVja0ltYWdlLnNldEF0dHJpYnV0ZSgnYWx0JywgJycpO1xyXG5cclxuXHRjb25zdCBvcHRpb25UZXh0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpO1xyXG5cdG9wdGlvblRleHQuaW5uZXJUZXh0ID0gb3B0aW9uLmlubmVyVGV4dDtcclxuXHJcblx0b3B0aW9uV3JhcHBlci5hcHBlbmRDaGlsZChjaGVja0ltYWdlKTtcclxuXHRvcHRpb25XcmFwcGVyLmFwcGVuZENoaWxkKG9wdGlvblRleHQpO1xyXG5cclxuXHRyZXR1cm4gb3B0aW9uV3JhcHBlcjtcclxufVxyXG5cclxuZnVuY3Rpb24gaGFuZGxlQ3VzdG9tT3B0aW9uKGU6IEV2ZW50KTogdm9pZCB7XHJcblx0Y29uc3Qgb3B0aW9uOiBIVE1MRWxlbWVudCA9IGUudGFyZ2V0IGFzIEhUTUxFbGVtZW50O1xyXG5cdG9yaWdpbmFsU2VsZWN0T3B0aW9ucy5mb3JFYWNoKG9wdCA9PiAob3B0LnNlbGVjdGVkID0gb3B0LnZhbHVlID09PSBvcHRpb24uZGF0YXNldC52YWx1ZSkpO1xyXG5cdGhhbmRsZVNlbGVjdGlvbigpO1xyXG5cdGNsb3NlQ3VzdG9tU2VsZWN0KCk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGhhbmRsZVNlbGVjdGlvbigpOiB2b2lkIHtcclxuXHRjb25zdCBzZWxlY3RlZFZhbHVlOiBzdHJpbmcgPSBvcmlnaW5hbFNlbGVjdE9wdGlvbnMuZmlsdGVyKG9wdCA9PiBvcHQuc2VsZWN0ZWQpWzBdLnZhbHVlO1xyXG5cdGN1c3RvbVNlbGVjdEZvY3VzVGV4dC5pbm5lclRleHQgPSBzZWxlY3RlZFZhbHVlLnRvVXBwZXJDYXNlKCk7XHJcblx0Y3VzdG9tU2VsZWN0T3B0aW9ucy5mb3JFYWNoKG9wdGlvbiA9PiB7XHJcblx0XHRvcHRpb24uZGF0YXNldC5zZWxlY3RlZCA9IChvcHRpb24uZGF0YXNldC52YWx1ZSA9PT0gc2VsZWN0ZWRWYWx1ZSkudG9TdHJpbmcoKTtcclxuXHR9KTtcclxufVxyXG5cclxuZnVuY3Rpb24gb3BlbkN1c3RvbVNlbGVjdCgpOiB2b2lkIHtcclxuXHRjdXN0b21TZWxlY3QuZGF0YXNldC5vcGVuID0gJ3RydWUnO1xyXG59XHJcblxyXG5mdW5jdGlvbiBjbG9zZUN1c3RvbVNlbGVjdCgpOiB2b2lkIHtcclxuXHRjdXN0b21TZWxlY3QuZGF0YXNldC5vcGVuID0gJ2ZhbHNlJztcclxufVxyXG5cclxuLyogLS0tIGZvciBzcGluYnV0dG9uICovXHJcbmZ1bmN0aW9uIGhhbmRsZVNwaW5CdXR0b24oZTogS2V5Ym9hcmRFdmVudCk6IHZvaWQge1xyXG5cdHN3aXRjaCAoZS5rZXkpIHtcclxuXHRcdGNhc2UgJ0Fycm93VXAnOlxyXG5cdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XHJcblx0XHRcdGluY3JlYXNlUGVvcGxlKCk7XHJcblx0XHRcdGJyZWFrO1xyXG5cdFx0Y2FzZSAnQXJyb3dEb3duJzpcclxuXHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cdFx0XHRkZWNyZWFzZVBlb3BsZSgpO1xyXG5cdFx0XHRicmVhaztcclxuXHRcdGNhc2UgJ0hvbWUnOlxyXG5cdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XHJcblx0XHRcdHNldE1pblBlb3BsZSgpO1xyXG5cdFx0XHRicmVhaztcclxuXHRcdGNhc2UgJ0VuZCc6XHJcblx0XHRcdGUucHJldmVudERlZmF1bHQoKTtcclxuXHRcdFx0c2V0TWF4UGVvcGxlKCk7XHJcblx0XHRcdGJyZWFrO1xyXG5cdH1cclxufVxyXG5cclxuZnVuY3Rpb24gaW5jcmVhc2VQZW9wbGUoKTogdm9pZCB7XHJcblx0Y29uc3QgY3VycmVudFZhbHVlOiBudW1iZXIgPSBOdW1iZXIoc3BpbkJ1dHRvbi5nZXRBdHRyaWJ1dGUoJ2FyaWEtdmFsdWVub3cnKSk7XHJcblx0Y29uc3QgbWF4VmFsdWU6IG51bWJlciA9IE51bWJlcihzcGluQnV0dG9uLmdldEF0dHJpYnV0ZSgnYXJpYS12YWx1ZW1heCcpKTtcclxuXHRjb25zdCBuZXdWYWx1ZTogbnVtYmVyID0gTWF0aC5taW4oY3VycmVudFZhbHVlICsgMSwgbWF4VmFsdWUpO1xyXG5cdHVwZGF0ZVNwaW5CdXR0b24obmV3VmFsdWUpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBkZWNyZWFzZVBlb3BsZSgpOiB2b2lkIHtcclxuXHRjb25zdCBjdXJyZW50VmFsdWU6IG51bWJlciA9IE51bWJlcihzcGluQnV0dG9uLmdldEF0dHJpYnV0ZSgnYXJpYS12YWx1ZW5vdycpKTtcclxuXHRjb25zdCBtaW5WYWx1ZTogbnVtYmVyID0gTnVtYmVyKHNwaW5CdXR0b24uZ2V0QXR0cmlidXRlKCdhcmlhLXZhbHVlbWluJykpO1xyXG5cdGNvbnN0IG5ld1ZhbHVlOiBudW1iZXIgPSBNYXRoLm1heChjdXJyZW50VmFsdWUgLSAxLCBtaW5WYWx1ZSk7XHJcblx0dXBkYXRlU3BpbkJ1dHRvbihuZXdWYWx1ZSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHNldE1heFBlb3BsZSgpIHtcclxuXHRjb25zdCBtYXhWYWx1ZTogbnVtYmVyID0gTnVtYmVyKHNwaW5CdXR0b24uZ2V0QXR0cmlidXRlKCdhcmlhLXZhbHVlbWF4JykpO1xyXG5cdHVwZGF0ZVNwaW5CdXR0b24obWF4VmFsdWUpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBzZXRNaW5QZW9wbGUoKSB7XHJcblx0Y29uc3QgbWluVmFsdWU6IG51bWJlciA9IE51bWJlcihzcGluQnV0dG9uLmdldEF0dHJpYnV0ZSgnYXJpYS12YWx1ZW1pbicpKTtcclxuXHR1cGRhdGVTcGluQnV0dG9uKG1pblZhbHVlKTtcclxufVxyXG5cclxuZnVuY3Rpb24gdXBkYXRlU3BpbkJ1dHRvbihuZXdWYWx1ZTogbnVtYmVyKTogdm9pZCB7XHJcblx0c3BpbkJ1dHRvbi5zZXRBdHRyaWJ1dGUoJ2FyaWEtdmFsdWVub3cnLCBuZXdWYWx1ZS50b1N0cmluZygpKTtcclxuXHRzcGluQnV0dG9uLnNldEF0dHJpYnV0ZSgnYXJpYS12YWx1ZXRleHQnLCBgJHtuZXdWYWx1ZX0gcGVvcGxlYCk7XHJcblx0c3BpbkJ1dHRvbi5pbm5lclRleHQgPSBgJHtuZXdWYWx1ZX0gcGVvcGxlYDtcclxufVxyXG5cclxuLyogLS0tIGZvciBmb3JtIHZhbGlkYXRpb24gKi9cclxuLyogLS0tIC0tLSBuYW1lIHZhbGlkYXRpb24gKi9cclxuZnVuY3Rpb24gdmFsaWRhdGVOYW1lKCk6IGJvb2xlYW4ge1xyXG5cdGNvbnN0IG5hbWVWYWx1ZTogc3RyaW5nID0gbmFtZUlucHV0LnZhbHVlO1xyXG5cclxuXHRpZiAoaXNCbGFuayhuYW1lVmFsdWUpKSByZXR1cm4gZGlzcGxheUZvcm1FcnJvcihuYW1lSW5wdXQsICdUaGlzIGZpZWxkIGlzIHJlcXVpcmVkJyk7XHJcblxyXG5cdHJldHVybiByZW1vdmVGb3JtRXJyb3IobmFtZUlucHV0KTtcclxufVxyXG5cclxuLyogLS0tIC0tLSBlbWFpbCB2YWxpZGF0aW9uICovXHJcbmZ1bmN0aW9uIHZhbGlkYXRlRW1haWwoKTogYm9vbGVhbiB7XHJcblx0Y29uc3QgZW1haWxWYWx1ZTogc3RyaW5nID0gZW1haWxJbnB1dC52YWx1ZTtcclxuXHJcblx0aWYgKGlzQmxhbmsoZW1haWxWYWx1ZSkpIHJldHVybiBkaXNwbGF5Rm9ybUVycm9yKGVtYWlsSW5wdXQsICdUaGlzIGZpZWxkIGlzIHJlcXVpcmVkJyk7XHJcblx0aWYgKCFpc1ZhbGlkRW1haWwoZW1haWxWYWx1ZSkpIHJldHVybiBkaXNwbGF5Rm9ybUVycm9yKGVtYWlsSW5wdXQsICdQcm92aWRlIGEgdmFsaWQgZW1haWwgYWRkcmVzcycpO1xyXG5cclxuXHRyZXR1cm4gcmVtb3ZlRm9ybUVycm9yKGVtYWlsSW5wdXQpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBpc1ZhbGlkRW1haWwoZW1haWw6IHN0cmluZykge1xyXG5cdHJldHVybiBFTUFJTF9SRUdFWC50ZXN0KGVtYWlsKTtcclxufVxyXG5cclxuLyogLS0tIC0tLSBkYXRlIHZhbGlkYXRpb24gKi9cclxuZnVuY3Rpb24gdmFsaWRhdGVEYXRlKCk6IGJvb2xlYW4ge1xyXG5cdGlmICh2YWxpZGF0ZURheSgpICYmIHZhbGlkYXRlTW9udGgoKSAmJiB2YWxpZGF0ZVllYXIoKSkge1xyXG5cdFx0Y29uc3QgZGF5OiBudW1iZXIgPSBOdW1iZXIoZGF5SW5wdXQudmFsdWUpO1xyXG5cdFx0Y29uc3QgbW9udGg6IG51bWJlciA9IE51bWJlcihtb250aElucHV0LnZhbHVlKTtcclxuXHRcdGNvbnN0IHllYXI6IG51bWJlciA9IE51bWJlcih5ZWFySW5wdXQudmFsdWUpO1xyXG5cclxuXHRcdGlmIChuZXcgRGF0ZSh5ZWFyLCBtb250aCAtIDEsIGRheSkgPD0gbmV3IERhdGUoKSkgcmV0dXJuIGRpc3BsYXlGb3JtRXJyb3IoeWVhcklucHV0LCAnSW5zZXJ0IGRhdGUgYWZ0ZXIgdG9kYXknKTtcclxuXHJcblx0XHRyZXR1cm4gcmVtb3ZlRm9ybUVycm9yKHllYXJJbnB1dCk7XHJcblx0fSBlbHNlIHtcclxuXHRcdHJldHVybiBmYWxzZTtcclxuXHR9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHZhbGlkYXRlRGF5KCk6IGJvb2xlYW4ge1xyXG5cdGNvbnN0IGRheVZhbHVlOiBzdHJpbmcgPSBkYXlJbnB1dC52YWx1ZTtcclxuXHJcblx0aWYgKGlzQmxhbmsoZGF5VmFsdWUpKSByZXR1cm4gZGlzcGxheUZvcm1FcnJvcihkYXlJbnB1dCwgJ1RoaXMgZmllbGQgaXMgaW5jb21wbGV0ZScpO1xyXG5cdGlmICghaXNWYWxpZERheShkYXlWYWx1ZSkpIHJldHVybiBkaXNwbGF5Rm9ybUVycm9yKGRheUlucHV0LCAnSW5zZXJ0IHZhbGlkIGRheSB2YWx1ZSAoMDEgLSAzMSknKTtcclxuXHRpZiAoIWlzRGF5V2l0aGluTW9udGhSYW5nZShkYXlWYWx1ZSkpIHJldHVybiBkaXNwbGF5Rm9ybUVycm9yKGRheUlucHV0LCAnSW5zZXJ0IGRheSBpbiByYW5nZSBvZiBzZWxlY3RlZCBtb250aC4nKTtcclxuXHJcblx0cmV0dXJuIHJlbW92ZUZvcm1FcnJvcihkYXlJbnB1dCk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGlzRGF5V2l0aGluTW9udGhSYW5nZShkYXk6IHN0cmluZyk6IGJvb2xlYW4ge1xyXG5cdGNvbnN0IG1vbnRoOiBzdHJpbmcgPSBtb250aElucHV0LnZhbHVlO1xyXG5cdGNvbnN0IHllYXI6IHN0cmluZyA9IHllYXJJbnB1dC52YWx1ZTtcclxuXHJcblx0aWYgKCF5ZWFyIHx8ICFtb250aCkgcmV0dXJuIHRydWU7XHJcblx0Y29uc3QgbW9udGhEYXlzOiBudW1iZXIgPSBuZXcgRGF0ZShOdW1iZXIoeWVhciksIE51bWJlcihtb250aCksIDApLmdldERhdGUoKSB8fCBNQVhfREFZU19JTl9NT05USDtcclxuXHRyZXR1cm4gTnVtYmVyKGRheSkgPD0gbW9udGhEYXlzO1xyXG59XHJcblxyXG5mdW5jdGlvbiB2YWxpZGF0ZU1vbnRoKCk6IGJvb2xlYW4ge1xyXG5cdGNvbnN0IG1vbnRoVmFsdWU6IHN0cmluZyA9IG1vbnRoSW5wdXQudmFsdWU7XHJcblxyXG5cdGlmIChpc0JsYW5rKG1vbnRoVmFsdWUpKSByZXR1cm4gZGlzcGxheUZvcm1FcnJvcihtb250aElucHV0LCAnVGhpcyBmaWVsZCBpcyBpbmNvbXBsZXRlJyk7XHJcblx0aWYgKCFpc1ZhbGlkTW9udGgobW9udGhWYWx1ZSkpIHJldHVybiBkaXNwbGF5Rm9ybUVycm9yKG1vbnRoSW5wdXQsICdJbnNlcnQgdmFsaWQgbW9udGggdmFsdWUgKDAxIC0gMTIpJyk7XHJcblxyXG5cdHJldHVybiByZW1vdmVGb3JtRXJyb3IobW9udGhJbnB1dCk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHZhbGlkYXRlWWVhcigpOiBib29sZWFuIHtcclxuXHRjb25zdCB5ZWFyVmFsdWU6IHN0cmluZyA9IHllYXJJbnB1dC52YWx1ZTtcclxuXHJcblx0aWYgKGlzQmxhbmsoeWVhclZhbHVlKSkgcmV0dXJuIGRpc3BsYXlGb3JtRXJyb3IoeWVhcklucHV0LCAnVGhpcyBmaWVsZCBpcyBpbmNvbXBsZXRlJyk7XHJcblx0aWYgKCFpc1ZhbGlkWWVhcih5ZWFyVmFsdWUpKSByZXR1cm4gZGlzcGxheUZvcm1FcnJvcih5ZWFySW5wdXQsICdJbnNlcnQgdmFsaWQgeWVhciAoNCBkaWdpdCBudW1iZXIpJyk7XHJcblxyXG5cdHJldHVybiByZW1vdmVGb3JtRXJyb3IoeWVhcklucHV0KTtcclxufVxyXG5cclxuZnVuY3Rpb24gaXNWYWxpZERheShkYXk6IHN0cmluZykge1xyXG5cdHJldHVybiBEQVlfUkVHRVgudGVzdChkYXkpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBpc1ZhbGlkTW9udGgobW9udGg6IHN0cmluZykge1xyXG5cdHJldHVybiBNT05USF9SRUdFWC50ZXN0KG1vbnRoKTtcclxufVxyXG5cclxuZnVuY3Rpb24gaXNWYWxpZFllYXIoeWVhcjogc3RyaW5nKSB7XHJcblx0cmV0dXJuIFlFQVJfUkVHRVgudGVzdCh5ZWFyKTtcclxufVxyXG5cclxuLyogLS0tIC0tLSBnZW5lcmFsIGZvcm0gdmFsaWRhdGlvbiAqL1xyXG5mdW5jdGlvbiBpc0JsYW5rKHZhbHVlOiBzdHJpbmcpOiBib29sZWFuIHtcclxuXHRyZXR1cm4gdmFsdWUgPT09ICcnO1xyXG59XHJcbi8qIC0tLSAtLS0gZm9ybSBlcnJvciBkaXNwbGF5aW5nICovXHJcbmZ1bmN0aW9uIGRpc3BsYXlGb3JtRXJyb3IoaW5wdXQ6IEhUTUxJbnB1dEVsZW1lbnQsIG1lc3NhZ2U6IHN0cmluZyk6IGJvb2xlYW4ge1xyXG5cdGxldCBmb3JtR3JvdXA6IEhUTUxFbGVtZW50ID0gaW5wdXQuY2xvc2VzdCgnLmZvcm0tZ3JvdXAnKTtcclxuXHRsZXQgZm9ybUVycm9yOiBIVE1MRWxlbWVudDtcclxuXHJcblx0d2hpbGUgKGZvcm1Hcm91cCkge1xyXG5cdFx0Zm9ybUdyb3VwLmNsYXNzTGlzdC5hZGQoJ2Vycm9yJyk7XHJcblx0XHRmb3JtRXJyb3IgPSBmb3JtR3JvdXAucXVlcnlTZWxlY3RvcignLmZvcm0tZXJyb3InKTtcclxuXHJcblx0XHRpZiAoZm9ybUVycm9yKSB7XHJcblx0XHRcdGZvcm1FcnJvci5pbm5lclRleHQgPSBtZXNzYWdlO1xyXG5cdFx0XHRicmVhaztcclxuXHRcdH1cclxuXHJcblx0XHRmb3JtR3JvdXAgPSBmb3JtR3JvdXAucGFyZW50RWxlbWVudC5jbG9zZXN0KCcuZm9ybS1ncm91cCcpO1xyXG5cdH1cclxuXHJcblx0cmV0dXJuIGZhbHNlO1xyXG59XHJcblxyXG5mdW5jdGlvbiByZW1vdmVGb3JtRXJyb3IoaW5wdXQ6IEhUTUxJbnB1dEVsZW1lbnQpOiBib29sZWFuIHtcclxuXHRsZXQgZm9ybUdyb3VwOiBIVE1MRWxlbWVudCA9IGlucHV0LmNsb3Nlc3QoJy5mb3JtLWdyb3VwJyk7XHJcblx0bGV0IGZvcm1FcnJvcjogSFRNTEVsZW1lbnQ7XHJcblxyXG5cdHdoaWxlIChmb3JtR3JvdXApIHtcclxuXHRcdGZvcm1Hcm91cC5jbGFzc0xpc3QucmVtb3ZlKCdlcnJvcicpO1xyXG5cdFx0Zm9ybUVycm9yID0gZm9ybUdyb3VwLnF1ZXJ5U2VsZWN0b3IoJy5mb3JtLWVycm9yJyk7XHJcblxyXG5cdFx0aWYgKGZvcm1FcnJvcikgZm9ybUVycm9yLmlubmVyVGV4dCA9ICcnO1xyXG5cclxuXHRcdGZvcm1Hcm91cCA9IGZvcm1Hcm91cC5wYXJlbnRFbGVtZW50LmNsb3Nlc3QoJy5mb3JtLWdyb3VwJyk7XHJcblx0fVxyXG5cclxuXHRyZXR1cm4gdHJ1ZTtcclxufVxyXG4iXX0=
