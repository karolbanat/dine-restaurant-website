"use strict";var customSelect=document.querySelector(".custom-select"),originalSelect=customSelect.querySelector("select"),originalSelectOptions=Array.from(originalSelect.querySelectorAll("option")),customSelectFocus=customSelect.querySelector(".custom-select__focus"),customSelectFocusText=customSelectFocus.querySelector("span"),customSelectOptionsContainer=customSelect.querySelector(".custom-select__options"),customSelectOptions=[],customSpinbutton=document.querySelector(".spinbutton"),spinButton=customSpinbutton.querySelector('[role="spinbutton"]'),decreaseSpinbutton=customSpinbutton.querySelector("#decrease-people"),increaseSpinbutton=customSpinbutton.querySelector("#increase-people"),reservationForm=document.querySelector(".reservation-form"),nameInput=reservationForm.querySelector('input[name="name"]'),emailInput=reservationForm.querySelector('input[name="email"]'),monthInput=reservationForm.querySelector('input[name="month"]'),dayInput=reservationForm.querySelector('input[name="day"]'),yearInput=reservationForm.querySelector('input[name="year"]'),hourInput=reservationForm.querySelector('input[name="hour"]'),minutesInput=reservationForm.querySelector('input[name="minute"]'),reservationSubmitBtn=reservationForm.querySelector('button[type="submit"]'),CHECK_ICON_URL="./dist/assets/images/icons/icon-check.svg",EMAIL_REGEX=/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,DAY_REGEX=/^(0[1-9])|([1-2]\d)|(3[0-1])$/,MAX_DAYS_IN_MONTH=31,MONTH_REGEX=/^(0[1-9])|(1[0-2])$/,YEAR_REGEX=/^\d{4}$/,HOUR_REGEX=/^(0[1-9])|(1[0-2])$/,MINUTES_REGEX=/^([0-5]\d)$/,MONDAY_CODE=1,FRIDAY_CODE=5,SATURDAY_CODE=6,SUNDAY_CODE=0;function createCustomSelectOptions(){originalSelectOptions.forEach(function(e){e=createCustomOption(e);customSelectOptions.push(e),customSelectOptionsContainer.appendChild(e)})}function createCustomOption(e){var t=document.createElement("span"),r=(t.classList.add("custom-select__option"),t.setAttribute("data-selected",e.selected.toString()),t.setAttribute("data-value",e.value),t.addEventListener("click",handleCustomOption),document.createElement("img")),n=(r.setAttribute("src",CHECK_ICON_URL),r.setAttribute("alt",""),document.createElement("span"));return n.innerText=e.innerText,t.appendChild(r),t.appendChild(n),t}function handleCustomOption(e){var t=e.target;originalSelectOptions.forEach(function(e){return e.selected=e.value===t.dataset.value}),handleSelection(),closeCustomSelect()}function handleSelection(){var t=originalSelectOptions.filter(function(e){return e.selected})[0].value;customSelectFocusText.innerText=t.toUpperCase(),customSelectOptions.forEach(function(e){e.dataset.selected=(e.dataset.value===t).toString()})}function openCustomSelect(){customSelect.dataset.open="true"}function closeCustomSelect(){customSelect.dataset.open="false"}function handleSpinButton(e){switch(e.key){case"ArrowUp":e.preventDefault(),increasePeople();break;case"ArrowDown":e.preventDefault(),decreasePeople();break;case"Home":e.preventDefault(),setMinPeople();break;case"End":e.preventDefault(),setMaxPeople()}}function increasePeople(){var e=Number(spinButton.getAttribute("aria-valuenow")),t=Number(spinButton.getAttribute("aria-valuemax"));updateSpinButton(Math.min(e+1,t))}function decreasePeople(){var e=Number(spinButton.getAttribute("aria-valuenow")),t=Number(spinButton.getAttribute("aria-valuemin"));updateSpinButton(Math.max(e-1,t))}function setMaxPeople(){updateSpinButton(Number(spinButton.getAttribute("aria-valuemax")))}function setMinPeople(){updateSpinButton(Number(spinButton.getAttribute("aria-valuemin")))}function updateSpinButton(e){spinButton.setAttribute("aria-valuenow",e.toString()),spinButton.setAttribute("aria-valuetext","".concat(e," people")),spinButton.innerText="".concat(e," people")}function validateName(){return isBlank(nameInput.value)?displayFormError(nameInput,"This field is required"):removeFormError(nameInput)}function validateEmail(){var e=emailInput.value;return isBlank(e)?displayFormError(emailInput,"This field is required"):isValidEmail(e)?removeFormError(emailInput):displayFormError(emailInput,"Provide a valid email address")}function isValidEmail(e){return EMAIL_REGEX.test(e)}function validateDate(){var e,t;return!!(validateDay()&&validateMonth()&&validateYear())&&(e=Number(dayInput.value),t=Number(monthInput.value),isDateAfterToday(Number(yearInput.value),t,e)?removeFormError(yearInput):displayFormError(yearInput,"Insert date after today"))}function validateDay(){var e=dayInput.value;return isBlank(e)?displayFormError(dayInput,"This field is incomplete"):isValidDay(e)?isDayWithinMonthRange(e)?removeFormError(dayInput):displayFormError(dayInput,"Insert day in range of selected month."):displayFormError(dayInput,"Insert valid day value (01 - 31)")}function isDateAfterToday(e,t,r){return new Date(e,t-1,r)>new Date}function isDayWithinMonthRange(e){var t=monthInput.value,r=yearInput.value;return!r||!t||(r=new Date(Number(r),Number(t),0).getDate()||MAX_DAYS_IN_MONTH,Number(e)<=r)}function validateMonth(){var e=monthInput.value;return isBlank(e)?displayFormError(monthInput,"This field is incomplete"):isValidMonth(e)?removeFormError(monthInput):displayFormError(monthInput,"Insert valid month value (01 - 12)")}function validateYear(){var e=yearInput.value;return isBlank(e)?displayFormError(yearInput,"This field is incomplete"):isValidYear(e)?removeFormError(yearInput):displayFormError(yearInput,"Insert valid year (4 digit number)")}function isValidDay(e){return DAY_REGEX.test(e)}function isValidMonth(e){return MONTH_REGEX.test(e)}function isValidYear(e){return YEAR_REGEX.test(e)}function validateTime(){return!(!validateHour()||!validateMinutes())&&(isTimeBetweenOpenHours()?removeFormError(hourInput):displayFormError(hourInput,"Insert time between open hours"))}function isTimeBetweenOpenHours(){var e=Number(hourInput.value),t=Number(minutesInput.value),r=new Date(Number(yearInput.value),Number(monthInput.value)-1,Number(dayInput.value)).getDay(),n=originalSelect.value;return!Number.isNaN(e)&&!Number.isNaN(t)&&!Number.isNaN(r)&&("am"===n?isBetweenMorningHours(e):isBetweenAfternoonHours(e,t,r))}function isBetweenMorningHours(e){return 9<=e&&e<12}function isBetweenAfternoonHours(e,t,r){return r<=FRIDAY_CODE&&MONDAY_CODE<=r?12===e||e<10:r!==SATURDAY_CODE&&r!==SUNDAY_CODE||12===e||e<11||11===e&&t<30}function validateHour(){var e=hourInput.value;return isBlank(e)?displayFormError(hourInput,"This field is incomplete"):isValidHour(e)?removeFormError(hourInput):displayFormError(hourInput,"Insert valid hour format (01 - 12)")}function validateMinutes(){var e=minutesInput.value;return isBlank(e)?displayFormError(minutesInput,"This field is incomplete"):areValidMinutes(e)?removeFormError(minutesInput):displayFormError(minutesInput,"Insert valid minutes format (00 - 59)")}function isValidHour(e){return HOUR_REGEX.test(e)}function areValidMinutes(e){return MINUTES_REGEX.test(e)}function isBlank(e){return""===e}function displayFormError(e,t){for(var r,n=e.closest(".form-group");n;){if(n.classList.add("error"),r=n.querySelector(".form-error")){r.innerText=t;break}n=n.parentElement.closest(".form-group")}return!1}function removeFormError(e){for(var t,r=e.closest(".form-group");r;)r.classList.remove("error"),(t=r.querySelector(".form-error"))&&(t.innerText=""),r=r.parentElement.closest(".form-group");return!0}createCustomSelectOptions(),originalSelect.addEventListener("keyup",function(e){switch(e.key){case"ArrowUp":case"ArrowDown":case"ArrowLeft":case"ArrowRight":handleSelection();break;case"Enter":handleSelection(),closeCustomSelect()}}),customSelectFocus.addEventListener("click",function(e){originalSelect.focus()}),originalSelect.addEventListener("focusin",openCustomSelect),spinButton.addEventListener("keydown",handleSpinButton),increaseSpinbutton.addEventListener("click",increasePeople),decreaseSpinbutton.addEventListener("click",decreasePeople),reservationSubmitBtn.addEventListener("click",function(e){e.preventDefault();var e=validateName(),t=validateEmail(),r=validateDate(),n=validateTime();e&&t&&r&&n?reservationForm.setAttribute("data-valid","true"):reservationForm.removeAttribute("data-valid")});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInJlc2VydmF0aW9uLWZvcm0udHMiLCJyZXNlcnZhdGlvbi1mb3JtLmpzIl0sIm5hbWVzIjpbImN1c3RvbVNlbGVjdCIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsIm9yaWdpbmFsU2VsZWN0Iiwib3JpZ2luYWxTZWxlY3RPcHRpb25zIiwiQXJyYXkiLCJmcm9tIiwicXVlcnlTZWxlY3RvckFsbCIsImN1c3RvbVNlbGVjdEZvY3VzIiwiY3VzdG9tU2VsZWN0Rm9jdXNUZXh0IiwiY3VzdG9tU2VsZWN0T3B0aW9uc0NvbnRhaW5lciIsImN1c3RvbVNlbGVjdE9wdGlvbnMiLCJjdXN0b21TcGluYnV0dG9uIiwic3BpbkJ1dHRvbiIsImRlY3JlYXNlU3BpbmJ1dHRvbiIsImluY3JlYXNlU3BpbmJ1dHRvbiIsInJlc2VydmF0aW9uRm9ybSIsIm5hbWVJbnB1dCIsImVtYWlsSW5wdXQiLCJtb250aElucHV0IiwiZGF5SW5wdXQiLCJ5ZWFySW5wdXQiLCJob3VySW5wdXQiLCJtaW51dGVzSW5wdXQiLCJyZXNlcnZhdGlvblN1Ym1pdEJ0biIsIkNIRUNLX0lDT05fVVJMIiwiRU1BSUxfUkVHRVgiLCJEQVlfUkVHRVgiLCJNQVhfREFZU19JTl9NT05USCIsIk1PTlRIX1JFR0VYIiwiWUVBUl9SRUdFWCIsIkhPVVJfUkVHRVgiLCJNSU5VVEVTX1JFR0VYIiwiTU9OREFZX0NPREUiLCJGUklEQVlfQ09ERSIsIlNBVFVSREFZX0NPREUiLCJTVU5EQVlfQ09ERSIsImNyZWF0ZUN1c3RvbVNlbGVjdE9wdGlvbnMiLCJmb3JFYWNoIiwib3B0aW9uIiwiY3VzdG9tT3B0aW9uIiwiY3JlYXRlQ3VzdG9tT3B0aW9uIiwicHVzaCIsImFwcGVuZENoaWxkIiwib3B0aW9uV3JhcHBlciIsImNyZWF0ZUVsZW1lbnQiLCJjaGVja0ltYWdlIiwiY2xhc3NMaXN0IiwiYWRkIiwic2V0QXR0cmlidXRlIiwic2VsZWN0ZWQiLCJ0b1N0cmluZyIsInZhbHVlIiwiYWRkRXZlbnRMaXN0ZW5lciIsImhhbmRsZUN1c3RvbU9wdGlvbiIsIm9wdGlvblRleHQiLCJpbm5lclRleHQiLCJlIiwidGFyZ2V0Iiwib3B0IiwiZGF0YXNldCIsImhhbmRsZVNlbGVjdGlvbiIsImNsb3NlQ3VzdG9tU2VsZWN0Iiwic2VsZWN0ZWRWYWx1ZSIsImZpbHRlciIsInRvVXBwZXJDYXNlIiwib3BlbkN1c3RvbVNlbGVjdCIsIm9wZW4iLCJoYW5kbGVTcGluQnV0dG9uIiwia2V5IiwicHJldmVudERlZmF1bHQiLCJpbmNyZWFzZVBlb3BsZSIsImRlY3JlYXNlUGVvcGxlIiwic2V0TWluUGVvcGxlIiwic2V0TWF4UGVvcGxlIiwiY3VycmVudFZhbHVlIiwiTnVtYmVyIiwiZ2V0QXR0cmlidXRlIiwibWF4VmFsdWUiLCJ1cGRhdGVTcGluQnV0dG9uIiwiTWF0aCIsIm1pbiIsIm1pblZhbHVlIiwibWF4IiwibmV3VmFsdWUiLCJjb25jYXQiLCJ2YWxpZGF0ZU5hbWUiLCJpc0JsYW5rIiwiZGlzcGxheUZvcm1FcnJvciIsInJlbW92ZUZvcm1FcnJvciIsInZhbGlkYXRlRW1haWwiLCJlbWFpbFZhbHVlIiwiaXNWYWxpZEVtYWlsIiwiZW1haWwiLCJ0ZXN0IiwidmFsaWRhdGVEYXRlIiwiZGF5IiwibW9udGgiLCJ2YWxpZGF0ZURheSIsInZhbGlkYXRlTW9udGgiLCJ2YWxpZGF0ZVllYXIiLCJpc0RhdGVBZnRlclRvZGF5IiwiZGF5VmFsdWUiLCJpc1ZhbGlkRGF5IiwiaXNEYXlXaXRoaW5Nb250aFJhbmdlIiwieWVhciIsIkRhdGUiLCJtb250aERheXMiLCJnZXREYXRlIiwibW9udGhWYWx1ZSIsImlzVmFsaWRNb250aCIsInllYXJWYWx1ZSIsImlzVmFsaWRZZWFyIiwidmFsaWRhdGVUaW1lIiwidmFsaWRhdGVIb3VyIiwidmFsaWRhdGVNaW51dGVzIiwiaXNUaW1lQmV0d2Vlbk9wZW5Ib3VycyIsImhvdXIiLCJtaW51dGVzIiwid2Vla0RheSIsImdldERheSIsImRheVRpbWUiLCJpc05hTiIsImlzQmV0d2Vlbk1vcm5pbmdIb3VycyIsImlzQmV0d2VlbkFmdGVybm9vbkhvdXJzIiwid2Vla0RheUNvZGUiLCJob3VyVmFsdWUiLCJpc1ZhbGlkSG91ciIsIm1pbnV0ZXNWYWx1ZSIsImFyZVZhbGlkTWludXRlcyIsImlucHV0IiwibWVzc2FnZSIsImZvcm1FcnJvciIsImZvcm1Hcm91cCIsImNsb3Nlc3QiLCJwYXJlbnRFbGVtZW50IiwicmVtb3ZlIiwiZm9jdXMiLCJpc05hbWVWYWxpZCIsImlzRW1haWxWYWxpZCIsImlzRGF0ZVZhbGlkIiwiaXNUaW1lVmFsaWQiLCJyZW1vdmVBdHRyaWJ1dGUiXSwibWFwcGluZ3MiOiJhQUNBLElBQU1BLGFBQTRCQyxTQUFTQyxjQUFjLGdCQUFnQixFQUNuRUMsZUFBb0NILGFBQWFFLGNBQWMsUUFBUSxFQUN2RUUsc0JBQWtEQyxNQUFNQyxLQUFLSCxlQUFlSSxpQkFBaUIsUUFBUSxDQUFDLEVBQ3RHQyxrQkFBaUNSLGFBQWFFLGNBQWMsdUJBQXVCLEVBQ25GTyxzQkFBcUNELGtCQUFrQk4sY0FBYyxNQUFNLEVBQzNFUSw2QkFBNENWLGFBQWFFLGNBQWMseUJBQXlCLEVBQ2xHUyxvQkFBMEMsR0FHeENDLGlCQUFnQ1gsU0FBU0MsY0FBYyxhQUFhLEVBQ3BFVyxXQUEwQkQsaUJBQWlCVixjQUFjLHFCQUFxQixFQUM5RVksbUJBQXdDRixpQkFBaUJWLGNBQWMsa0JBQWtCLEVBQ3pGYSxtQkFBd0NILGlCQUFpQlYsY0FBYyxrQkFBa0IsRUFHekZjLGdCQUFtQ2YsU0FBU0MsY0FBYyxtQkFBbUIsRUFDN0VlLFVBQThCRCxnQkFBZ0JkLGNBQWMsb0JBQW9CLEVBQ2hGZ0IsV0FBK0JGLGdCQUFnQmQsY0FBYyxxQkFBcUIsRUFDbEZpQixXQUErQkgsZ0JBQWdCZCxjQUFjLHFCQUFxQixFQUNsRmtCLFNBQTZCSixnQkFBZ0JkLGNBQWMsbUJBQW1CLEVBQzlFbUIsVUFBOEJMLGdCQUFnQmQsY0FBYyxvQkFBb0IsRUFDaEZvQixVQUE4Qk4sZ0JBQWdCZCxjQUFjLG9CQUFvQixFQUNoRnFCLGFBQWlD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QVMsU0FBQ0ksR0FDekMsT0FBUUEsRUFBRVksS0FDVCxJQUFLLFVBQ0wsSUFBSyxZQUNMLElBQUssWUFDTCxJQUFLLGFBQ0pSLGdCQUFlLEVBQ2YsTUFDRCxJQUFLLFFBQ0pBLGdCQUFlLEVBQ2ZDLGtCQUFpQixDQUNYLENBRVQsQ0FBQyxFQUVEdEQsa0JBQWtCNkMsaUJBQWlCLFFBQVMsU0FBQ0ksR0FDNUN0RCxlQUFlc0ksTUFBSyxDQUNyQixDQUFDLEVBRUR0SSxlQUFla0QsaUJBQWlCLFVBQVdhLGdCQUFnQixFQUczRHJELFdBQVd3QyxpQkFBaUIsVUFBV2UsZ0JBQWdCLEVBQ3ZEckQsbUJBQW1Cc0MsaUJBQWlCLFFBQVNrQixjQUFjLEVBQzNEekQsbUJBQW1CdUMsaUJBQWlCLFFBQVNtQixjQUFjLEVBRzNEaEQscUJBQXFCNkIsaUJBQWlCLFFBQVMsU0FBQ0ksR0FDL0NBLEVBQUVhLGVBQWMsRUFDaEIsSUFBTW9FLEVBQXVCcEQsYUFBWSxFQUNuQ3FELEVBQXdCakQsY0FBYSxFQUNyQ2tELEVBQXVCN0MsYUFBWSxFQUNuQzhDLEVBQXVCNUIsYUFBWSxFQUVyQ3lCLEdBQWVDLEdBQWdCQyxHQUFlQyxFQUNqRDdILGdCQUFnQmlDLGFBQWEsYUFBYyxNQUFNLEVBRWpEakMsZ0JBQWdCOEgsZ0JBQWdCLFlBQVksQ0FFOUMsQ0FBQyIsImZpbGUiOiJyZXNlcnZhdGlvbi1mb3JtLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qIGN1c3RvbSBzZWxlY3QgZWxlbWVudHMgKi9cclxuY29uc3QgY3VzdG9tU2VsZWN0OiBIVE1MRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jdXN0b20tc2VsZWN0Jyk7XHJcbmNvbnN0IG9yaWdpbmFsU2VsZWN0OiBIVE1MU2VsZWN0RWxlbWVudCA9IGN1c3RvbVNlbGVjdC5xdWVyeVNlbGVjdG9yKCdzZWxlY3QnKTtcclxuY29uc3Qgb3JpZ2luYWxTZWxlY3RPcHRpb25zOiBBcnJheTxIVE1MT3B0aW9uRWxlbWVudD4gPSBBcnJheS5mcm9tKG9yaWdpbmFsU2VsZWN0LnF1ZXJ5U2VsZWN0b3JBbGwoJ29wdGlvbicpKTtcclxuY29uc3QgY3VzdG9tU2VsZWN0Rm9jdXM6IEhUTUxFbGVtZW50ID0gY3VzdG9tU2VsZWN0LnF1ZXJ5U2VsZWN0b3IoJy5jdXN0b20tc2VsZWN0X19mb2N1cycpO1xyXG5jb25zdCBjdXN0b21TZWxlY3RGb2N1c1RleHQ6IEhUTUxFbGVtZW50ID0gY3VzdG9tU2VsZWN0Rm9jdXMucXVlcnlTZWxlY3Rvcignc3BhbicpO1xyXG5jb25zdCBjdXN0b21TZWxlY3RPcHRpb25zQ29udGFpbmVyOiBIVE1MRWxlbWVudCA9IGN1c3RvbVNlbGVjdC5xdWVyeVNlbGVjdG9yKCcuY3VzdG9tLXNlbGVjdF9fb3B0aW9ucycpO1xyXG5sZXQgY3VzdG9tU2VsZWN0T3B0aW9uczogQXJyYXk8SFRNTEVsZW1lbnQ+ID0gW107XHJcblxyXG4vKiBzcGluYnV0dG9uIGVsZW1lbnRzICovXHJcbmNvbnN0IGN1c3RvbVNwaW5idXR0b246IEhUTUxFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnNwaW5idXR0b24nKTtcclxuY29uc3Qgc3BpbkJ1dHRvbjogSFRNTEVsZW1lbnQgPSBjdXN0b21TcGluYnV0dG9uLnF1ZXJ5U2VsZWN0b3IoJ1tyb2xlPVwic3BpbmJ1dHRvblwiXScpO1xyXG5jb25zdCBkZWNyZWFzZVNwaW5idXR0b246IEhUTUxCdXR0b25FbGVtZW50ID0gY3VzdG9tU3BpbmJ1dHRvbi5xdWVyeVNlbGVjdG9yKCcjZGVjcmVhc2UtcGVvcGxlJyk7XHJcbmNvbnN0IGluY3JlYXNlU3BpbmJ1dHRvbjogSFRNTEJ1dHRvbkVsZW1lbnQgPSBjdXN0b21TcGluYnV0dG9uLnF1ZXJ5U2VsZWN0b3IoJyNpbmNyZWFzZS1wZW9wbGUnKTtcclxuXHJcbi8qIGZvcm0gZWxlbWVudHMgKi9cclxuY29uc3QgcmVzZXJ2YXRpb25Gb3JtOiBIVE1MRm9ybUVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucmVzZXJ2YXRpb24tZm9ybScpO1xyXG5jb25zdCBuYW1lSW5wdXQ6IEhUTUxJbnB1dEVsZW1lbnQgPSByZXNlcnZhdGlvbkZvcm0ucXVlcnlTZWxlY3RvcignaW5wdXRbbmFtZT1cIm5hbWVcIl0nKTtcclxuY29uc3QgZW1haWxJbnB1dDogSFRNTElucHV0RWxlbWVudCA9IHJlc2VydmF0aW9uRm9ybS5xdWVyeVNlbGVjdG9yKCdpbnB1dFtuYW1lPVwiZW1haWxcIl0nKTtcclxuY29uc3QgbW9udGhJbnB1dDogSFRNTElucHV0RWxlbWVudCA9IHJlc2VydmF0aW9uRm9ybS5xdWVyeVNlbGVjdG9yKCdpbnB1dFtuYW1lPVwibW9udGhcIl0nKTtcclxuY29uc3QgZGF5SW5wdXQ6IEhUTUxJbnB1dEVsZW1lbnQgPSByZXNlcnZhdGlvbkZvcm0ucXVlcnlTZWxlY3RvcignaW5wdXRbbmFtZT1cImRheVwiXScpO1xyXG5jb25zdCB5ZWFySW5wdXQ6IEhUTUxJbnB1dEVsZW1lbnQgPSByZXNlcnZhdGlvbkZvcm0ucXVlcnlTZWxlY3RvcignaW5wdXRbbmFtZT1cInllYXJcIl0nKTtcclxuY29uc3QgaG91cklucHV0OiBIVE1MSW5wdXRFbGVtZW50ID0gcmVzZXJ2YXRpb25Gb3JtLnF1ZXJ5U2VsZWN0b3IoJ2lucHV0W25hbWU9XCJob3VyXCJdJyk7XHJcbmNvbnN0IG1pbnV0ZXNJbnB1dDogSFRNTElucHV0RWxlbWVudCA9IHJlc2VydmF0aW9uRm9ybS5xdWVyeVNlbGVjdG9yKCdpbnB1dFtuYW1lPVwibWludXRlXCJdJyk7XHJcbmNvbnN0IHJlc2VydmF0aW9uU3VibWl0QnRuOiBIVE1MQnV0dG9uRWxlbWVudCA9IHJlc2VydmF0aW9uRm9ybS5xdWVyeVNlbGVjdG9yKCdidXR0b25bdHlwZT1cInN1Ym1pdFwiXScpO1xyXG5cclxuLyogY29uc3RhbnRzICovXHJcbmNvbnN0IENIRUNLX0lDT05fVVJMOiBzdHJpbmcgPSAnLi9kaXN0L2Fzc2V0cy9pbWFnZXMvaWNvbnMvaWNvbi1jaGVjay5zdmcnO1xyXG5jb25zdCBFTUFJTF9SRUdFWCA9XHJcblx0L14oKFtePD4oKVtcXF1cXFxcLiw7Olxcc0BcIl0rKFxcLltePD4oKVtcXF1cXFxcLiw7Olxcc0BcIl0rKSopfChcIi4rXCIpKUAoKFxcW1swLTldezEsM31cXC5bMC05XXsxLDN9XFwuWzAtOV17MSwzfVxcLlswLTldezEsM31cXF0pfCgoW2EtekEtWlxcLTAtOV0rXFwuKStbYS16QS1aXXsyLH0pKSQvO1xyXG5jb25zdCBEQVlfUkVHRVggPSAvXigwWzEtOV0pfChbMS0yXVxcZCl8KDNbMC0xXSkkLztcclxuY29uc3QgTUFYX0RBWVNfSU5fTU9OVEggPSAzMTtcclxuY29uc3QgTU9OVEhfUkVHRVggPSAvXigwWzEtOV0pfCgxWzAtMl0pJC87XHJcbmNvbnN0IFlFQVJfUkVHRVggPSAvXlxcZHs0fSQvO1xyXG5jb25zdCBIT1VSX1JFR0VYID0gL14oMFsxLTldKXwoMVswLTJdKSQvO1xyXG5jb25zdCBNSU5VVEVTX1JFR0VYID0gL14oWzAtNV1cXGQpJC87XHJcbmNvbnN0IE1PTkRBWV9DT0RFID0gMTtcclxuY29uc3QgRlJJREFZX0NPREUgPSA1O1xyXG5jb25zdCBTQVRVUkRBWV9DT0RFID0gNjtcclxuY29uc3QgU1VOREFZX0NPREUgPSAwO1xyXG5cclxuY3JlYXRlQ3VzdG9tU2VsZWN0T3B0aW9ucygpO1xyXG5cclxuLyogZXZlbnQgbGlzdGVuZXJzICovXHJcbi8qIC0tLSBmb3IgY3VzdG9tIHNlbGVjdCAqL1xyXG5vcmlnaW5hbFNlbGVjdC5hZGRFdmVudExpc3RlbmVyKCdrZXl1cCcsIChlOiBLZXlib2FyZEV2ZW50KSA9PiB7XHJcblx0c3dpdGNoIChlLmtleSkge1xyXG5cdFx0Y2FzZSAnQXJyb3dVcCc6XHJcblx0XHRjYXNlICdBcnJvd0Rvd24nOlxyXG5cdFx0Y2FzZSAnQXJyb3dMZWZ0JzpcclxuXHRcdGNhc2UgJ0Fycm93UmlnaHQnOlxyXG5cdFx0XHRoYW5kbGVTZWxlY3Rpb24oKTtcclxuXHRcdFx0YnJlYWs7XHJcblx0XHRjYXNlICdFbnRlcic6XHJcblx0XHRcdGhhbmRsZVNlbGVjdGlvbigpO1xyXG5cdFx0XHRjbG9zZUN1c3RvbVNlbGVjdCgpO1xyXG5cdFx0XHRicmVhaztcclxuXHR9XHJcbn0pO1xyXG5cclxuY3VzdG9tU2VsZWN0Rm9jdXMuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZTogRXZlbnQpID0+IHtcclxuXHRvcmlnaW5hbFNlbGVjdC5mb2N1cygpO1xyXG59KTtcclxuXHJcbm9yaWdpbmFsU2VsZWN0LmFkZEV2ZW50TGlzdGVuZXIoJ2ZvY3VzaW4nLCBvcGVuQ3VzdG9tU2VsZWN0KTtcclxuXHJcbi8qIC0tLSBmb3Igc3BpbmJ1dHRvbiAqL1xyXG5zcGluQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCBoYW5kbGVTcGluQnV0dG9uKTtcclxuaW5jcmVhc2VTcGluYnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgaW5jcmVhc2VQZW9wbGUpO1xyXG5kZWNyZWFzZVNwaW5idXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBkZWNyZWFzZVBlb3BsZSk7XHJcblxyXG4vKiAtLS0gZm9yIHJlc2VydmF0aW9uIGZvcm0gKi9cclxucmVzZXJ2YXRpb25TdWJtaXRCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZTogRXZlbnQpID0+IHtcclxuXHRlLnByZXZlbnREZWZhdWx0KCk7XHJcblx0Y29uc3QgaXNOYW1lVmFsaWQ6IGJvb2xlYW4gPSB2YWxpZGF0ZU5hbWUoKTtcclxuXHRjb25zdCBpc0VtYWlsVmFsaWQ6IGJvb2xlYW4gPSB2YWxpZGF0ZUVtYWlsKCk7XHJcblx0Y29uc3QgaXNEYXRlVmFsaWQ6IGJvb2xlYW4gPSB2YWxpZGF0ZURhdGUoKTtcclxuXHRjb25zdCBpc1RpbWVWYWxpZDogYm9vbGVhbiA9IHZhbGlkYXRlVGltZSgpO1xyXG5cclxuXHRpZiAoaXNOYW1lVmFsaWQgJiYgaXNFbWFpbFZhbGlkICYmIGlzRGF0ZVZhbGlkICYmIGlzVGltZVZhbGlkKSB7XHJcblx0XHRyZXNlcnZhdGlvbkZvcm0uc2V0QXR0cmlidXRlKCdkYXRhLXZhbGlkJywgJ3RydWUnKTtcclxuXHR9IGVsc2Uge1xyXG5cdFx0cmVzZXJ2YXRpb25Gb3JtLnJlbW92ZUF0dHJpYnV0ZSgnZGF0YS12YWxpZCcpO1xyXG5cdH1cclxufSk7XHJcblxyXG4vKiBoZWxwZXIgZnVuY3Rpb25zICovXHJcbi8qIC0tLSBmb3IgY3VzdG9tIHNlbGVjdCAqL1xyXG5mdW5jdGlvbiBjcmVhdGVDdXN0b21TZWxlY3RPcHRpb25zKCk6IHZvaWQge1xyXG5cdG9yaWdpbmFsU2VsZWN0T3B0aW9ucy5mb3JFYWNoKG9wdGlvbiA9PiB7XHJcblx0XHRjb25zdCBjdXN0b21PcHRpb246IEhUTUxFbGVtZW50ID0gY3JlYXRlQ3VzdG9tT3B0aW9uKG9wdGlvbik7XHJcblx0XHRjdXN0b21TZWxlY3RPcHRpb25zLnB1c2goY3VzdG9tT3B0aW9uKTtcclxuXHRcdGN1c3RvbVNlbGVjdE9wdGlvbnNDb250YWluZXIuYXBwZW5kQ2hpbGQoY3VzdG9tT3B0aW9uKTtcclxuXHR9KTtcclxufVxyXG5cclxuZnVuY3Rpb24gY3JlYXRlQ3VzdG9tT3B0aW9uKG9wdGlvbjogSFRNTE9wdGlvbkVsZW1lbnQpOiBIVE1MRWxlbWVudCB7XHJcblx0Y29uc3Qgb3B0aW9uV3JhcHBlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTtcclxuXHRvcHRpb25XcmFwcGVyLmNsYXNzTGlzdC5hZGQoJ2N1c3RvbS1zZWxlY3RfX29wdGlvbicpO1xyXG5cdG9wdGlvbldyYXBwZXIuc2V0QXR0cmlidXRlKCdkYXRhLXNlbGVjdGVkJywgb3B0aW9uLnNlbGVjdGVkLnRvU3RyaW5nKCkpO1xyXG5cdG9wdGlvbldyYXBwZXIuc2V0QXR0cmlidXRlKCdkYXRhLXZhbHVlJywgb3B0aW9uLnZhbHVlKTtcclxuXHRvcHRpb25XcmFwcGVyLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgaGFuZGxlQ3VzdG9tT3B0aW9uKTtcclxuXHJcblx0Y29uc3QgY2hlY2tJbWFnZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2ltZycpO1xyXG5cdGNoZWNrSW1hZ2Uuc2V0QXR0cmlidXRlKCdzcmMnLCBDSEVDS19JQ09OX1VSTCk7XHJcblx0Y2hlY2tJbWFnZS5zZXRBdHRyaWJ1dGUoJ2FsdCcsICcnKTtcclxuXHJcblx0Y29uc3Qgb3B0aW9uVGV4dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTtcclxuXHRvcHRpb25UZXh0LmlubmVyVGV4dCA9IG9wdGlvbi5pbm5lclRleHQ7XHJcblxyXG5cdG9wdGlvbldyYXBwZXIuYXBwZW5kQ2hpbGQoY2hlY2tJbWFnZSk7XHJcblx0b3B0aW9uV3JhcHBlci5hcHBlbmRDaGlsZChvcHRpb25UZXh0KTtcclxuXHJcblx0cmV0dXJuIG9wdGlvbldyYXBwZXI7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGhhbmRsZUN1c3RvbU9wdGlvbihlOiBFdmVudCk6IHZvaWQge1xyXG5cdGNvbnN0IG9wdGlvbjogSFRNTEVsZW1lbnQgPSBlLnRhcmdldCBhcyBIVE1MRWxlbWVudDtcclxuXHRvcmlnaW5hbFNlbGVjdE9wdGlvbnMuZm9yRWFjaChvcHQgPT4gKG9wdC5zZWxlY3RlZCA9IG9wdC52YWx1ZSA9PT0gb3B0aW9uLmRhdGFzZXQudmFsdWUpKTtcclxuXHRoYW5kbGVTZWxlY3Rpb24oKTtcclxuXHRjbG9zZUN1c3RvbVNlbGVjdCgpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVTZWxlY3Rpb24oKTogdm9pZCB7XHJcblx0Y29uc3Qgc2VsZWN0ZWRWYWx1ZTogc3RyaW5nID0gb3JpZ2luYWxTZWxlY3RPcHRpb25zLmZpbHRlcihvcHQgPT4gb3B0LnNlbGVjdGVkKVswXS52YWx1ZTtcclxuXHRjdXN0b21TZWxlY3RGb2N1c1RleHQuaW5uZXJUZXh0ID0gc2VsZWN0ZWRWYWx1ZS50b1VwcGVyQ2FzZSgpO1xyXG5cdGN1c3RvbVNlbGVjdE9wdGlvbnMuZm9yRWFjaChvcHRpb24gPT4ge1xyXG5cdFx0b3B0aW9uLmRhdGFzZXQuc2VsZWN0ZWQgPSAob3B0aW9uLmRhdGFzZXQudmFsdWUgPT09IHNlbGVjdGVkVmFsdWUpLnRvU3RyaW5nKCk7XHJcblx0fSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIG9wZW5DdXN0b21TZWxlY3QoKTogdm9pZCB7XHJcblx0Y3VzdG9tU2VsZWN0LmRhdGFzZXQub3BlbiA9ICd0cnVlJztcclxufVxyXG5cclxuZnVuY3Rpb24gY2xvc2VDdXN0b21TZWxlY3QoKTogdm9pZCB7XHJcblx0Y3VzdG9tU2VsZWN0LmRhdGFzZXQub3BlbiA9ICdmYWxzZSc7XHJcbn1cclxuXHJcbi8qIC0tLSBmb3Igc3BpbmJ1dHRvbiAqL1xyXG5mdW5jdGlvbiBoYW5kbGVTcGluQnV0dG9uKGU6IEtleWJvYXJkRXZlbnQpOiB2b2lkIHtcclxuXHRzd2l0Y2ggKGUua2V5KSB7XHJcblx0XHRjYXNlICdBcnJvd1VwJzpcclxuXHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cdFx0XHRpbmNyZWFzZVBlb3BsZSgpO1xyXG5cdFx0XHRicmVhaztcclxuXHRcdGNhc2UgJ0Fycm93RG93bic6XHJcblx0XHRcdGUucHJldmVudERlZmF1bHQoKTtcclxuXHRcdFx0ZGVjcmVhc2VQZW9wbGUoKTtcclxuXHRcdFx0YnJlYWs7XHJcblx0XHRjYXNlICdIb21lJzpcclxuXHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cdFx0XHRzZXRNaW5QZW9wbGUoKTtcclxuXHRcdFx0YnJlYWs7XHJcblx0XHRjYXNlICdFbmQnOlxyXG5cdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XHJcblx0XHRcdHNldE1heFBlb3BsZSgpO1xyXG5cdFx0XHRicmVhaztcclxuXHR9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGluY3JlYXNlUGVvcGxlKCk6IHZvaWQge1xyXG5cdGNvbnN0IGN1cnJlbnRWYWx1ZTogbnVtYmVyID0gTnVtYmVyKHNwaW5CdXR0b24uZ2V0QXR0cmlidXRlKCdhcmlhLXZhbHVlbm93JykpO1xyXG5cdGNvbnN0IG1heFZhbHVlOiBudW1iZXIgPSBOdW1iZXIoc3BpbkJ1dHRvbi5nZXRBdHRyaWJ1dGUoJ2FyaWEtdmFsdWVtYXgnKSk7XHJcblx0Y29uc3QgbmV3VmFsdWU6IG51bWJlciA9IE1hdGgubWluKGN1cnJlbnRWYWx1ZSArIDEsIG1heFZhbHVlKTtcclxuXHR1cGRhdGVTcGluQnV0dG9uKG5ld1ZhbHVlKTtcclxufVxyXG5cclxuZnVuY3Rpb24gZGVjcmVhc2VQZW9wbGUoKTogdm9pZCB7XHJcblx0Y29uc3QgY3VycmVudFZhbHVlOiBudW1iZXIgPSBOdW1iZXIoc3BpbkJ1dHRvbi5nZXRBdHRyaWJ1dGUoJ2FyaWEtdmFsdWVub3cnKSk7XHJcblx0Y29uc3QgbWluVmFsdWU6IG51bWJlciA9IE51bWJlcihzcGluQnV0dG9uLmdldEF0dHJpYnV0ZSgnYXJpYS12YWx1ZW1pbicpKTtcclxuXHRjb25zdCBuZXdWYWx1ZTogbnVtYmVyID0gTWF0aC5tYXgoY3VycmVudFZhbHVlIC0gMSwgbWluVmFsdWUpO1xyXG5cdHVwZGF0ZVNwaW5CdXR0b24obmV3VmFsdWUpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBzZXRNYXhQZW9wbGUoKTogdm9pZCB7XHJcblx0Y29uc3QgbWF4VmFsdWU6IG51bWJlciA9IE51bWJlcihzcGluQnV0dG9uLmdldEF0dHJpYnV0ZSgnYXJpYS12YWx1ZW1heCcpKTtcclxuXHR1cGRhdGVTcGluQnV0dG9uKG1heFZhbHVlKTtcclxufVxyXG5cclxuZnVuY3Rpb24gc2V0TWluUGVvcGxlKCk6IHZvaWQge1xyXG5cdGNvbnN0IG1pblZhbHVlOiBudW1iZXIgPSBOdW1iZXIoc3BpbkJ1dHRvbi5nZXRBdHRyaWJ1dGUoJ2FyaWEtdmFsdWVtaW4nKSk7XHJcblx0dXBkYXRlU3BpbkJ1dHRvbihtaW5WYWx1ZSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHVwZGF0ZVNwaW5CdXR0b24obmV3VmFsdWU6IG51bWJlcik6IHZvaWQge1xyXG5cdHNwaW5CdXR0b24uc2V0QXR0cmlidXRlKCdhcmlhLXZhbHVlbm93JywgbmV3VmFsdWUudG9TdHJpbmcoKSk7XHJcblx0c3BpbkJ1dHRvbi5zZXRBdHRyaWJ1dGUoJ2FyaWEtdmFsdWV0ZXh0JywgYCR7bmV3VmFsdWV9IHBlb3BsZWApO1xyXG5cdHNwaW5CdXR0b24uaW5uZXJUZXh0ID0gYCR7bmV3VmFsdWV9IHBlb3BsZWA7XHJcbn1cclxuXHJcbi8qIC0tLSBmb3IgZm9ybSB2YWxpZGF0aW9uICovXHJcbi8qIC0tLSAtLS0gbmFtZSB2YWxpZGF0aW9uICovXHJcbmZ1bmN0aW9uIHZhbGlkYXRlTmFtZSgpOiBib29sZWFuIHtcclxuXHRjb25zdCBuYW1lVmFsdWU6IHN0cmluZyA9IG5hbWVJbnB1dC52YWx1ZTtcclxuXHJcblx0aWYgKGlzQmxhbmsobmFtZVZhbHVlKSkgcmV0dXJuIGRpc3BsYXlGb3JtRXJyb3IobmFtZUlucHV0LCAnVGhpcyBmaWVsZCBpcyByZXF1aXJlZCcpO1xyXG5cclxuXHRyZXR1cm4gcmVtb3ZlRm9ybUVycm9yKG5hbWVJbnB1dCk7XHJcbn1cclxuXHJcbi8qIC0tLSAtLS0gZW1haWwgdmFsaWRhdGlvbiAqL1xyXG5mdW5jdGlvbiB2YWxpZGF0ZUVtYWlsKCk6IGJvb2xlYW4ge1xyXG5cdGNvbnN0IGVtYWlsVmFsdWU6IHN0cmluZyA9IGVtYWlsSW5wdXQudmFsdWU7XHJcblxyXG5cdGlmIChpc0JsYW5rKGVtYWlsVmFsdWUpKSByZXR1cm4gZGlzcGxheUZvcm1FcnJvcihlbWFpbElucHV0LCAnVGhpcyBmaWVsZCBpcyByZXF1aXJlZCcpO1xyXG5cdGlmICghaXNWYWxpZEVtYWlsKGVtYWlsVmFsdWUpKSByZXR1cm4gZGlzcGxheUZvcm1FcnJvcihlbWFpbElucHV0LCAnUHJvdmlkZSBhIHZhbGlkIGVtYWlsIGFkZHJlc3MnKTtcclxuXHJcblx0cmV0dXJuIHJlbW92ZUZvcm1FcnJvcihlbWFpbElucHV0KTtcclxufVxyXG5cclxuZnVuY3Rpb24gaXNWYWxpZEVtYWlsKGVtYWlsOiBzdHJpbmcpOiBib29sZWFuIHtcclxuXHRyZXR1cm4gRU1BSUxfUkVHRVgudGVzdChlbWFpbCk7XHJcbn1cclxuXHJcbi8qIC0tLSAtLS0gZGF0ZSB2YWxpZGF0aW9uICovXHJcbmZ1bmN0aW9uIHZhbGlkYXRlRGF0ZSgpOiBib29sZWFuIHtcclxuXHRpZiAodmFsaWRhdGVEYXkoKSAmJiB2YWxpZGF0ZU1vbnRoKCkgJiYgdmFsaWRhdGVZZWFyKCkpIHtcclxuXHRcdGNvbnN0IGRheTogbnVtYmVyID0gTnVtYmVyKGRheUlucHV0LnZhbHVlKTtcclxuXHRcdGNvbnN0IG1vbnRoOiBudW1iZXIgPSBOdW1iZXIobW9udGhJbnB1dC52YWx1ZSk7XHJcblx0XHRjb25zdCB5ZWFyOiBudW1iZXIgPSBOdW1iZXIoeWVhcklucHV0LnZhbHVlKTtcclxuXHJcblx0XHRpZiAoIWlzRGF0ZUFmdGVyVG9kYXkoeWVhciwgbW9udGgsIGRheSkpIHJldHVybiBkaXNwbGF5Rm9ybUVycm9yKHllYXJJbnB1dCwgJ0luc2VydCBkYXRlIGFmdGVyIHRvZGF5Jyk7XHJcblxyXG5cdFx0cmV0dXJuIHJlbW92ZUZvcm1FcnJvcih5ZWFySW5wdXQpO1xyXG5cdH1cclxuXHJcblx0cmV0dXJuIGZhbHNlO1xyXG59XHJcblxyXG5mdW5jdGlvbiB2YWxpZGF0ZURheSgpOiBib29sZWFuIHtcclxuXHRjb25zdCBkYXlWYWx1ZTogc3RyaW5nID0gZGF5SW5wdXQudmFsdWU7XHJcblxyXG5cdGlmIChpc0JsYW5rKGRheVZhbHVlKSkgcmV0dXJuIGRpc3BsYXlGb3JtRXJyb3IoZGF5SW5wdXQsICdUaGlzIGZpZWxkIGlzIGluY29tcGxldGUnKTtcclxuXHRpZiAoIWlzVmFsaWREYXkoZGF5VmFsdWUpKSByZXR1cm4gZGlzcGxheUZvcm1FcnJvcihkYXlJbnB1dCwgJ0luc2VydCB2YWxpZCBkYXkgdmFsdWUgKDAxIC0gMzEpJyk7XHJcblx0aWYgKCFpc0RheVdpdGhpbk1vbnRoUmFuZ2UoZGF5VmFsdWUpKSByZXR1cm4gZGlzcGxheUZvcm1FcnJvcihkYXlJbnB1dCwgJ0luc2VydCBkYXkgaW4gcmFuZ2Ugb2Ygc2VsZWN0ZWQgbW9udGguJyk7XHJcblxyXG5cdHJldHVybiByZW1vdmVGb3JtRXJyb3IoZGF5SW5wdXQpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBpc0RhdGVBZnRlclRvZGF5KHllYXI6IG51bWJlciwgbW9udGg6IG51bWJlciwgZGF5OiBudW1iZXIpOiBib29sZWFuIHtcclxuXHRyZXR1cm4gbmV3IERhdGUoeWVhciwgbW9udGggLSAxLCBkYXkpID4gbmV3IERhdGUoKTtcclxufVxyXG5cclxuZnVuY3Rpb24gaXNEYXlXaXRoaW5Nb250aFJhbmdlKGRheTogc3RyaW5nKTogYm9vbGVhbiB7XHJcblx0Y29uc3QgbW9udGg6IHN0cmluZyA9IG1vbnRoSW5wdXQudmFsdWU7XHJcblx0Y29uc3QgeWVhcjogc3RyaW5nID0geWVhcklucHV0LnZhbHVlO1xyXG5cclxuXHRpZiAoIXllYXIgfHwgIW1vbnRoKSByZXR1cm4gdHJ1ZTtcclxuXHRjb25zdCBtb250aERheXM6IG51bWJlciA9IG5ldyBEYXRlKE51bWJlcih5ZWFyKSwgTnVtYmVyKG1vbnRoKSwgMCkuZ2V0RGF0ZSgpIHx8IE1BWF9EQVlTX0lOX01PTlRIO1xyXG5cdHJldHVybiBOdW1iZXIoZGF5KSA8PSBtb250aERheXM7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHZhbGlkYXRlTW9udGgoKTogYm9vbGVhbiB7XHJcblx0Y29uc3QgbW9udGhWYWx1ZTogc3RyaW5nID0gbW9udGhJbnB1dC52YWx1ZTtcclxuXHJcblx0aWYgKGlzQmxhbmsobW9udGhWYWx1ZSkpIHJldHVybiBkaXNwbGF5Rm9ybUVycm9yKG1vbnRoSW5wdXQsICdUaGlzIGZpZWxkIGlzIGluY29tcGxldGUnKTtcclxuXHRpZiAoIWlzVmFsaWRNb250aChtb250aFZhbHVlKSkgcmV0dXJuIGRpc3BsYXlGb3JtRXJyb3IobW9udGhJbnB1dCwgJ0luc2VydCB2YWxpZCBtb250aCB2YWx1ZSAoMDEgLSAxMiknKTtcclxuXHJcblx0cmV0dXJuIHJlbW92ZUZvcm1FcnJvcihtb250aElucHV0KTtcclxufVxyXG5cclxuZnVuY3Rpb24gdmFsaWRhdGVZZWFyKCk6IGJvb2xlYW4ge1xyXG5cdGNvbnN0IHllYXJWYWx1ZTogc3RyaW5nID0geWVhcklucHV0LnZhbHVlO1xyXG5cclxuXHRpZiAoaXNCbGFuayh5ZWFyVmFsdWUpKSByZXR1cm4gZGlzcGxheUZvcm1FcnJvcih5ZWFySW5wdXQsICdUaGlzIGZpZWxkIGlzIGluY29tcGxldGUnKTtcclxuXHRpZiAoIWlzVmFsaWRZZWFyKHllYXJWYWx1ZSkpIHJldHVybiBkaXNwbGF5Rm9ybUVycm9yKHllYXJJbnB1dCwgJ0luc2VydCB2YWxpZCB5ZWFyICg0IGRpZ2l0IG51bWJlciknKTtcclxuXHJcblx0cmV0dXJuIHJlbW92ZUZvcm1FcnJvcih5ZWFySW5wdXQpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBpc1ZhbGlkRGF5KGRheTogc3RyaW5nKTogYm9vbGVhbiB7XHJcblx0cmV0dXJuIERBWV9SRUdFWC50ZXN0KGRheSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGlzVmFsaWRNb250aChtb250aDogc3RyaW5nKTogYm9vbGVhbiB7XHJcblx0cmV0dXJuIE1PTlRIX1JFR0VYLnRlc3QobW9udGgpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBpc1ZhbGlkWWVhcih5ZWFyOiBzdHJpbmcpOiBib29sZWFuIHtcclxuXHRyZXR1cm4gWUVBUl9SRUdFWC50ZXN0KHllYXIpO1xyXG59XHJcblxyXG4vKiAtLS0gLS0tIHRpbWUgdmFsaWRhdGlvbiAqL1xyXG5mdW5jdGlvbiB2YWxpZGF0ZVRpbWUoKTogYm9vbGVhbiB7XHJcblx0aWYgKHZhbGlkYXRlSG91cigpICYmIHZhbGlkYXRlTWludXRlcygpKSB7XHJcblx0XHRpZiAoIWlzVGltZUJldHdlZW5PcGVuSG91cnMoKSkgcmV0dXJuIGRpc3BsYXlGb3JtRXJyb3IoaG91cklucHV0LCAnSW5zZXJ0IHRpbWUgYmV0d2VlbiBvcGVuIGhvdXJzJyk7XHJcblxyXG5cdFx0cmV0dXJuIHJlbW92ZUZvcm1FcnJvcihob3VySW5wdXQpO1xyXG5cdH1cclxuXHJcblx0cmV0dXJuIGZhbHNlO1xyXG59XHJcblxyXG5mdW5jdGlvbiBpc1RpbWVCZXR3ZWVuT3BlbkhvdXJzKCk6IGJvb2xlYW4ge1xyXG5cdGNvbnN0IGhvdXI6IG51bWJlciA9IE51bWJlcihob3VySW5wdXQudmFsdWUpO1xyXG5cdGNvbnN0IG1pbnV0ZXM6IG51bWJlciA9IE51bWJlcihtaW51dGVzSW5wdXQudmFsdWUpO1xyXG5cdGNvbnN0IGRhdGU6IERhdGUgPSBuZXcgRGF0ZShOdW1iZXIoeWVhcklucHV0LnZhbHVlKSwgTnVtYmVyKG1vbnRoSW5wdXQudmFsdWUpIC0gMSwgTnVtYmVyKGRheUlucHV0LnZhbHVlKSk7XHJcblx0Y29uc3Qgd2Vla0RheTogbnVtYmVyID0gZGF0ZS5nZXREYXkoKTtcclxuXHRjb25zdCBkYXlUaW1lOiBzdHJpbmcgPSBvcmlnaW5hbFNlbGVjdC52YWx1ZTtcclxuXHJcblx0aWYgKE51bWJlci5pc05hTihob3VyKSB8fCBOdW1iZXIuaXNOYU4obWludXRlcykpIHJldHVybiBmYWxzZTtcclxuXHRpZiAoTnVtYmVyLmlzTmFOKHdlZWtEYXkpKSByZXR1cm4gZmFsc2U7XHJcblxyXG5cdGlmIChkYXlUaW1lID09PSAnYW0nKSByZXR1cm4gaXNCZXR3ZWVuTW9ybmluZ0hvdXJzKGhvdXIpO1xyXG5cdGVsc2UgcmV0dXJuIGlzQmV0d2VlbkFmdGVybm9vbkhvdXJzKGhvdXIsIG1pbnV0ZXMsIHdlZWtEYXkpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBpc0JldHdlZW5Nb3JuaW5nSG91cnMoaG91cjogbnVtYmVyKTogYm9vbGVhbiB7XHJcblx0cmV0dXJuIGhvdXIgPj0gOSAmJiBob3VyIDwgMTI7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGlzQmV0d2VlbkFmdGVybm9vbkhvdXJzKGhvdXI6IG51bWJlciwgbWludXRlczogbnVtYmVyLCB3ZWVrRGF5Q29kZTogbnVtYmVyKTogYm9vbGVhbiB7XHJcblx0aWYgKHdlZWtEYXlDb2RlIDw9IEZSSURBWV9DT0RFICYmIHdlZWtEYXlDb2RlID49IE1PTkRBWV9DT0RFKSB7XHJcblx0XHRyZXR1cm4gaG91ciA9PT0gMTIgfHwgaG91ciA8IDEwO1xyXG5cdH1cclxuXHRpZiAod2Vla0RheUNvZGUgPT09IFNBVFVSREFZX0NPREUgfHwgd2Vla0RheUNvZGUgPT09IFNVTkRBWV9DT0RFKSB7XHJcblx0XHRyZXR1cm4gaG91ciA9PT0gMTIgfHwgaG91ciA8IDExIHx8IChob3VyID09PSAxMSAmJiBtaW51dGVzIDwgMzApO1xyXG5cdH1cclxuXHJcblx0cmV0dXJuIHRydWU7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHZhbGlkYXRlSG91cigpOiBib29sZWFuIHtcclxuXHRjb25zdCBob3VyVmFsdWU6IHN0cmluZyA9IGhvdXJJbnB1dC52YWx1ZTtcclxuXHJcblx0aWYgKGlzQmxhbmsoaG91clZhbHVlKSkgcmV0dXJuIGRpc3BsYXlGb3JtRXJyb3IoaG91cklucHV0LCAnVGhpcyBmaWVsZCBpcyBpbmNvbXBsZXRlJyk7XHJcblx0aWYgKCFpc1ZhbGlkSG91cihob3VyVmFsdWUpKSByZXR1cm4gZGlzcGxheUZvcm1FcnJvcihob3VySW5wdXQsICdJbnNlcnQgdmFsaWQgaG91ciBmb3JtYXQgKDAxIC0gMTIpJyk7XHJcblxyXG5cdHJldHVybiByZW1vdmVGb3JtRXJyb3IoaG91cklucHV0KTtcclxufVxyXG5cclxuZnVuY3Rpb24gdmFsaWRhdGVNaW51dGVzKCk6IGJvb2xlYW4ge1xyXG5cdGNvbnN0IG1pbnV0ZXNWYWx1ZTogc3RyaW5nID0gbWludXRlc0lucHV0LnZhbHVlO1xyXG5cclxuXHRpZiAoaXNCbGFuayhtaW51dGVzVmFsdWUpKSByZXR1cm4gZGlzcGxheUZvcm1FcnJvcihtaW51dGVzSW5wdXQsICdUaGlzIGZpZWxkIGlzIGluY29tcGxldGUnKTtcclxuXHRpZiAoIWFyZVZhbGlkTWludXRlcyhtaW51dGVzVmFsdWUpKSByZXR1cm4gZGlzcGxheUZvcm1FcnJvcihtaW51dGVzSW5wdXQsICdJbnNlcnQgdmFsaWQgbWludXRlcyBmb3JtYXQgKDAwIC0gNTkpJyk7XHJcblxyXG5cdHJldHVybiByZW1vdmVGb3JtRXJyb3IobWludXRlc0lucHV0KTtcclxufVxyXG5cclxuZnVuY3Rpb24gaXNWYWxpZEhvdXIoaG91cjogc3RyaW5nKTogYm9vbGVhbiB7XHJcblx0cmV0dXJuIEhPVVJfUkVHRVgudGVzdChob3VyKTtcclxufVxyXG5cclxuZnVuY3Rpb24gYXJlVmFsaWRNaW51dGVzKG1pbnV0ZXM6IHN0cmluZyk6IGJvb2xlYW4ge1xyXG5cdHJldHVybiBNSU5VVEVTX1JFR0VYLnRlc3QobWludXRlcyk7XHJcbn1cclxuXHJcbi8qIC0tLSAtLS0gZ2VuZXJhbCBmb3JtIHZhbGlkYXRpb24gKi9cclxuZnVuY3Rpb24gaXNCbGFuayh2YWx1ZTogc3RyaW5nKTogYm9vbGVhbiB7XHJcblx0cmV0dXJuIHZhbHVlID09PSAnJztcclxufVxyXG4vKiAtLS0gLS0tIGZvcm0gZXJyb3IgZGlzcGxheWluZyAqL1xyXG5mdW5jdGlvbiBkaXNwbGF5Rm9ybUVycm9yKGlucHV0OiBIVE1MSW5wdXRFbGVtZW50LCBtZXNzYWdlOiBzdHJpbmcpOiBib29sZWFuIHtcclxuXHRsZXQgZm9ybUdyb3VwOiBIVE1MRWxlbWVudCA9IGlucHV0LmNsb3Nlc3QoJy5mb3JtLWdyb3VwJyk7XHJcblx0bGV0IGZvcm1FcnJvcjogSFRNTEVsZW1lbnQ7XHJcblxyXG5cdHdoaWxlIChmb3JtR3JvdXApIHtcclxuXHRcdGZvcm1Hcm91cC5jbGFzc0xpc3QuYWRkKCdlcnJvcicpO1xyXG5cdFx0Zm9ybUVycm9yID0gZm9ybUdyb3VwLnF1ZXJ5U2VsZWN0b3IoJy5mb3JtLWVycm9yJyk7XHJcblxyXG5cdFx0aWYgKGZvcm1FcnJvcikge1xyXG5cdFx0XHRmb3JtRXJyb3IuaW5uZXJUZXh0ID0gbWVzc2FnZTtcclxuXHRcdFx0YnJlYWs7XHJcblx0XHR9XHJcblxyXG5cdFx0Zm9ybUdyb3VwID0gZm9ybUdyb3VwLnBhcmVudEVsZW1lbnQuY2xvc2VzdCgnLmZvcm0tZ3JvdXAnKTtcclxuXHR9XHJcblxyXG5cdHJldHVybiBmYWxzZTtcclxufVxyXG5cclxuZnVuY3Rpb24gcmVtb3ZlRm9ybUVycm9yKGlucHV0OiBIVE1MSW5wdXRFbGVtZW50KTogYm9vbGVhbiB7XHJcblx0bGV0IGZvcm1Hcm91cDogSFRNTEVsZW1lbnQgPSBpbnB1dC5jbG9zZXN0KCcuZm9ybS1ncm91cCcpO1xyXG5cdGxldCBmb3JtRXJyb3I6IEhUTUxFbGVtZW50O1xyXG5cclxuXHR3aGlsZSAoZm9ybUdyb3VwKSB7XHJcblx0XHRmb3JtR3JvdXAuY2xhc3NMaXN0LnJlbW92ZSgnZXJyb3InKTtcclxuXHRcdGZvcm1FcnJvciA9IGZvcm1Hcm91cC5xdWVyeVNlbGVjdG9yKCcuZm9ybS1lcnJvcicpO1xyXG5cclxuXHRcdGlmIChmb3JtRXJyb3IpIGZvcm1FcnJvci5pbm5lclRleHQgPSAnJztcclxuXHJcblx0XHRmb3JtR3JvdXAgPSBmb3JtR3JvdXAucGFyZW50RWxlbWVudC5jbG9zZXN0KCcuZm9ybS1ncm91cCcpO1xyXG5cdH1cclxuXHJcblx0cmV0dXJuIHRydWU7XHJcbn1cclxuIiwiY29uc3QgY3VzdG9tU2VsZWN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmN1c3RvbS1zZWxlY3QnKTtcbmNvbnN0IG9yaWdpbmFsU2VsZWN0ID0gY3VzdG9tU2VsZWN0LnF1ZXJ5U2VsZWN0b3IoJ3NlbGVjdCcpO1xuY29uc3Qgb3JpZ2luYWxTZWxlY3RPcHRpb25zID0gQXJyYXkuZnJvbShvcmlnaW5hbFNlbGVjdC5xdWVyeVNlbGVjdG9yQWxsKCdvcHRpb24nKSk7XG5jb25zdCBjdXN0b21TZWxlY3RGb2N1cyA9IGN1c3RvbVNlbGVjdC5xdWVyeVNlbGVjdG9yKCcuY3VzdG9tLXNlbGVjdF9fZm9jdXMnKTtcbmNvbnN0IGN1c3RvbVNlbGVjdEZvY3VzVGV4dCA9IGN1c3RvbVNlbGVjdEZvY3VzLnF1ZXJ5U2VsZWN0b3IoJ3NwYW4nKTtcbmNvbnN0IGN1c3RvbVNlbGVjdE9wdGlvbnNDb250YWluZXIgPSBjdXN0b21TZWxlY3QucXVlcnlTZWxlY3RvcignLmN1c3RvbS1zZWxlY3RfX29wdGlvbnMnKTtcbmxldCBjdXN0b21TZWxlY3RPcHRpb25zID0gW107XG5jb25zdCBjdXN0b21TcGluYnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnNwaW5idXR0b24nKTtcbmNvbnN0IHNwaW5CdXR0b24gPSBjdXN0b21TcGluYnV0dG9uLnF1ZXJ5U2VsZWN0b3IoJ1tyb2xlPVwic3BpbmJ1dHRvblwiXScpO1xuY29uc3QgZGVjcmVhc2VTcGluYnV0dG9uID0gY3VzdG9tU3BpbmJ1dHRvbi5xdWVyeVNlbGVjdG9yKCcjZGVjcmVhc2UtcGVvcGxlJyk7XG5jb25zdCBpbmNyZWFzZVNwaW5idXR0b24gPSBjdXN0b21TcGluYnV0dG9uLnF1ZXJ5U2VsZWN0b3IoJyNpbmNyZWFzZS1wZW9wbGUnKTtcbmNvbnN0IHJlc2VydmF0aW9uRm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5yZXNlcnZhdGlvbi1mb3JtJyk7XG5jb25zdCBuYW1lSW5wdXQgPSByZXNlcnZhdGlvbkZvcm0ucXVlcnlTZWxlY3RvcignaW5wdXRbbmFtZT1cIm5hbWVcIl0nKTtcbmNvbnN0IGVtYWlsSW5wdXQgPSByZXNlcnZhdGlvbkZvcm0ucXVlcnlTZWxlY3RvcignaW5wdXRbbmFtZT1cImVtYWlsXCJdJyk7XG5jb25zdCBtb250aElucHV0ID0gcmVzZXJ2YXRpb25Gb3JtLnF1ZXJ5U2VsZWN0b3IoJ2lucHV0W25hbWU9XCJtb250aFwiXScpO1xuY29uc3QgZGF5SW5wdXQgPSByZXNlcnZhdGlvbkZvcm0ucXVlcnlTZWxlY3RvcignaW5wdXRbbmFtZT1cImRheVwiXScpO1xuY29uc3QgeWVhcklucHV0ID0gcmVzZXJ2YXRpb25Gb3JtLnF1ZXJ5U2VsZWN0b3IoJ2lucHV0W25hbWU9XCJ5ZWFyXCJdJyk7XG5jb25zdCBob3VySW5wdXQgPSByZXNlcnZhdGlvbkZvcm0ucXVlcnlTZWxlY3RvcignaW5wdXRbbmFtZT1cImhvdXJcIl0nKTtcbmNvbnN0IG1pbnV0ZXNJbnB1dCA9IHJlc2VydmF0aW9uRm9ybS5xdWVyeVNlbGVjdG9yKCdpbnB1dFtuYW1lPVwibWludXRlXCJdJyk7XG5jb25zdCByZXNlcnZhdGlvblN1Ym1pdEJ0biA9IHJlc2VydmF0aW9uRm9ybS5xdWVyeVNlbGVjdG9yKCdidXR0b25bdHlwZT1cInN1Ym1pdFwiXScpO1xuY29uc3QgQ0hFQ0tfSUNPTl9VUkwgPSAnLi9kaXN0L2Fzc2V0cy9pbWFnZXMvaWNvbnMvaWNvbi1jaGVjay5zdmcnO1xuY29uc3QgRU1BSUxfUkVHRVggPSAvXigoW148PigpW1xcXVxcXFwuLDs6XFxzQFwiXSsoXFwuW148PigpW1xcXVxcXFwuLDs6XFxzQFwiXSspKil8KFwiLitcIikpQCgoXFxbWzAtOV17MSwzfVxcLlswLTldezEsM31cXC5bMC05XXsxLDN9XFwuWzAtOV17MSwzfVxcXSl8KChbYS16QS1aXFwtMC05XStcXC4pK1thLXpBLVpdezIsfSkpJC87XG5jb25zdCBEQVlfUkVHRVggPSAvXigwWzEtOV0pfChbMS0yXVxcZCl8KDNbMC0xXSkkLztcbmNvbnN0IE1BWF9EQVlTX0lOX01PTlRIID0gMzE7XG5jb25zdCBNT05USF9SRUdFWCA9IC9eKDBbMS05XSl8KDFbMC0yXSkkLztcbmNvbnN0IFlFQVJfUkVHRVggPSAvXlxcZHs0fSQvO1xuY29uc3QgSE9VUl9SRUdFWCA9IC9eKDBbMS05XSl8KDFbMC0yXSkkLztcbmNvbnN0IE1JTlVURVNfUkVHRVggPSAvXihbMC01XVxcZCkkLztcbmNvbnN0IE1PTkRBWV9DT0RFID0gMTtcbmNvbnN0IEZSSURBWV9DT0RFID0gNTtcbmNvbnN0IFNBVFVSREFZX0NPREUgPSA2O1xuY29uc3QgU1VOREFZX0NPREUgPSAwO1xuY3JlYXRlQ3VzdG9tU2VsZWN0T3B0aW9ucygpO1xub3JpZ2luYWxTZWxlY3QuYWRkRXZlbnRMaXN0ZW5lcigna2V5dXAnLCAoZSkgPT4ge1xuICAgIHN3aXRjaCAoZS5rZXkpIHtcbiAgICAgICAgY2FzZSAnQXJyb3dVcCc6XG4gICAgICAgIGNhc2UgJ0Fycm93RG93bic6XG4gICAgICAgIGNhc2UgJ0Fycm93TGVmdCc6XG4gICAgICAgIGNhc2UgJ0Fycm93UmlnaHQnOlxuICAgICAgICAgICAgaGFuZGxlU2VsZWN0aW9uKCk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAnRW50ZXInOlxuICAgICAgICAgICAgaGFuZGxlU2VsZWN0aW9uKCk7XG4gICAgICAgICAgICBjbG9zZUN1c3RvbVNlbGVjdCgpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgfVxufSk7XG5jdXN0b21TZWxlY3RGb2N1cy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7XG4gICAgb3JpZ2luYWxTZWxlY3QuZm9jdXMoKTtcbn0pO1xub3JpZ2luYWxTZWxlY3QuYWRkRXZlbnRMaXN0ZW5lcignZm9jdXNpbicsIG9wZW5DdXN0b21TZWxlY3QpO1xuc3BpbkJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgaGFuZGxlU3BpbkJ1dHRvbik7XG5pbmNyZWFzZVNwaW5idXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBpbmNyZWFzZVBlb3BsZSk7XG5kZWNyZWFzZVNwaW5idXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBkZWNyZWFzZVBlb3BsZSk7XG5yZXNlcnZhdGlvblN1Ym1pdEJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7XG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIGNvbnN0IGlzTmFtZVZhbGlkID0gdmFsaWRhdGVOYW1lKCk7XG4gICAgY29uc3QgaXNFbWFpbFZhbGlkID0gdmFsaWRhdGVFbWFpbCgpO1xuICAgIGNvbnN0IGlzRGF0ZVZhbGlkID0gdmFsaWRhdGVEYXRlKCk7XG4gICAgY29uc3QgaXNUaW1lVmFsaWQgPSB2YWxpZGF0ZVRpbWUoKTtcbiAgICBpZiAoaXNOYW1lVmFsaWQgJiYgaXNFbWFpbFZhbGlkICYmIGlzRGF0ZVZhbGlkICYmIGlzVGltZVZhbGlkKSB7XG4gICAgICAgIHJlc2VydmF0aW9uRm9ybS5zZXRBdHRyaWJ1dGUoJ2RhdGEtdmFsaWQnLCAndHJ1ZScpO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgcmVzZXJ2YXRpb25Gb3JtLnJlbW92ZUF0dHJpYnV0ZSgnZGF0YS12YWxpZCcpO1xuICAgIH1cbn0pO1xuZnVuY3Rpb24gY3JlYXRlQ3VzdG9tU2VsZWN0T3B0aW9ucygpIHtcbiAgICBvcmlnaW5hbFNlbGVjdE9wdGlvbnMuZm9yRWFjaChvcHRpb24gPT4ge1xuICAgICAgICBjb25zdCBjdXN0b21PcHRpb24gPSBjcmVhdGVDdXN0b21PcHRpb24ob3B0aW9uKTtcbiAgICAgICAgY3VzdG9tU2VsZWN0T3B0aW9ucy5wdXNoKGN1c3RvbU9wdGlvbik7XG4gICAgICAgIGN1c3RvbVNlbGVjdE9wdGlvbnNDb250YWluZXIuYXBwZW5kQ2hpbGQoY3VzdG9tT3B0aW9uKTtcbiAgICB9KTtcbn1cbmZ1bmN0aW9uIGNyZWF0ZUN1c3RvbU9wdGlvbihvcHRpb24pIHtcbiAgICBjb25zdCBvcHRpb25XcmFwcGVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpO1xuICAgIG9wdGlvbldyYXBwZXIuY2xhc3NMaXN0LmFkZCgnY3VzdG9tLXNlbGVjdF9fb3B0aW9uJyk7XG4gICAgb3B0aW9uV3JhcHBlci5zZXRBdHRyaWJ1dGUoJ2RhdGEtc2VsZWN0ZWQnLCBvcHRpb24uc2VsZWN0ZWQudG9TdHJpbmcoKSk7XG4gICAgb3B0aW9uV3JhcHBlci5zZXRBdHRyaWJ1dGUoJ2RhdGEtdmFsdWUnLCBvcHRpb24udmFsdWUpO1xuICAgIG9wdGlvbldyYXBwZXIuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBoYW5kbGVDdXN0b21PcHRpb24pO1xuICAgIGNvbnN0IGNoZWNrSW1hZ2UgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbWcnKTtcbiAgICBjaGVja0ltYWdlLnNldEF0dHJpYnV0ZSgnc3JjJywgQ0hFQ0tfSUNPTl9VUkwpO1xuICAgIGNoZWNrSW1hZ2Uuc2V0QXR0cmlidXRlKCdhbHQnLCAnJyk7XG4gICAgY29uc3Qgb3B0aW9uVGV4dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTtcbiAgICBvcHRpb25UZXh0LmlubmVyVGV4dCA9IG9wdGlvbi5pbm5lclRleHQ7XG4gICAgb3B0aW9uV3JhcHBlci5hcHBlbmRDaGlsZChjaGVja0ltYWdlKTtcbiAgICBvcHRpb25XcmFwcGVyLmFwcGVuZENoaWxkKG9wdGlvblRleHQpO1xuICAgIHJldHVybiBvcHRpb25XcmFwcGVyO1xufVxuZnVuY3Rpb24gaGFuZGxlQ3VzdG9tT3B0aW9uKGUpIHtcbiAgICBjb25zdCBvcHRpb24gPSBlLnRhcmdldDtcbiAgICBvcmlnaW5hbFNlbGVjdE9wdGlvbnMuZm9yRWFjaChvcHQgPT4gKG9wdC5zZWxlY3RlZCA9IG9wdC52YWx1ZSA9PT0gb3B0aW9uLmRhdGFzZXQudmFsdWUpKTtcbiAgICBoYW5kbGVTZWxlY3Rpb24oKTtcbiAgICBjbG9zZUN1c3RvbVNlbGVjdCgpO1xufVxuZnVuY3Rpb24gaGFuZGxlU2VsZWN0aW9uKCkge1xuICAgIGNvbnN0IHNlbGVjdGVkVmFsdWUgPSBvcmlnaW5hbFNlbGVjdE9wdGlvbnMuZmlsdGVyKG9wdCA9PiBvcHQuc2VsZWN0ZWQpWzBdLnZhbHVlO1xuICAgIGN1c3RvbVNlbGVjdEZvY3VzVGV4dC5pbm5lclRleHQgPSBzZWxlY3RlZFZhbHVlLnRvVXBwZXJDYXNlKCk7XG4gICAgY3VzdG9tU2VsZWN0T3B0aW9ucy5mb3JFYWNoKG9wdGlvbiA9PiB7XG4gICAgICAgIG9wdGlvbi5kYXRhc2V0LnNlbGVjdGVkID0gKG9wdGlvbi5kYXRhc2V0LnZhbHVlID09PSBzZWxlY3RlZFZhbHVlKS50b1N0cmluZygpO1xuICAgIH0pO1xufVxuZnVuY3Rpb24gb3BlbkN1c3RvbVNlbGVjdCgpIHtcbiAgICBjdXN0b21TZWxlY3QuZGF0YXNldC5vcGVuID0gJ3RydWUnO1xufVxuZnVuY3Rpb24gY2xvc2VDdXN0b21TZWxlY3QoKSB7XG4gICAgY3VzdG9tU2VsZWN0LmRhdGFzZXQub3BlbiA9ICdmYWxzZSc7XG59XG5mdW5jdGlvbiBoYW5kbGVTcGluQnV0dG9uKGUpIHtcbiAgICBzd2l0Y2ggKGUua2V5KSB7XG4gICAgICAgIGNhc2UgJ0Fycm93VXAnOlxuICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgaW5jcmVhc2VQZW9wbGUoKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICdBcnJvd0Rvd24nOlxuICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgZGVjcmVhc2VQZW9wbGUoKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICdIb21lJzpcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIHNldE1pblBlb3BsZSgpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgJ0VuZCc6XG4gICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICBzZXRNYXhQZW9wbGUoKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgIH1cbn1cbmZ1bmN0aW9uIGluY3JlYXNlUGVvcGxlKCkge1xuICAgIGNvbnN0IGN1cnJlbnRWYWx1ZSA9IE51bWJlcihzcGluQnV0dG9uLmdldEF0dHJpYnV0ZSgnYXJpYS12YWx1ZW5vdycpKTtcbiAgICBjb25zdCBtYXhWYWx1ZSA9IE51bWJlcihzcGluQnV0dG9uLmdldEF0dHJpYnV0ZSgnYXJpYS12YWx1ZW1heCcpKTtcbiAgICBjb25zdCBuZXdWYWx1ZSA9IE1hdGgubWluKGN1cnJlbnRWYWx1ZSArIDEsIG1heFZhbHVlKTtcbiAgICB1cGRhdGVTcGluQnV0dG9uKG5ld1ZhbHVlKTtcbn1cbmZ1bmN0aW9uIGRlY3JlYXNlUGVvcGxlKCkge1xuICAgIGNvbnN0IGN1cnJlbnRWYWx1ZSA9IE51bWJlcihzcGluQnV0dG9uLmdldEF0dHJpYnV0ZSgnYXJpYS12YWx1ZW5vdycpKTtcbiAgICBjb25zdCBtaW5WYWx1ZSA9IE51bWJlcihzcGluQnV0dG9uLmdldEF0dHJpYnV0ZSgnYXJpYS12YWx1ZW1pbicpKTtcbiAgICBjb25zdCBuZXdWYWx1ZSA9IE1hdGgubWF4KGN1cnJlbnRWYWx1ZSAtIDEsIG1pblZhbHVlKTtcbiAgICB1cGRhdGVTcGluQnV0dG9uKG5ld1ZhbHVlKTtcbn1cbmZ1bmN0aW9uIHNldE1heFBlb3BsZSgpIHtcbiAgICBjb25zdCBtYXhWYWx1ZSA9IE51bWJlcihzcGluQnV0dG9uLmdldEF0dHJpYnV0ZSgnYXJpYS12YWx1ZW1heCcpKTtcbiAgICB1cGRhdGVTcGluQnV0dG9uKG1heFZhbHVlKTtcbn1cbmZ1bmN0aW9uIHNldE1pblBlb3BsZSgpIHtcbiAgICBjb25zdCBtaW5WYWx1ZSA9IE51bWJlcihzcGluQnV0dG9uLmdldEF0dHJpYnV0ZSgnYXJpYS12YWx1ZW1pbicpKTtcbiAgICB1cGRhdGVTcGluQnV0dG9uKG1pblZhbHVlKTtcbn1cbmZ1bmN0aW9uIHVwZGF0ZVNwaW5CdXR0b24obmV3VmFsdWUpIHtcbiAgICBzcGluQnV0dG9uLnNldEF0dHJpYnV0ZSgnYXJpYS12YWx1ZW5vdycsIG5ld1ZhbHVlLnRvU3RyaW5nKCkpO1xuICAgIHNwaW5CdXR0b24uc2V0QXR0cmlidXRlKCdhcmlhLXZhbHVldGV4dCcsIGAke25ld1ZhbHVlfSBwZW9wbGVgKTtcbiAgICBzcGluQnV0dG9uLmlubmVyVGV4dCA9IGAke25ld1ZhbHVlfSBwZW9wbGVgO1xufVxuZnVuY3Rpb24gdmFsaWRhdGVOYW1lKCkge1xuICAgIGNvbnN0IG5hbWVWYWx1ZSA9IG5hbWVJbnB1dC52YWx1ZTtcbiAgICBpZiAoaXNCbGFuayhuYW1lVmFsdWUpKVxuICAgICAgICByZXR1cm4gZGlzcGxheUZvcm1FcnJvcihuYW1lSW5wdXQsICdUaGlzIGZpZWxkIGlzIHJlcXVpcmVkJyk7XG4gICAgcmV0dXJuIHJlbW92ZUZvcm1FcnJvcihuYW1lSW5wdXQpO1xufVxuZnVuY3Rpb24gdmFsaWRhdGVFbWFpbCgpIHtcbiAgICBjb25zdCBlbWFpbFZhbHVlID0gZW1haWxJbnB1dC52YWx1ZTtcbiAgICBpZiAoaXNCbGFuayhlbWFpbFZhbHVlKSlcbiAgICAgICAgcmV0dXJuIGRpc3BsYXlGb3JtRXJyb3IoZW1haWxJbnB1dCwgJ1RoaXMgZmllbGQgaXMgcmVxdWlyZWQnKTtcbiAgICBpZiAoIWlzVmFsaWRFbWFpbChlbWFpbFZhbHVlKSlcbiAgICAgICAgcmV0dXJuIGRpc3BsYXlGb3JtRXJyb3IoZW1haWxJbnB1dCwgJ1Byb3ZpZGUgYSB2YWxpZCBlbWFpbCBhZGRyZXNzJyk7XG4gICAgcmV0dXJuIHJlbW92ZUZvcm1FcnJvcihlbWFpbElucHV0KTtcbn1cbmZ1bmN0aW9uIGlzVmFsaWRFbWFpbChlbWFpbCkge1xuICAgIHJldHVybiBFTUFJTF9SRUdFWC50ZXN0KGVtYWlsKTtcbn1cbmZ1bmN0aW9uIHZhbGlkYXRlRGF0ZSgpIHtcbiAgICBpZiAodmFsaWRhdGVEYXkoKSAmJiB2YWxpZGF0ZU1vbnRoKCkgJiYgdmFsaWRhdGVZZWFyKCkpIHtcbiAgICAgICAgY29uc3QgZGF5ID0gTnVtYmVyKGRheUlucHV0LnZhbHVlKTtcbiAgICAgICAgY29uc3QgbW9udGggPSBOdW1iZXIobW9udGhJbnB1dC52YWx1ZSk7XG4gICAgICAgIGNvbnN0IHllYXIgPSBOdW1iZXIoeWVhcklucHV0LnZhbHVlKTtcbiAgICAgICAgaWYgKCFpc0RhdGVBZnRlclRvZGF5KHllYXIsIG1vbnRoLCBkYXkpKVxuICAgICAgICAgICAgcmV0dXJuIGRpc3BsYXlGb3JtRXJyb3IoeWVhcklucHV0LCAnSW5zZXJ0IGRhdGUgYWZ0ZXIgdG9kYXknKTtcbiAgICAgICAgcmV0dXJuIHJlbW92ZUZvcm1FcnJvcih5ZWFySW5wdXQpO1xuICAgIH1cbiAgICByZXR1cm4gZmFsc2U7XG59XG5mdW5jdGlvbiB2YWxpZGF0ZURheSgpIHtcbiAgICBjb25zdCBkYXlWYWx1ZSA9IGRheUlucHV0LnZhbHVlO1xuICAgIGlmIChpc0JsYW5rKGRheVZhbHVlKSlcbiAgICAgICAgcmV0dXJuIGRpc3BsYXlGb3JtRXJyb3IoZGF5SW5wdXQsICdUaGlzIGZpZWxkIGlzIGluY29tcGxldGUnKTtcbiAgICBpZiAoIWlzVmFsaWREYXkoZGF5VmFsdWUpKVxuICAgICAgICByZXR1cm4gZGlzcGxheUZvcm1FcnJvcihkYXlJbnB1dCwgJ0luc2VydCB2YWxpZCBkYXkgdmFsdWUgKDAxIC0gMzEpJyk7XG4gICAgaWYgKCFpc0RheVdpdGhpbk1vbnRoUmFuZ2UoZGF5VmFsdWUpKVxuICAgICAgICByZXR1cm4gZGlzcGxheUZvcm1FcnJvcihkYXlJbnB1dCwgJ0luc2VydCBkYXkgaW4gcmFuZ2Ugb2Ygc2VsZWN0ZWQgbW9udGguJyk7XG4gICAgcmV0dXJuIHJlbW92ZUZvcm1FcnJvcihkYXlJbnB1dCk7XG59XG5mdW5jdGlvbiBpc0RhdGVBZnRlclRvZGF5KHllYXIsIG1vbnRoLCBkYXkpIHtcbiAgICByZXR1cm4gbmV3IERhdGUoeWVhciwgbW9udGggLSAxLCBkYXkpID4gbmV3IERhdGUoKTtcbn1cbmZ1bmN0aW9uIGlzRGF5V2l0aGluTW9udGhSYW5nZShkYXkpIHtcbiAgICBjb25zdCBtb250aCA9IG1vbnRoSW5wdXQudmFsdWU7XG4gICAgY29uc3QgeWVhciA9IHllYXJJbnB1dC52YWx1ZTtcbiAgICBpZiAoIXllYXIgfHwgIW1vbnRoKVxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICBjb25zdCBtb250aERheXMgPSBuZXcgRGF0ZShOdW1iZXIoeWVhciksIE51bWJlcihtb250aCksIDApLmdldERhdGUoKSB8fCBNQVhfREFZU19JTl9NT05USDtcbiAgICByZXR1cm4gTnVtYmVyKGRheSkgPD0gbW9udGhEYXlzO1xufVxuZnVuY3Rpb24gdmFsaWRhdGVNb250aCgpIHtcbiAgICBjb25zdCBtb250aFZhbHVlID0gbW9udGhJbnB1dC52YWx1ZTtcbiAgICBpZiAoaXNCbGFuayhtb250aFZhbHVlKSlcbiAgICAgICAgcmV0dXJuIGRpc3BsYXlGb3JtRXJyb3IobW9udGhJbnB1dCwgJ1RoaXMgZmllbGQgaXMgaW5jb21wbGV0ZScpO1xuICAgIGlmICghaXNWYWxpZE1vbnRoKG1vbnRoVmFsdWUpKVxuICAgICAgICByZXR1cm4gZGlzcGxheUZvcm1FcnJvcihtb250aElucHV0LCAnSW5zZXJ0IHZhbGlkIG1vbnRoIHZhbHVlICgwMSAtIDEyKScpO1xuICAgIHJldHVybiByZW1vdmVGb3JtRXJyb3IobW9udGhJbnB1dCk7XG59XG5mdW5jdGlvbiB2YWxpZGF0ZVllYXIoKSB7XG4gICAgY29uc3QgeWVhclZhbHVlID0geWVhcklucHV0LnZhbHVlO1xuICAgIGlmIChpc0JsYW5rKHllYXJWYWx1ZSkpXG4gICAgICAgIHJldHVybiBkaXNwbGF5Rm9ybUVycm9yKHllYXJJbnB1dCwgJ1RoaXMgZmllbGQgaXMgaW5jb21wbGV0ZScpO1xuICAgIGlmICghaXNWYWxpZFllYXIoeWVhclZhbHVlKSlcbiAgICAgICAgcmV0dXJuIGRpc3BsYXlGb3JtRXJyb3IoeWVhcklucHV0LCAnSW5zZXJ0IHZhbGlkIHllYXIgKDQgZGlnaXQgbnVtYmVyKScpO1xuICAgIHJldHVybiByZW1vdmVGb3JtRXJyb3IoeWVhcklucHV0KTtcbn1cbmZ1bmN0aW9uIGlzVmFsaWREYXkoZGF5KSB7XG4gICAgcmV0dXJuIERBWV9SRUdFWC50ZXN0KGRheSk7XG59XG5mdW5jdGlvbiBpc1ZhbGlkTW9udGgobW9udGgpIHtcbiAgICByZXR1cm4gTU9OVEhfUkVHRVgudGVzdChtb250aCk7XG59XG5mdW5jdGlvbiBpc1ZhbGlkWWVhcih5ZWFyKSB7XG4gICAgcmV0dXJuIFlFQVJfUkVHRVgudGVzdCh5ZWFyKTtcbn1cbmZ1bmN0aW9uIHZhbGlkYXRlVGltZSgpIHtcbiAgICBpZiAodmFsaWRhdGVIb3VyKCkgJiYgdmFsaWRhdGVNaW51dGVzKCkpIHtcbiAgICAgICAgaWYgKCFpc1RpbWVCZXR3ZWVuT3BlbkhvdXJzKCkpXG4gICAgICAgICAgICByZXR1cm4gZGlzcGxheUZvcm1FcnJvcihob3VySW5wdXQsICdJbnNlcnQgdGltZSBiZXR3ZWVuIG9wZW4gaG91cnMnKTtcbiAgICAgICAgcmV0dXJuIHJlbW92ZUZvcm1FcnJvcihob3VySW5wdXQpO1xuICAgIH1cbiAgICByZXR1cm4gZmFsc2U7XG59XG5mdW5jdGlvbiBpc1RpbWVCZXR3ZWVuT3BlbkhvdXJzKCkge1xuICAgIGNvbnN0IGhvdXIgPSBOdW1iZXIoaG91cklucHV0LnZhbHVlKTtcbiAgICBjb25zdCBtaW51dGVzID0gTnVtYmVyKG1pbnV0ZXNJbnB1dC52YWx1ZSk7XG4gICAgY29uc3QgZGF0ZSA9IG5ldyBEYXRlKE51bWJlcih5ZWFySW5wdXQudmFsdWUpLCBOdW1iZXIobW9udGhJbnB1dC52YWx1ZSkgLSAxLCBOdW1iZXIoZGF5SW5wdXQudmFsdWUpKTtcbiAgICBjb25zdCB3ZWVrRGF5ID0gZGF0ZS5nZXREYXkoKTtcbiAgICBjb25zdCBkYXlUaW1lID0gb3JpZ2luYWxTZWxlY3QudmFsdWU7XG4gICAgaWYgKE51bWJlci5pc05hTihob3VyKSB8fCBOdW1iZXIuaXNOYU4obWludXRlcykpXG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICBpZiAoTnVtYmVyLmlzTmFOKHdlZWtEYXkpKVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgaWYgKGRheVRpbWUgPT09ICdhbScpXG4gICAgICAgIHJldHVybiBpc0JldHdlZW5Nb3JuaW5nSG91cnMoaG91cik7XG4gICAgZWxzZVxuICAgICAgICByZXR1cm4gaXNCZXR3ZWVuQWZ0ZXJub29uSG91cnMoaG91ciwgbWludXRlcywgd2Vla0RheSk7XG59XG5mdW5jdGlvbiBpc0JldHdlZW5Nb3JuaW5nSG91cnMoaG91cikge1xuICAgIHJldHVybiBob3VyID49IDkgJiYgaG91ciA8IDEyO1xufVxuZnVuY3Rpb24gaXNCZXR3ZWVuQWZ0ZXJub29uSG91cnMoaG91ciwgbWludXRlcywgd2Vla0RheUNvZGUpIHtcbiAgICBpZiAod2Vla0RheUNvZGUgPD0gRlJJREFZX0NPREUgJiYgd2Vla0RheUNvZGUgPj0gTU9OREFZX0NPREUpIHtcbiAgICAgICAgcmV0dXJuIGhvdXIgPT09IDEyIHx8IGhvdXIgPCAxMDtcbiAgICB9XG4gICAgaWYgKHdlZWtEYXlDb2RlID09PSBTQVRVUkRBWV9DT0RFIHx8IHdlZWtEYXlDb2RlID09PSBTVU5EQVlfQ09ERSkge1xuICAgICAgICByZXR1cm4gaG91ciA9PT0gMTIgfHwgaG91ciA8IDExIHx8IChob3VyID09PSAxMSAmJiBtaW51dGVzIDwgMzApO1xuICAgIH1cbiAgICByZXR1cm4gdHJ1ZTtcbn1cbmZ1bmN0aW9uIHZhbGlkYXRlSG91cigpIHtcbiAgICBjb25zdCBob3VyVmFsdWUgPSBob3VySW5wdXQudmFsdWU7XG4gICAgaWYgKGlzQmxhbmsoaG91clZhbHVlKSlcbiAgICAgICAgcmV0dXJuIGRpc3BsYXlGb3JtRXJyb3IoaG91cklucHV0LCAnVGhpcyBmaWVsZCBpcyBpbmNvbXBsZXRlJyk7XG4gICAgaWYgKCFpc1ZhbGlkSG91cihob3VyVmFsdWUpKVxuICAgICAgICByZXR1cm4gZGlzcGxheUZvcm1FcnJvcihob3VySW5wdXQsICdJbnNlcnQgdmFsaWQgaG91ciBmb3JtYXQgKDAxIC0gMTIpJyk7XG4gICAgcmV0dXJuIHJlbW92ZUZvcm1FcnJvcihob3VySW5wdXQpO1xufVxuZnVuY3Rpb24gdmFsaWRhdGVNaW51dGVzKCkge1xuICAgIGNvbnN0IG1pbnV0ZXNWYWx1ZSA9IG1pbnV0ZXNJbnB1dC52YWx1ZTtcbiAgICBpZiAoaXNCbGFuayhtaW51dGVzVmFsdWUpKVxuICAgICAgICByZXR1cm4gZGlzcGxheUZvcm1FcnJvcihtaW51dGVzSW5wdXQsICdUaGlzIGZpZWxkIGlzIGluY29tcGxldGUnKTtcbiAgICBpZiAoIWFyZVZhbGlkTWludXRlcyhtaW51dGVzVmFsdWUpKVxuICAgICAgICByZXR1cm4gZGlzcGxheUZvcm1FcnJvcihtaW51dGVzSW5wdXQsICdJbnNlcnQgdmFsaWQgbWludXRlcyBmb3JtYXQgKDAwIC0gNTkpJyk7XG4gICAgcmV0dXJuIHJlbW92ZUZvcm1FcnJvcihtaW51dGVzSW5wdXQpO1xufVxuZnVuY3Rpb24gaXNWYWxpZEhvdXIoaG91cikge1xuICAgIHJldHVybiBIT1VSX1JFR0VYLnRlc3QoaG91cik7XG59XG5mdW5jdGlvbiBhcmVWYWxpZE1pbnV0ZXMobWludXRlcykge1xuICAgIHJldHVybiBNSU5VVEVTX1JFR0VYLnRlc3QobWludXRlcyk7XG59XG5mdW5jdGlvbiBpc0JsYW5rKHZhbHVlKSB7XG4gICAgcmV0dXJuIHZhbHVlID09PSAnJztcbn1cbmZ1bmN0aW9uIGRpc3BsYXlGb3JtRXJyb3IoaW5wdXQsIG1lc3NhZ2UpIHtcbiAgICBsZXQgZm9ybUdyb3VwID0gaW5wdXQuY2xvc2VzdCgnLmZvcm0tZ3JvdXAnKTtcbiAgICBsZXQgZm9ybUVycm9yO1xuICAgIHdoaWxlIChmb3JtR3JvdXApIHtcbiAgICAgICAgZm9ybUdyb3VwLmNsYXNzTGlzdC5hZGQoJ2Vycm9yJyk7XG4gICAgICAgIGZvcm1FcnJvciA9IGZvcm1Hcm91cC5xdWVyeVNlbGVjdG9yKCcuZm9ybS1lcnJvcicpO1xuICAgICAgICBpZiAoZm9ybUVycm9yKSB7XG4gICAgICAgICAgICBmb3JtRXJyb3IuaW5uZXJUZXh0ID0gbWVzc2FnZTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIGZvcm1Hcm91cCA9IGZvcm1Hcm91cC5wYXJlbnRFbGVtZW50LmNsb3Nlc3QoJy5mb3JtLWdyb3VwJyk7XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcbn1cbmZ1bmN0aW9uIHJlbW92ZUZvcm1FcnJvcihpbnB1dCkge1xuICAgIGxldCBmb3JtR3JvdXAgPSBpbnB1dC5jbG9zZXN0KCcuZm9ybS1ncm91cCcpO1xuICAgIGxldCBmb3JtRXJyb3I7XG4gICAgd2hpbGUgKGZvcm1Hcm91cCkge1xuICAgICAgICBmb3JtR3JvdXAuY2xhc3NMaXN0LnJlbW92ZSgnZXJyb3InKTtcbiAgICAgICAgZm9ybUVycm9yID0gZm9ybUdyb3VwLnF1ZXJ5U2VsZWN0b3IoJy5mb3JtLWVycm9yJyk7XG4gICAgICAgIGlmIChmb3JtRXJyb3IpXG4gICAgICAgICAgICBmb3JtRXJyb3IuaW5uZXJUZXh0ID0gJyc7XG4gICAgICAgIGZvcm1Hcm91cCA9IGZvcm1Hcm91cC5wYXJlbnRFbGVtZW50LmNsb3Nlc3QoJy5mb3JtLWdyb3VwJyk7XG4gICAgfVxuICAgIHJldHVybiB0cnVlO1xufVxuIl19
