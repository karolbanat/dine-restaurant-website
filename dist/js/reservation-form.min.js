"use strict";var customSelect=document.querySelector(".custom-select"),originalSelect=customSelect.querySelector("select"),originalSelectOptions=Array.from(originalSelect.querySelectorAll("option")),customSelectFocus=customSelect.querySelector(".custom-select__focus"),customSelectFocusText=customSelectFocus.querySelector("span"),customSelectOptionsContainer=customSelect.querySelector(".custom-select__options"),customSelectOptions=[],customSpinbutton=document.querySelector(".spinbutton"),spinButton=customSpinbutton.querySelector('[role="spinbutton"]'),decreaseSpinbutton=customSpinbutton.querySelector("#decrease-people"),increaseSpinbutton=customSpinbutton.querySelector("#increase-people"),reservationForm=document.querySelector(".reservation-form"),nameInput=reservationForm.querySelector('input[name="name"]'),emailInput=reservationForm.querySelector('input[name="email"]'),monthInput=reservationForm.querySelector('input[name="month"]'),dayInput=reservationForm.querySelector('input[name="day"]'),yearInput=reservationForm.querySelector('input[name="year"]'),hourInput=reservationForm.querySelector('input[name="hour"]'),minutesInput=reservationForm.querySelector('input[name="minute"]'),reservationSubmitBtn=reservationForm.querySelector('button[type="submit"]'),CHECK_ICON_URL="./dist/assets/images/icons/icon-check.svg",EMAIL_REGEX=/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,DAY_REGEX=/^(0[1-9])|([1-2]\d)|(3[0-1])$/,MAX_DAYS_IN_MONTH=31,MONTH_REGEX=/^(0[1-9])|(1[0-2])$/,YEAR_REGEX=/^\d{4}$/,HOUR_REGEX=/^(0[1-9])|(1[0-2])$/,MINUTES_REGEX=/^([0-5]\d)$/,MONDAY_CODE=1,FRIDAY_CODE=5,SATURDAY_CODE=6,SUNDAY_CODE=0;function createCustomSelectOptions(){originalSelectOptions.forEach(function(e){e=createCustomOption(e);customSelectOptions.push(e),customSelectOptionsContainer.appendChild(e)})}function createCustomOption(e){var t=document.createElement("span"),r=(t.classList.add("custom-select__option"),t.setAttribute("data-selected",e.selected.toString()),t.setAttribute("data-value",e.value),t.addEventListener("click",handleCustomOption),document.createElement("img")),n=(r.setAttribute("src",CHECK_ICON_URL),r.setAttribute("alt",""),document.createElement("span"));return n.innerText=e.innerText,t.appendChild(r),t.appendChild(n),t}function handleCustomOption(e){var t=e.target;originalSelectOptions.forEach(function(e){return e.selected=e.value===t.dataset.value}),handleSelection(),closeCustomSelect()}function handleSelection(){var t=originalSelectOptions.filter(function(e){return e.selected})[0].value;customSelectFocusText.innerText=t.toUpperCase(),customSelectOptions.forEach(function(e){e.dataset.selected=(e.dataset.value===t).toString()})}function openCustomSelect(){customSelect.dataset.open="true"}function closeCustomSelect(){customSelect.dataset.open="false"}function handleSpinButton(e){switch(e.key){case"ArrowUp":e.preventDefault(),increasePeople();break;case"ArrowDown":e.preventDefault(),decreasePeople();break;case"Home":e.preventDefault(),setMinPeople();break;case"End":e.preventDefault(),setMaxPeople()}}function increasePeople(){var e=Number(spinButton.getAttribute("aria-valuenow")),t=Number(spinButton.getAttribute("aria-valuemax"));updateSpinButton(Math.min(e+1,t))}function decreasePeople(){var e=Number(spinButton.getAttribute("aria-valuenow")),t=Number(spinButton.getAttribute("aria-valuemin"));updateSpinButton(Math.max(e-1,t))}function setMaxPeople(){updateSpinButton(Number(spinButton.getAttribute("aria-valuemax")))}function setMinPeople(){updateSpinButton(Number(spinButton.getAttribute("aria-valuemin")))}function updateSpinButton(e){spinButton.setAttribute("aria-valuenow",e.toString()),spinButton.setAttribute("aria-valuetext","".concat(e," people")),spinButton.innerText="".concat(e," people")}function validateName(){return isBlank(nameInput.value)?displayFormError(nameInput,"This field is required"):removeFormError(nameInput)}function validateEmail(){var e=emailInput.value;return isBlank(e)?displayFormError(emailInput,"This field is required"):isValidEmail(e)?removeFormError(emailInput):displayFormError(emailInput,"Provide a valid email address")}function isValidEmail(e){return EMAIL_REGEX.test(e)}function validateDate(){var e,t;return!!(validateDay()&&validateMonth()&&validateYear())&&(e=Number(dayInput.value),t=Number(monthInput.value),isDateAfterToday(Number(yearInput.value),t,e)?removeFormError(yearInput):displayFormError(yearInput,"Insert date after today"))}function validateDay(){var e=dayInput.value;return isBlank(e)?displayFormError(dayInput,"This field is incomplete"):isValidDay(e)?isDayWithinMonthRange(e)?removeFormError(dayInput):displayFormError(dayInput,"Insert day in range of selected month."):displayFormError(dayInput,"Insert valid day value (01 - 31)")}function isDateAfterToday(e,t,r){return new Date(e,t-1,r)>new Date}function isDayWithinMonthRange(e){var t=monthInput.value,r=yearInput.value;return!r||!t||(r=new Date(Number(r),Number(t),0).getDate()||MAX_DAYS_IN_MONTH,Number(e)<=r)}function validateMonth(){var e=monthInput.value;return isBlank(e)?displayFormError(monthInput,"This field is incomplete"):isValidMonth(e)?removeFormError(monthInput):displayFormError(monthInput,"Insert valid month value (01 - 12)")}function validateYear(){var e=yearInput.value;return isBlank(e)?displayFormError(yearInput,"This field is incomplete"):isValidYear(e)?removeFormError(yearInput):displayFormError(yearInput,"Insert valid year (4 digit number)")}function isValidDay(e){return DAY_REGEX.test(e)}function isValidMonth(e){return MONTH_REGEX.test(e)}function isValidYear(e){return YEAR_REGEX.test(e)}function validateTime(){return!(!validateHour()||!validateMinutes())&&(isTimeBetweenOpenHours()?removeFormError(hourInput):displayFormError(hourInput,"Insert time between open hours"))}function isTimeBetweenOpenHours(){var e=Number(hourInput.value),t=Number(minutesInput.value),r=new Date(Number(yearInput.value),Number(monthInput.value)-1,Number(dayInput.value)).getDay(),n=originalSelect.value;return!Number.isNaN(e)&&!Number.isNaN(t)&&!Number.isNaN(r)&&("am"===n?isBetweenMorningHours(e):isBetweenAfternoonHours(e,t,r))}function isBetweenMorningHours(e){return 9<=e&&e<12}function isBetweenAfternoonHours(e,t,r){return r<=FRIDAY_CODE&&MONDAY_CODE<=r?12===e||e<10:r!==SATURDAY_CODE&&r!==SUNDAY_CODE||12===e||e<11||11===e&&t<30}function validateHour(){var e=hourInput.value;return isBlank(e)?displayFormError(hourInput,"This field is incomplete"):isValidHour(e)?removeFormError(hourInput):displayFormError(hourInput,"Insert valid hour format (01 - 12)")}function validateMinutes(){var e=minutesInput.value;return isBlank(e)?displayFormError(minutesInput,"This field is incomplete"):areValidMinutes(e)?removeFormError(minutesInput):displayFormError(minutesInput,"Insert valid minutes format (00 - 59)")}function isValidHour(e){return HOUR_REGEX.test(e)}function areValidMinutes(e){return MINUTES_REGEX.test(e)}function isBlank(e){return""===e}function displayFormError(e,t){for(var r,n=e.closest(".form-group");n;){if(n.classList.add("error"),r=n.querySelector(".form-error")){r.innerText=t;break}n=n.parentElement.closest(".form-group")}return!1}function removeFormError(e){for(var t,r=e.closest(".form-group");r;)r.classList.remove("error"),(t=r.querySelector(".form-error"))&&(t.innerText=""),r=r.parentElement.closest(".form-group");return!0}createCustomSelectOptions(),originalSelect.addEventListener("keyup",function(e){switch(e.key){case"ArrowUp":case"ArrowDown":case"ArrowLeft":case"ArrowRight":handleSelection();break;case"Enter":handleSelection(),closeCustomSelect()}}),customSelectFocus.addEventListener("click",function(e){originalSelect.focus()}),originalSelect.addEventListener("focusin",openCustomSelect),spinButton.addEventListener("keydown",handleSpinButton),increaseSpinbutton.addEventListener("click",increasePeople),decreaseSpinbutton.addEventListener("click",decreasePeople),reservationSubmitBtn.addEventListener("click",function(e){e.preventDefault();var e=validateName(),t=validateEmail(),r=validateDate(),n=validateTime();e&&t&&r&&n&&reservationForm.setAttribute("data-valid","true")});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInJlc2VydmF0aW9uLWZvcm0udHMiLCJyZXNlcnZhdGlvbi1mb3JtLmpzIl0sIm5hbWVzIjpbImN1c3RvbVNlbGVjdCIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsIm9yaWdpbmFsU2VsZWN0Iiwib3JpZ2luYWxTZWxlY3RPcHRpb25zIiwiQXJyYXkiLCJmcm9tIiwicXVlcnlTZWxlY3RvckFsbCIsImN1c3RvbVNlbGVjdEZvY3VzIiwiY3VzdG9tU2VsZWN0Rm9jdXNUZXh0IiwiY3VzdG9tU2VsZWN0T3B0aW9uc0NvbnRhaW5lciIsImN1c3RvbVNlbGVjdE9wdGlvbnMiLCJjdXN0b21TcGluYnV0dG9uIiwic3BpbkJ1dHRvbiIsImRlY3JlYXNlU3BpbmJ1dHRvbiIsImluY3JlYXNlU3BpbmJ1dHRvbiIsInJlc2VydmF0aW9uRm9ybSIsIm5hbWVJbnB1dCIsImVtYWlsSW5wdXQiLCJtb250aElucHV0IiwiZGF5SW5wdXQiLCJ5ZWFySW5wdXQiLCJob3VySW5wdXQiLCJtaW51dGVzSW5wdXQiLCJyZXNlcnZhdGlvblN1Ym1pdEJ0biIsIkNIRUNLX0lDT05fVVJMIiwiRU1BSUxfUkVHRVgiLCJEQVlfUkVHRVgiLCJNQVhfREFZU19JTl9NT05USCIsIk1PTlRIX1JFR0VYIiwiWUVBUl9SRUdFWCIsIkhPVVJfUkVHRVgiLCJNSU5VVEVTX1JFR0VYIiwiTU9OREFZX0NPREUiLCJGUklEQVlfQ09ERSIsIlNBVFVSREFZX0NPREUiLCJTVU5EQVlfQ09ERSIsImNyZWF0ZUN1c3RvbVNlbGVjdE9wdGlvbnMiLCJmb3JFYWNoIiwib3B0aW9uIiwiY3VzdG9tT3B0aW9uIiwiY3JlYXRlQ3VzdG9tT3B0aW9uIiwicHVzaCIsImFwcGVuZENoaWxkIiwib3B0aW9uV3JhcHBlciIsImNyZWF0ZUVsZW1lbnQiLCJjaGVja0ltYWdlIiwiY2xhc3NMaXN0IiwiYWRkIiwic2V0QXR0cmlidXRlIiwic2VsZWN0ZWQiLCJ0b1N0cmluZyIsInZhbHVlIiwiYWRkRXZlbnRMaXN0ZW5lciIsImhhbmRsZUN1c3RvbU9wdGlvbiIsIm9wdGlvblRleHQiLCJpbm5lclRleHQiLCJlIiwidGFyZ2V0Iiwib3B0IiwiZGF0YXNldCIsImhhbmRsZVNlbGVjdGlvbiIsImNsb3NlQ3VzdG9tU2VsZWN0Iiwic2VsZWN0ZWRWYWx1ZSIsImZpbHRlciIsInRvVXBwZXJDYXNlIiwib3BlbkN1c3RvbVNlbGVjdCIsIm9wZW4iLCJoYW5kbGVTcGluQnV0dG9uIiwia2V5IiwicHJldmVudERlZmF1bHQiLCJpbmNyZWFzZVBlb3BsZSIsImRlY3JlYXNlUGVvcGxlIiwic2V0TWluUGVvcGxlIiwic2V0TWF4UGVvcGxlIiwiY3VycmVudFZhbHVlIiwiTnVtYmVyIiwiZ2V0QXR0cmlidXRlIiwibWF4VmFsdWUiLCJ1cGRhdGVTcGluQnV0dG9uIiwiTWF0aCIsIm1pbiIsIm1pblZhbHVlIiwibWF4IiwibmV3VmFsdWUiLCJjb25jYXQiLCJ2YWxpZGF0ZU5hbWUiLCJpc0JsYW5rIiwiZGlzcGxheUZvcm1FcnJvciIsInJlbW92ZUZvcm1FcnJvciIsInZhbGlkYXRlRW1haWwiLCJlbWFpbFZhbHVlIiwiaXNWYWxpZEVtYWlsIiwiZW1haWwiLCJ0ZXN0IiwidmFsaWRhdGVEYXRlIiwiZGF5IiwibW9udGgiLCJ2YWxpZGF0ZURheSIsInZhbGlkYXRlTW9udGgiLCJ2YWxpZGF0ZVllYXIiLCJpc0RhdGVBZnRlclRvZGF5IiwiZGF5VmFsdWUiLCJpc1ZhbGlkRGF5IiwiaXNEYXlXaXRoaW5Nb250aFJhbmdlIiwieWVhciIsIkRhdGUiLCJtb250aERheXMiLCJnZXREYXRlIiwibW9udGhWYWx1ZSIsImlzVmFsaWRNb250aCIsInllYXJWYWx1ZSIsImlzVmFsaWRZZWFyIiwidmFsaWRhdGVUaW1lIiwidmFsaWRhdGVIb3VyIiwidmFsaWRhdGVNaW51dGVzIiwiaXNUaW1lQmV0d2Vlbk9wZW5Ib3VycyIsImhvdXIiLCJtaW51dGVzIiwid2Vla0RheSIsImdldERheSIsImRheVRpbWUiLCJpc05hTiIsImlzQmV0d2Vlbk1vcm5pbmdIb3VycyIsImlzQmV0d2VlbkFmdGVybm9vbkhvdXJzIiwid2Vla0RheUNvZGUiLCJob3VyVmFsdWUiLCJpc1ZhbGlkSG91ciIsIm1pbnV0ZXNWYWx1ZSIsImFyZVZhbGlkTWludXRlcyIsImlucHV0IiwibWVzc2FnZSIsImZvcm1FcnJvciIsImZvcm1Hcm91cCIsImNsb3Nlc3QiLCJwYXJlbnRFbGVtZW50IiwicmVtb3ZlIiwiZm9jdXMiLCJpc05hbWVWYWxpZCIsImlzRW1haWxWYWxpZCIsImlzRGF0ZVZhbGlkIiwiaXNUaW1lVmFsaWQiXSwibWFwcGluZ3MiOiJhQUNBLElBQU1BLGFBQTRCQyxTQUFTQyxjQUFjLGdCQUFnQixFQUNuRUMsZUFBb0NILGFBQWFFLGNBQWMsUUFBUSxFQUN2RUUsc0JBQWtEQyxNQUFNQyxLQUFLSCxlQUFlSSxpQkFBaUIsUUFBUSxDQUFDLEVBQ3RHQyxrQkFBaUNSLGFBQWFFLGNBQWMsdUJBQXVCLEVBQ25GTyxzQkFBcUNELGtCQUFrQk4sY0FBYyxNQUFNLEVBQzNFUSw2QkFBNENWLGFBQWFFLGNBQWMseUJBQXlCLEVBQ2xHUyxvQkFBMEMsR0FHeENDLGlCQUFnQ1gsU0FBU0MsY0FBYyxhQUFhLEVBQ3BFVyxXQUEwQkQsaUJBQWlCVixjQUFjLHFCQUFxQixFQUM5RVksbUJBQXdDRixpQkFBaUJWLGNBQWMsa0JBQWtCLEVBQ3pGYSxtQkFBd0NILGlCQUFpQlYsY0FBYyxrQkFBa0IsRUFHekZjLGdCQUFtQ2YsU0FBU0MsY0FBYyxtQkFBbUIsRUFDN0VlLFVBQThCRCxnQkFBZ0JkLGNBQWMsb0JBQW9CLEVBQ2hGZ0IsV0FBK0JGLGdCQUFnQmQsY0FBYyxxQkFBcUIsRUFDbEZpQixXQUErQkgsZ0JBQWdCZCxjQUFjLHFCQUFxQixFQUNsRmtCLFNBQTZCSixnQkFBZ0JkLGNBQWMsbUJBQW1CLEVBQzlFbUIsVUFBOEJMLGdCQUFnQmQsY0FBYyxvQkFBb0IsRUFDaEZvQixVQUE4Qk4sZ0JBQWdCZCxjQUFjLG9CQUFvQixFQUNoRnFCLGFBQWlDUCxnQkFBZ0JkLGNBQWMsc0JB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UUEsRUFBRVksS0FDVCxJQUFLLFVBQ0wsSUFBSyxZQUNMLElBQUssWUFDTCxJQUFLLGFBQ0pSLGdCQUFlLEVBQ2YsTUFDRCxJQUFLLFFBQ0pBLGdCQUFlLEVBQ2ZDLGtCQUFpQixDQUNYLENBRVQsQ0FBQyxFQUVEdEQsa0JBQWtCNkMsaUJBQWlCLFFBQVMsU0FBQ0ksR0FDNUN0RCxlQUFlc0ksTUFBSyxDQUNyQixDQUFDLEVBRUR0SSxlQUFla0QsaUJBQWlCLFVBQVdhLGdCQUFnQixFQUczRHJELFdBQVd3QyxpQkFBaUIsVUFBV2UsZ0JBQWdCLEVBQ3ZEckQsbUJBQW1Cc0MsaUJBQWlCLFFBQVNrQixjQUFjLEVBQzNEekQsbUJBQW1CdUMsaUJBQWlCLFFBQVNtQixjQUFjLEVBRzNEaEQscUJBQXFCNkIsaUJBQWlCLFFBQVMsU0FBQ0ksR0FDL0NBLEVBQUVhLGVBQWMsRUFDaEIsSUFBTW9FLEVBQXVCcEQsYUFBWSxFQUNuQ3FELEVBQXdCakQsY0FBYSxFQUNyQ2tELEVBQXVCN0MsYUFBWSxFQUNuQzhDLEVBQXVCNUIsYUFBWSxFQUVyQ3lCLEdBQWVDLEdBQWdCQyxHQUFlQyxHQUNqRDdILGdCQUFnQmlDLGFBQWEsYUFBYyxNQUFNLENBRW5ELENBQUMiLCJmaWxlIjoicmVzZXJ2YXRpb24tZm9ybS5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKiBjdXN0b20gc2VsZWN0IGVsZW1lbnRzICovXHJcbmNvbnN0IGN1c3RvbVNlbGVjdDogSFRNTEVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY3VzdG9tLXNlbGVjdCcpO1xyXG5jb25zdCBvcmlnaW5hbFNlbGVjdDogSFRNTFNlbGVjdEVsZW1lbnQgPSBjdXN0b21TZWxlY3QucXVlcnlTZWxlY3Rvcignc2VsZWN0Jyk7XHJcbmNvbnN0IG9yaWdpbmFsU2VsZWN0T3B0aW9uczogQXJyYXk8SFRNTE9wdGlvbkVsZW1lbnQ+ID0gQXJyYXkuZnJvbShvcmlnaW5hbFNlbGVjdC5xdWVyeVNlbGVjdG9yQWxsKCdvcHRpb24nKSk7XHJcbmNvbnN0IGN1c3RvbVNlbGVjdEZvY3VzOiBIVE1MRWxlbWVudCA9IGN1c3RvbVNlbGVjdC5xdWVyeVNlbGVjdG9yKCcuY3VzdG9tLXNlbGVjdF9fZm9jdXMnKTtcclxuY29uc3QgY3VzdG9tU2VsZWN0Rm9jdXNUZXh0OiBIVE1MRWxlbWVudCA9IGN1c3RvbVNlbGVjdEZvY3VzLnF1ZXJ5U2VsZWN0b3IoJ3NwYW4nKTtcclxuY29uc3QgY3VzdG9tU2VsZWN0T3B0aW9uc0NvbnRhaW5lcjogSFRNTEVsZW1lbnQgPSBjdXN0b21TZWxlY3QucXVlcnlTZWxlY3RvcignLmN1c3RvbS1zZWxlY3RfX29wdGlvbnMnKTtcclxubGV0IGN1c3RvbVNlbGVjdE9wdGlvbnM6IEFycmF5PEhUTUxFbGVtZW50PiA9IFtdO1xyXG5cclxuLyogc3BpbmJ1dHRvbiBlbGVtZW50cyAqL1xyXG5jb25zdCBjdXN0b21TcGluYnV0dG9uOiBIVE1MRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5zcGluYnV0dG9uJyk7XHJcbmNvbnN0IHNwaW5CdXR0b246IEhUTUxFbGVtZW50ID0gY3VzdG9tU3BpbmJ1dHRvbi5xdWVyeVNlbGVjdG9yKCdbcm9sZT1cInNwaW5idXR0b25cIl0nKTtcclxuY29uc3QgZGVjcmVhc2VTcGluYnV0dG9uOiBIVE1MQnV0dG9uRWxlbWVudCA9IGN1c3RvbVNwaW5idXR0b24ucXVlcnlTZWxlY3RvcignI2RlY3JlYXNlLXBlb3BsZScpO1xyXG5jb25zdCBpbmNyZWFzZVNwaW5idXR0b246IEhUTUxCdXR0b25FbGVtZW50ID0gY3VzdG9tU3BpbmJ1dHRvbi5xdWVyeVNlbGVjdG9yKCcjaW5jcmVhc2UtcGVvcGxlJyk7XHJcblxyXG4vKiBmb3JtIGVsZW1lbnRzICovXHJcbmNvbnN0IHJlc2VydmF0aW9uRm9ybTogSFRNTEZvcm1FbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnJlc2VydmF0aW9uLWZvcm0nKTtcclxuY29uc3QgbmFtZUlucHV0OiBIVE1MSW5wdXRFbGVtZW50ID0gcmVzZXJ2YXRpb25Gb3JtLnF1ZXJ5U2VsZWN0b3IoJ2lucHV0W25hbWU9XCJuYW1lXCJdJyk7XHJcbmNvbnN0IGVtYWlsSW5wdXQ6IEhUTUxJbnB1dEVsZW1lbnQgPSByZXNlcnZhdGlvbkZvcm0ucXVlcnlTZWxlY3RvcignaW5wdXRbbmFtZT1cImVtYWlsXCJdJyk7XHJcbmNvbnN0IG1vbnRoSW5wdXQ6IEhUTUxJbnB1dEVsZW1lbnQgPSByZXNlcnZhdGlvbkZvcm0ucXVlcnlTZWxlY3RvcignaW5wdXRbbmFtZT1cIm1vbnRoXCJdJyk7XHJcbmNvbnN0IGRheUlucHV0OiBIVE1MSW5wdXRFbGVtZW50ID0gcmVzZXJ2YXRpb25Gb3JtLnF1ZXJ5U2VsZWN0b3IoJ2lucHV0W25hbWU9XCJkYXlcIl0nKTtcclxuY29uc3QgeWVhcklucHV0OiBIVE1MSW5wdXRFbGVtZW50ID0gcmVzZXJ2YXRpb25Gb3JtLnF1ZXJ5U2VsZWN0b3IoJ2lucHV0W25hbWU9XCJ5ZWFyXCJdJyk7XHJcbmNvbnN0IGhvdXJJbnB1dDogSFRNTElucHV0RWxlbWVudCA9IHJlc2VydmF0aW9uRm9ybS5xdWVyeVNlbGVjdG9yKCdpbnB1dFtuYW1lPVwiaG91clwiXScpO1xyXG5jb25zdCBtaW51dGVzSW5wdXQ6IEhUTUxJbnB1dEVsZW1lbnQgPSByZXNlcnZhdGlvbkZvcm0ucXVlcnlTZWxlY3RvcignaW5wdXRbbmFtZT1cIm1pbnV0ZVwiXScpO1xyXG5jb25zdCByZXNlcnZhdGlvblN1Ym1pdEJ0bjogSFRNTEJ1dHRvbkVsZW1lbnQgPSByZXNlcnZhdGlvbkZvcm0ucXVlcnlTZWxlY3RvcignYnV0dG9uW3R5cGU9XCJzdWJtaXRcIl0nKTtcclxuXHJcbi8qIGNvbnN0YW50cyAqL1xyXG5jb25zdCBDSEVDS19JQ09OX1VSTDogc3RyaW5nID0gJy4vZGlzdC9hc3NldHMvaW1hZ2VzL2ljb25zL2ljb24tY2hlY2suc3ZnJztcclxuY29uc3QgRU1BSUxfUkVHRVggPVxyXG5cdC9eKChbXjw+KClbXFxdXFxcXC4sOzpcXHNAXCJdKyhcXC5bXjw+KClbXFxdXFxcXC4sOzpcXHNAXCJdKykqKXwoXCIuK1wiKSlAKChcXFtbMC05XXsxLDN9XFwuWzAtOV17MSwzfVxcLlswLTldezEsM31cXC5bMC05XXsxLDN9XFxdKXwoKFthLXpBLVpcXC0wLTldK1xcLikrW2EtekEtWl17Mix9KSkkLztcclxuY29uc3QgREFZX1JFR0VYID0gL14oMFsxLTldKXwoWzEtMl1cXGQpfCgzWzAtMV0pJC87XHJcbmNvbnN0IE1BWF9EQVlTX0lOX01PTlRIID0gMzE7XHJcbmNvbnN0IE1PTlRIX1JFR0VYID0gL14oMFsxLTldKXwoMVswLTJdKSQvO1xyXG5jb25zdCBZRUFSX1JFR0VYID0gL15cXGR7NH0kLztcclxuY29uc3QgSE9VUl9SRUdFWCA9IC9eKDBbMS05XSl8KDFbMC0yXSkkLztcclxuY29uc3QgTUlOVVRFU19SRUdFWCA9IC9eKFswLTVdXFxkKSQvO1xyXG5jb25zdCBNT05EQVlfQ09ERSA9IDE7XHJcbmNvbnN0IEZSSURBWV9DT0RFID0gNTtcclxuY29uc3QgU0FUVVJEQVlfQ09ERSA9IDY7XHJcbmNvbnN0IFNVTkRBWV9DT0RFID0gMDtcclxuXHJcbmNyZWF0ZUN1c3RvbVNlbGVjdE9wdGlvbnMoKTtcclxuXHJcbi8qIGV2ZW50IGxpc3RlbmVycyAqL1xyXG4vKiAtLS0gZm9yIGN1c3RvbSBzZWxlY3QgKi9cclxub3JpZ2luYWxTZWxlY3QuYWRkRXZlbnRMaXN0ZW5lcigna2V5dXAnLCAoZTogS2V5Ym9hcmRFdmVudCkgPT4ge1xyXG5cdHN3aXRjaCAoZS5rZXkpIHtcclxuXHRcdGNhc2UgJ0Fycm93VXAnOlxyXG5cdFx0Y2FzZSAnQXJyb3dEb3duJzpcclxuXHRcdGNhc2UgJ0Fycm93TGVmdCc6XHJcblx0XHRjYXNlICdBcnJvd1JpZ2h0JzpcclxuXHRcdFx0aGFuZGxlU2VsZWN0aW9uKCk7XHJcblx0XHRcdGJyZWFrO1xyXG5cdFx0Y2FzZSAnRW50ZXInOlxyXG5cdFx0XHRoYW5kbGVTZWxlY3Rpb24oKTtcclxuXHRcdFx0Y2xvc2VDdXN0b21TZWxlY3QoKTtcclxuXHRcdFx0YnJlYWs7XHJcblx0fVxyXG59KTtcclxuXHJcbmN1c3RvbVNlbGVjdEZvY3VzLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGU6IEV2ZW50KSA9PiB7XHJcblx0b3JpZ2luYWxTZWxlY3QuZm9jdXMoKTtcclxufSk7XHJcblxyXG5vcmlnaW5hbFNlbGVjdC5hZGRFdmVudExpc3RlbmVyKCdmb2N1c2luJywgb3BlbkN1c3RvbVNlbGVjdCk7XHJcblxyXG4vKiAtLS0gZm9yIHNwaW5idXR0b24gKi9cclxuc3BpbkJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgaGFuZGxlU3BpbkJ1dHRvbik7XHJcbmluY3JlYXNlU3BpbmJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGluY3JlYXNlUGVvcGxlKTtcclxuZGVjcmVhc2VTcGluYnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZGVjcmVhc2VQZW9wbGUpO1xyXG5cclxuLyogLS0tIGZvciByZXNlcnZhdGlvbiBmb3JtICovXHJcbnJlc2VydmF0aW9uU3VibWl0QnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGU6IEV2ZW50KSA9PiB7XHJcblx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cdGNvbnN0IGlzTmFtZVZhbGlkOiBib29sZWFuID0gdmFsaWRhdGVOYW1lKCk7XHJcblx0Y29uc3QgaXNFbWFpbFZhbGlkOiBib29sZWFuID0gdmFsaWRhdGVFbWFpbCgpO1xyXG5cdGNvbnN0IGlzRGF0ZVZhbGlkOiBib29sZWFuID0gdmFsaWRhdGVEYXRlKCk7XHJcblx0Y29uc3QgaXNUaW1lVmFsaWQ6IGJvb2xlYW4gPSB2YWxpZGF0ZVRpbWUoKTtcclxuXHJcblx0aWYgKGlzTmFtZVZhbGlkICYmIGlzRW1haWxWYWxpZCAmJiBpc0RhdGVWYWxpZCAmJiBpc1RpbWVWYWxpZCkge1xyXG5cdFx0cmVzZXJ2YXRpb25Gb3JtLnNldEF0dHJpYnV0ZSgnZGF0YS12YWxpZCcsICd0cnVlJyk7XHJcblx0fVxyXG59KTtcclxuXHJcbi8qIGhlbHBlciBmdW5jdGlvbnMgKi9cclxuLyogLS0tIGZvciBjdXN0b20gc2VsZWN0ICovXHJcbmZ1bmN0aW9uIGNyZWF0ZUN1c3RvbVNlbGVjdE9wdGlvbnMoKTogdm9pZCB7XHJcblx0b3JpZ2luYWxTZWxlY3RPcHRpb25zLmZvckVhY2gob3B0aW9uID0+IHtcclxuXHRcdGNvbnN0IGN1c3RvbU9wdGlvbjogSFRNTEVsZW1lbnQgPSBjcmVhdGVDdXN0b21PcHRpb24ob3B0aW9uKTtcclxuXHRcdGN1c3RvbVNlbGVjdE9wdGlvbnMucHVzaChjdXN0b21PcHRpb24pO1xyXG5cdFx0Y3VzdG9tU2VsZWN0T3B0aW9uc0NvbnRhaW5lci5hcHBlbmRDaGlsZChjdXN0b21PcHRpb24pO1xyXG5cdH0pO1xyXG59XHJcblxyXG5mdW5jdGlvbiBjcmVhdGVDdXN0b21PcHRpb24ob3B0aW9uOiBIVE1MT3B0aW9uRWxlbWVudCk6IEhUTUxFbGVtZW50IHtcclxuXHRjb25zdCBvcHRpb25XcmFwcGVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpO1xyXG5cdG9wdGlvbldyYXBwZXIuY2xhc3NMaXN0LmFkZCgnY3VzdG9tLXNlbGVjdF9fb3B0aW9uJyk7XHJcblx0b3B0aW9uV3JhcHBlci5zZXRBdHRyaWJ1dGUoJ2RhdGEtc2VsZWN0ZWQnLCBvcHRpb24uc2VsZWN0ZWQudG9TdHJpbmcoKSk7XHJcblx0b3B0aW9uV3JhcHBlci5zZXRBdHRyaWJ1dGUoJ2RhdGEtdmFsdWUnLCBvcHRpb24udmFsdWUpO1xyXG5cdG9wdGlvbldyYXBwZXIuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBoYW5kbGVDdXN0b21PcHRpb24pO1xyXG5cclxuXHRjb25zdCBjaGVja0ltYWdlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW1nJyk7XHJcblx0Y2hlY2tJbWFnZS5zZXRBdHRyaWJ1dGUoJ3NyYycsIENIRUNLX0lDT05fVVJMKTtcclxuXHRjaGVja0ltYWdlLnNldEF0dHJpYnV0ZSgnYWx0JywgJycpO1xyXG5cclxuXHRjb25zdCBvcHRpb25UZXh0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpO1xyXG5cdG9wdGlvblRleHQuaW5uZXJUZXh0ID0gb3B0aW9uLmlubmVyVGV4dDtcclxuXHJcblx0b3B0aW9uV3JhcHBlci5hcHBlbmRDaGlsZChjaGVja0ltYWdlKTtcclxuXHRvcHRpb25XcmFwcGVyLmFwcGVuZENoaWxkKG9wdGlvblRleHQpO1xyXG5cclxuXHRyZXR1cm4gb3B0aW9uV3JhcHBlcjtcclxufVxyXG5cclxuZnVuY3Rpb24gaGFuZGxlQ3VzdG9tT3B0aW9uKGU6IEV2ZW50KTogdm9pZCB7XHJcblx0Y29uc3Qgb3B0aW9uOiBIVE1MRWxlbWVudCA9IGUudGFyZ2V0IGFzIEhUTUxFbGVtZW50O1xyXG5cdG9yaWdpbmFsU2VsZWN0T3B0aW9ucy5mb3JFYWNoKG9wdCA9PiAob3B0LnNlbGVjdGVkID0gb3B0LnZhbHVlID09PSBvcHRpb24uZGF0YXNldC52YWx1ZSkpO1xyXG5cdGhhbmRsZVNlbGVjdGlvbigpO1xyXG5cdGNsb3NlQ3VzdG9tU2VsZWN0KCk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGhhbmRsZVNlbGVjdGlvbigpOiB2b2lkIHtcclxuXHRjb25zdCBzZWxlY3RlZFZhbHVlOiBzdHJpbmcgPSBvcmlnaW5hbFNlbGVjdE9wdGlvbnMuZmlsdGVyKG9wdCA9PiBvcHQuc2VsZWN0ZWQpWzBdLnZhbHVlO1xyXG5cdGN1c3RvbVNlbGVjdEZvY3VzVGV4dC5pbm5lclRleHQgPSBzZWxlY3RlZFZhbHVlLnRvVXBwZXJDYXNlKCk7XHJcblx0Y3VzdG9tU2VsZWN0T3B0aW9ucy5mb3JFYWNoKG9wdGlvbiA9PiB7XHJcblx0XHRvcHRpb24uZGF0YXNldC5zZWxlY3RlZCA9IChvcHRpb24uZGF0YXNldC52YWx1ZSA9PT0gc2VsZWN0ZWRWYWx1ZSkudG9TdHJpbmcoKTtcclxuXHR9KTtcclxufVxyXG5cclxuZnVuY3Rpb24gb3BlbkN1c3RvbVNlbGVjdCgpOiB2b2lkIHtcclxuXHRjdXN0b21TZWxlY3QuZGF0YXNldC5vcGVuID0gJ3RydWUnO1xyXG59XHJcblxyXG5mdW5jdGlvbiBjbG9zZUN1c3RvbVNlbGVjdCgpOiB2b2lkIHtcclxuXHRjdXN0b21TZWxlY3QuZGF0YXNldC5vcGVuID0gJ2ZhbHNlJztcclxufVxyXG5cclxuLyogLS0tIGZvciBzcGluYnV0dG9uICovXHJcbmZ1bmN0aW9uIGhhbmRsZVNwaW5CdXR0b24oZTogS2V5Ym9hcmRFdmVudCk6IHZvaWQge1xyXG5cdHN3aXRjaCAoZS5rZXkpIHtcclxuXHRcdGNhc2UgJ0Fycm93VXAnOlxyXG5cdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XHJcblx0XHRcdGluY3JlYXNlUGVvcGxlKCk7XHJcblx0XHRcdGJyZWFrO1xyXG5cdFx0Y2FzZSAnQXJyb3dEb3duJzpcclxuXHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cdFx0XHRkZWNyZWFzZVBlb3BsZSgpO1xyXG5cdFx0XHRicmVhaztcclxuXHRcdGNhc2UgJ0hvbWUnOlxyXG5cdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XHJcblx0XHRcdHNldE1pblBlb3BsZSgpO1xyXG5cdFx0XHRicmVhaztcclxuXHRcdGNhc2UgJ0VuZCc6XHJcblx0XHRcdGUucHJldmVudERlZmF1bHQoKTtcclxuXHRcdFx0c2V0TWF4UGVvcGxlKCk7XHJcblx0XHRcdGJyZWFrO1xyXG5cdH1cclxufVxyXG5cclxuZnVuY3Rpb24gaW5jcmVhc2VQZW9wbGUoKTogdm9pZCB7XHJcblx0Y29uc3QgY3VycmVudFZhbHVlOiBudW1iZXIgPSBOdW1iZXIoc3BpbkJ1dHRvbi5nZXRBdHRyaWJ1dGUoJ2FyaWEtdmFsdWVub3cnKSk7XHJcblx0Y29uc3QgbWF4VmFsdWU6IG51bWJlciA9IE51bWJlcihzcGluQnV0dG9uLmdldEF0dHJpYnV0ZSgnYXJpYS12YWx1ZW1heCcpKTtcclxuXHRjb25zdCBuZXdWYWx1ZTogbnVtYmVyID0gTWF0aC5taW4oY3VycmVudFZhbHVlICsgMSwgbWF4VmFsdWUpO1xyXG5cdHVwZGF0ZVNwaW5CdXR0b24obmV3VmFsdWUpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBkZWNyZWFzZVBlb3BsZSgpOiB2b2lkIHtcclxuXHRjb25zdCBjdXJyZW50VmFsdWU6IG51bWJlciA9IE51bWJlcihzcGluQnV0dG9uLmdldEF0dHJpYnV0ZSgnYXJpYS12YWx1ZW5vdycpKTtcclxuXHRjb25zdCBtaW5WYWx1ZTogbnVtYmVyID0gTnVtYmVyKHNwaW5CdXR0b24uZ2V0QXR0cmlidXRlKCdhcmlhLXZhbHVlbWluJykpO1xyXG5cdGNvbnN0IG5ld1ZhbHVlOiBudW1iZXIgPSBNYXRoLm1heChjdXJyZW50VmFsdWUgLSAxLCBtaW5WYWx1ZSk7XHJcblx0dXBkYXRlU3BpbkJ1dHRvbihuZXdWYWx1ZSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHNldE1heFBlb3BsZSgpOiB2b2lkIHtcclxuXHRjb25zdCBtYXhWYWx1ZTogbnVtYmVyID0gTnVtYmVyKHNwaW5CdXR0b24uZ2V0QXR0cmlidXRlKCdhcmlhLXZhbHVlbWF4JykpO1xyXG5cdHVwZGF0ZVNwaW5CdXR0b24obWF4VmFsdWUpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBzZXRNaW5QZW9wbGUoKTogdm9pZCB7XHJcblx0Y29uc3QgbWluVmFsdWU6IG51bWJlciA9IE51bWJlcihzcGluQnV0dG9uLmdldEF0dHJpYnV0ZSgnYXJpYS12YWx1ZW1pbicpKTtcclxuXHR1cGRhdGVTcGluQnV0dG9uKG1pblZhbHVlKTtcclxufVxyXG5cclxuZnVuY3Rpb24gdXBkYXRlU3BpbkJ1dHRvbihuZXdWYWx1ZTogbnVtYmVyKTogdm9pZCB7XHJcblx0c3BpbkJ1dHRvbi5zZXRBdHRyaWJ1dGUoJ2FyaWEtdmFsdWVub3cnLCBuZXdWYWx1ZS50b1N0cmluZygpKTtcclxuXHRzcGluQnV0dG9uLnNldEF0dHJpYnV0ZSgnYXJpYS12YWx1ZXRleHQnLCBgJHtuZXdWYWx1ZX0gcGVvcGxlYCk7XHJcblx0c3BpbkJ1dHRvbi5pbm5lclRleHQgPSBgJHtuZXdWYWx1ZX0gcGVvcGxlYDtcclxufVxyXG5cclxuLyogLS0tIGZvciBmb3JtIHZhbGlkYXRpb24gKi9cclxuLyogLS0tIC0tLSBuYW1lIHZhbGlkYXRpb24gKi9cclxuZnVuY3Rpb24gdmFsaWRhdGVOYW1lKCk6IGJvb2xlYW4ge1xyXG5cdGNvbnN0IG5hbWVWYWx1ZTogc3RyaW5nID0gbmFtZUlucHV0LnZhbHVlO1xyXG5cclxuXHRpZiAoaXNCbGFuayhuYW1lVmFsdWUpKSByZXR1cm4gZGlzcGxheUZvcm1FcnJvcihuYW1lSW5wdXQsICdUaGlzIGZpZWxkIGlzIHJlcXVpcmVkJyk7XHJcblxyXG5cdHJldHVybiByZW1vdmVGb3JtRXJyb3IobmFtZUlucHV0KTtcclxufVxyXG5cclxuLyogLS0tIC0tLSBlbWFpbCB2YWxpZGF0aW9uICovXHJcbmZ1bmN0aW9uIHZhbGlkYXRlRW1haWwoKTogYm9vbGVhbiB7XHJcblx0Y29uc3QgZW1haWxWYWx1ZTogc3RyaW5nID0gZW1haWxJbnB1dC52YWx1ZTtcclxuXHJcblx0aWYgKGlzQmxhbmsoZW1haWxWYWx1ZSkpIHJldHVybiBkaXNwbGF5Rm9ybUVycm9yKGVtYWlsSW5wdXQsICdUaGlzIGZpZWxkIGlzIHJlcXVpcmVkJyk7XHJcblx0aWYgKCFpc1ZhbGlkRW1haWwoZW1haWxWYWx1ZSkpIHJldHVybiBkaXNwbGF5Rm9ybUVycm9yKGVtYWlsSW5wdXQsICdQcm92aWRlIGEgdmFsaWQgZW1haWwgYWRkcmVzcycpO1xyXG5cclxuXHRyZXR1cm4gcmVtb3ZlRm9ybUVycm9yKGVtYWlsSW5wdXQpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBpc1ZhbGlkRW1haWwoZW1haWw6IHN0cmluZyk6IGJvb2xlYW4ge1xyXG5cdHJldHVybiBFTUFJTF9SRUdFWC50ZXN0KGVtYWlsKTtcclxufVxyXG5cclxuLyogLS0tIC0tLSBkYXRlIHZhbGlkYXRpb24gKi9cclxuZnVuY3Rpb24gdmFsaWRhdGVEYXRlKCk6IGJvb2xlYW4ge1xyXG5cdGlmICh2YWxpZGF0ZURheSgpICYmIHZhbGlkYXRlTW9udGgoKSAmJiB2YWxpZGF0ZVllYXIoKSkge1xyXG5cdFx0Y29uc3QgZGF5OiBudW1iZXIgPSBOdW1iZXIoZGF5SW5wdXQudmFsdWUpO1xyXG5cdFx0Y29uc3QgbW9udGg6IG51bWJlciA9IE51bWJlcihtb250aElucHV0LnZhbHVlKTtcclxuXHRcdGNvbnN0IHllYXI6IG51bWJlciA9IE51bWJlcih5ZWFySW5wdXQudmFsdWUpO1xyXG5cclxuXHRcdGlmICghaXNEYXRlQWZ0ZXJUb2RheSh5ZWFyLCBtb250aCwgZGF5KSkgcmV0dXJuIGRpc3BsYXlGb3JtRXJyb3IoeWVhcklucHV0LCAnSW5zZXJ0IGRhdGUgYWZ0ZXIgdG9kYXknKTtcclxuXHJcblx0XHRyZXR1cm4gcmVtb3ZlRm9ybUVycm9yKHllYXJJbnB1dCk7XHJcblx0fVxyXG5cclxuXHRyZXR1cm4gZmFsc2U7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHZhbGlkYXRlRGF5KCk6IGJvb2xlYW4ge1xyXG5cdGNvbnN0IGRheVZhbHVlOiBzdHJpbmcgPSBkYXlJbnB1dC52YWx1ZTtcclxuXHJcblx0aWYgKGlzQmxhbmsoZGF5VmFsdWUpKSByZXR1cm4gZGlzcGxheUZvcm1FcnJvcihkYXlJbnB1dCwgJ1RoaXMgZmllbGQgaXMgaW5jb21wbGV0ZScpO1xyXG5cdGlmICghaXNWYWxpZERheShkYXlWYWx1ZSkpIHJldHVybiBkaXNwbGF5Rm9ybUVycm9yKGRheUlucHV0LCAnSW5zZXJ0IHZhbGlkIGRheSB2YWx1ZSAoMDEgLSAzMSknKTtcclxuXHRpZiAoIWlzRGF5V2l0aGluTW9udGhSYW5nZShkYXlWYWx1ZSkpIHJldHVybiBkaXNwbGF5Rm9ybUVycm9yKGRheUlucHV0LCAnSW5zZXJ0IGRheSBpbiByYW5nZSBvZiBzZWxlY3RlZCBtb250aC4nKTtcclxuXHJcblx0cmV0dXJuIHJlbW92ZUZvcm1FcnJvcihkYXlJbnB1dCk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGlzRGF0ZUFmdGVyVG9kYXkoeWVhcjogbnVtYmVyLCBtb250aDogbnVtYmVyLCBkYXk6IG51bWJlcik6IGJvb2xlYW4ge1xyXG5cdHJldHVybiBuZXcgRGF0ZSh5ZWFyLCBtb250aCAtIDEsIGRheSkgPiBuZXcgRGF0ZSgpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBpc0RheVdpdGhpbk1vbnRoUmFuZ2UoZGF5OiBzdHJpbmcpOiBib29sZWFuIHtcclxuXHRjb25zdCBtb250aDogc3RyaW5nID0gbW9udGhJbnB1dC52YWx1ZTtcclxuXHRjb25zdCB5ZWFyOiBzdHJpbmcgPSB5ZWFySW5wdXQudmFsdWU7XHJcblxyXG5cdGlmICgheWVhciB8fCAhbW9udGgpIHJldHVybiB0cnVlO1xyXG5cdGNvbnN0IG1vbnRoRGF5czogbnVtYmVyID0gbmV3IERhdGUoTnVtYmVyKHllYXIpLCBOdW1iZXIobW9udGgpLCAwKS5nZXREYXRlKCkgfHwgTUFYX0RBWVNfSU5fTU9OVEg7XHJcblx0cmV0dXJuIE51bWJlcihkYXkpIDw9IG1vbnRoRGF5cztcclxufVxyXG5cclxuZnVuY3Rpb24gdmFsaWRhdGVNb250aCgpOiBib29sZWFuIHtcclxuXHRjb25zdCBtb250aFZhbHVlOiBzdHJpbmcgPSBtb250aElucHV0LnZhbHVlO1xyXG5cclxuXHRpZiAoaXNCbGFuayhtb250aFZhbHVlKSkgcmV0dXJuIGRpc3BsYXlGb3JtRXJyb3IobW9udGhJbnB1dCwgJ1RoaXMgZmllbGQgaXMgaW5jb21wbGV0ZScpO1xyXG5cdGlmICghaXNWYWxpZE1vbnRoKG1vbnRoVmFsdWUpKSByZXR1cm4gZGlzcGxheUZvcm1FcnJvcihtb250aElucHV0LCAnSW5zZXJ0IHZhbGlkIG1vbnRoIHZhbHVlICgwMSAtIDEyKScpO1xyXG5cclxuXHRyZXR1cm4gcmVtb3ZlRm9ybUVycm9yKG1vbnRoSW5wdXQpO1xyXG59XHJcblxyXG5mdW5jdGlvbiB2YWxpZGF0ZVllYXIoKTogYm9vbGVhbiB7XHJcblx0Y29uc3QgeWVhclZhbHVlOiBzdHJpbmcgPSB5ZWFySW5wdXQudmFsdWU7XHJcblxyXG5cdGlmIChpc0JsYW5rKHllYXJWYWx1ZSkpIHJldHVybiBkaXNwbGF5Rm9ybUVycm9yKHllYXJJbnB1dCwgJ1RoaXMgZmllbGQgaXMgaW5jb21wbGV0ZScpO1xyXG5cdGlmICghaXNWYWxpZFllYXIoeWVhclZhbHVlKSkgcmV0dXJuIGRpc3BsYXlGb3JtRXJyb3IoeWVhcklucHV0LCAnSW5zZXJ0IHZhbGlkIHllYXIgKDQgZGlnaXQgbnVtYmVyKScpO1xyXG5cclxuXHRyZXR1cm4gcmVtb3ZlRm9ybUVycm9yKHllYXJJbnB1dCk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGlzVmFsaWREYXkoZGF5OiBzdHJpbmcpOiBib29sZWFuIHtcclxuXHRyZXR1cm4gREFZX1JFR0VYLnRlc3QoZGF5KTtcclxufVxyXG5cclxuZnVuY3Rpb24gaXNWYWxpZE1vbnRoKG1vbnRoOiBzdHJpbmcpOiBib29sZWFuIHtcclxuXHRyZXR1cm4gTU9OVEhfUkVHRVgudGVzdChtb250aCk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGlzVmFsaWRZZWFyKHllYXI6IHN0cmluZyk6IGJvb2xlYW4ge1xyXG5cdHJldHVybiBZRUFSX1JFR0VYLnRlc3QoeWVhcik7XHJcbn1cclxuXHJcbi8qIC0tLSAtLS0gdGltZSB2YWxpZGF0aW9uICovXHJcbmZ1bmN0aW9uIHZhbGlkYXRlVGltZSgpOiBib29sZWFuIHtcclxuXHRpZiAodmFsaWRhdGVIb3VyKCkgJiYgdmFsaWRhdGVNaW51dGVzKCkpIHtcclxuXHRcdGlmICghaXNUaW1lQmV0d2Vlbk9wZW5Ib3VycygpKSByZXR1cm4gZGlzcGxheUZvcm1FcnJvcihob3VySW5wdXQsICdJbnNlcnQgdGltZSBiZXR3ZWVuIG9wZW4gaG91cnMnKTtcclxuXHJcblx0XHRyZXR1cm4gcmVtb3ZlRm9ybUVycm9yKGhvdXJJbnB1dCk7XHJcblx0fVxyXG5cclxuXHRyZXR1cm4gZmFsc2U7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGlzVGltZUJldHdlZW5PcGVuSG91cnMoKTogYm9vbGVhbiB7XHJcblx0Y29uc3QgaG91cjogbnVtYmVyID0gTnVtYmVyKGhvdXJJbnB1dC52YWx1ZSk7XHJcblx0Y29uc3QgbWludXRlczogbnVtYmVyID0gTnVtYmVyKG1pbnV0ZXNJbnB1dC52YWx1ZSk7XHJcblx0Y29uc3QgZGF0ZTogRGF0ZSA9IG5ldyBEYXRlKE51bWJlcih5ZWFySW5wdXQudmFsdWUpLCBOdW1iZXIobW9udGhJbnB1dC52YWx1ZSkgLSAxLCBOdW1iZXIoZGF5SW5wdXQudmFsdWUpKTtcclxuXHRjb25zdCB3ZWVrRGF5OiBudW1iZXIgPSBkYXRlLmdldERheSgpO1xyXG5cdGNvbnN0IGRheVRpbWU6IHN0cmluZyA9IG9yaWdpbmFsU2VsZWN0LnZhbHVlO1xyXG5cclxuXHRpZiAoTnVtYmVyLmlzTmFOKGhvdXIpIHx8IE51bWJlci5pc05hTihtaW51dGVzKSkgcmV0dXJuIGZhbHNlO1xyXG5cdGlmIChOdW1iZXIuaXNOYU4od2Vla0RheSkpIHJldHVybiBmYWxzZTtcclxuXHJcblx0aWYgKGRheVRpbWUgPT09ICdhbScpIHJldHVybiBpc0JldHdlZW5Nb3JuaW5nSG91cnMoaG91cik7XHJcblx0ZWxzZSByZXR1cm4gaXNCZXR3ZWVuQWZ0ZXJub29uSG91cnMoaG91ciwgbWludXRlcywgd2Vla0RheSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGlzQmV0d2Vlbk1vcm5pbmdIb3Vycyhob3VyOiBudW1iZXIpOiBib29sZWFuIHtcclxuXHRyZXR1cm4gaG91ciA+PSA5ICYmIGhvdXIgPCAxMjtcclxufVxyXG5cclxuZnVuY3Rpb24gaXNCZXR3ZWVuQWZ0ZXJub29uSG91cnMoaG91cjogbnVtYmVyLCBtaW51dGVzOiBudW1iZXIsIHdlZWtEYXlDb2RlOiBudW1iZXIpOiBib29sZWFuIHtcclxuXHRpZiAod2Vla0RheUNvZGUgPD0gRlJJREFZX0NPREUgJiYgd2Vla0RheUNvZGUgPj0gTU9OREFZX0NPREUpIHtcclxuXHRcdHJldHVybiBob3VyID09PSAxMiB8fCBob3VyIDwgMTA7XHJcblx0fVxyXG5cdGlmICh3ZWVrRGF5Q29kZSA9PT0gU0FUVVJEQVlfQ09ERSB8fCB3ZWVrRGF5Q29kZSA9PT0gU1VOREFZX0NPREUpIHtcclxuXHRcdHJldHVybiBob3VyID09PSAxMiB8fCBob3VyIDwgMTEgfHwgKGhvdXIgPT09IDExICYmIG1pbnV0ZXMgPCAzMCk7XHJcblx0fVxyXG5cclxuXHRyZXR1cm4gdHJ1ZTtcclxufVxyXG5cclxuZnVuY3Rpb24gdmFsaWRhdGVIb3VyKCk6IGJvb2xlYW4ge1xyXG5cdGNvbnN0IGhvdXJWYWx1ZTogc3RyaW5nID0gaG91cklucHV0LnZhbHVlO1xyXG5cclxuXHRpZiAoaXNCbGFuayhob3VyVmFsdWUpKSByZXR1cm4gZGlzcGxheUZvcm1FcnJvcihob3VySW5wdXQsICdUaGlzIGZpZWxkIGlzIGluY29tcGxldGUnKTtcclxuXHRpZiAoIWlzVmFsaWRIb3VyKGhvdXJWYWx1ZSkpIHJldHVybiBkaXNwbGF5Rm9ybUVycm9yKGhvdXJJbnB1dCwgJ0luc2VydCB2YWxpZCBob3VyIGZvcm1hdCAoMDEgLSAxMiknKTtcclxuXHJcblx0cmV0dXJuIHJlbW92ZUZvcm1FcnJvcihob3VySW5wdXQpO1xyXG59XHJcblxyXG5mdW5jdGlvbiB2YWxpZGF0ZU1pbnV0ZXMoKTogYm9vbGVhbiB7XHJcblx0Y29uc3QgbWludXRlc1ZhbHVlOiBzdHJpbmcgPSBtaW51dGVzSW5wdXQudmFsdWU7XHJcblxyXG5cdGlmIChpc0JsYW5rKG1pbnV0ZXNWYWx1ZSkpIHJldHVybiBkaXNwbGF5Rm9ybUVycm9yKG1pbnV0ZXNJbnB1dCwgJ1RoaXMgZmllbGQgaXMgaW5jb21wbGV0ZScpO1xyXG5cdGlmICghYXJlVmFsaWRNaW51dGVzKG1pbnV0ZXNWYWx1ZSkpIHJldHVybiBkaXNwbGF5Rm9ybUVycm9yKG1pbnV0ZXNJbnB1dCwgJ0luc2VydCB2YWxpZCBtaW51dGVzIGZvcm1hdCAoMDAgLSA1OSknKTtcclxuXHJcblx0cmV0dXJuIHJlbW92ZUZvcm1FcnJvcihtaW51dGVzSW5wdXQpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBpc1ZhbGlkSG91cihob3VyOiBzdHJpbmcpOiBib29sZWFuIHtcclxuXHRyZXR1cm4gSE9VUl9SRUdFWC50ZXN0KGhvdXIpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBhcmVWYWxpZE1pbnV0ZXMobWludXRlczogc3RyaW5nKTogYm9vbGVhbiB7XHJcblx0cmV0dXJuIE1JTlVURVNfUkVHRVgudGVzdChtaW51dGVzKTtcclxufVxyXG5cclxuLyogLS0tIC0tLSBnZW5lcmFsIGZvcm0gdmFsaWRhdGlvbiAqL1xyXG5mdW5jdGlvbiBpc0JsYW5rKHZhbHVlOiBzdHJpbmcpOiBib29sZWFuIHtcclxuXHRyZXR1cm4gdmFsdWUgPT09ICcnO1xyXG59XHJcbi8qIC0tLSAtLS0gZm9ybSBlcnJvciBkaXNwbGF5aW5nICovXHJcbmZ1bmN0aW9uIGRpc3BsYXlGb3JtRXJyb3IoaW5wdXQ6IEhUTUxJbnB1dEVsZW1lbnQsIG1lc3NhZ2U6IHN0cmluZyk6IGJvb2xlYW4ge1xyXG5cdGxldCBmb3JtR3JvdXA6IEhUTUxFbGVtZW50ID0gaW5wdXQuY2xvc2VzdCgnLmZvcm0tZ3JvdXAnKTtcclxuXHRsZXQgZm9ybUVycm9yOiBIVE1MRWxlbWVudDtcclxuXHJcblx0d2hpbGUgKGZvcm1Hcm91cCkge1xyXG5cdFx0Zm9ybUdyb3VwLmNsYXNzTGlzdC5hZGQoJ2Vycm9yJyk7XHJcblx0XHRmb3JtRXJyb3IgPSBmb3JtR3JvdXAucXVlcnlTZWxlY3RvcignLmZvcm0tZXJyb3InKTtcclxuXHJcblx0XHRpZiAoZm9ybUVycm9yKSB7XHJcblx0XHRcdGZvcm1FcnJvci5pbm5lclRleHQgPSBtZXNzYWdlO1xyXG5cdFx0XHRicmVhaztcclxuXHRcdH1cclxuXHJcblx0XHRmb3JtR3JvdXAgPSBmb3JtR3JvdXAucGFyZW50RWxlbWVudC5jbG9zZXN0KCcuZm9ybS1ncm91cCcpO1xyXG5cdH1cclxuXHJcblx0cmV0dXJuIGZhbHNlO1xyXG59XHJcblxyXG5mdW5jdGlvbiByZW1vdmVGb3JtRXJyb3IoaW5wdXQ6IEhUTUxJbnB1dEVsZW1lbnQpOiBib29sZWFuIHtcclxuXHRsZXQgZm9ybUdyb3VwOiBIVE1MRWxlbWVudCA9IGlucHV0LmNsb3Nlc3QoJy5mb3JtLWdyb3VwJyk7XHJcblx0bGV0IGZvcm1FcnJvcjogSFRNTEVsZW1lbnQ7XHJcblxyXG5cdHdoaWxlIChmb3JtR3JvdXApIHtcclxuXHRcdGZvcm1Hcm91cC5jbGFzc0xpc3QucmVtb3ZlKCdlcnJvcicpO1xyXG5cdFx0Zm9ybUVycm9yID0gZm9ybUdyb3VwLnF1ZXJ5U2VsZWN0b3IoJy5mb3JtLWVycm9yJyk7XHJcblxyXG5cdFx0aWYgKGZvcm1FcnJvcikgZm9ybUVycm9yLmlubmVyVGV4dCA9ICcnO1xyXG5cclxuXHRcdGZvcm1Hcm91cCA9IGZvcm1Hcm91cC5wYXJlbnRFbGVtZW50LmNsb3Nlc3QoJy5mb3JtLWdyb3VwJyk7XHJcblx0fVxyXG5cclxuXHRyZXR1cm4gdHJ1ZTtcclxufVxyXG4iLCJjb25zdCBjdXN0b21TZWxlY3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY3VzdG9tLXNlbGVjdCcpO1xuY29uc3Qgb3JpZ2luYWxTZWxlY3QgPSBjdXN0b21TZWxlY3QucXVlcnlTZWxlY3Rvcignc2VsZWN0Jyk7XG5jb25zdCBvcmlnaW5hbFNlbGVjdE9wdGlvbnMgPSBBcnJheS5mcm9tKG9yaWdpbmFsU2VsZWN0LnF1ZXJ5U2VsZWN0b3JBbGwoJ29wdGlvbicpKTtcbmNvbnN0IGN1c3RvbVNlbGVjdEZvY3VzID0gY3VzdG9tU2VsZWN0LnF1ZXJ5U2VsZWN0b3IoJy5jdXN0b20tc2VsZWN0X19mb2N1cycpO1xuY29uc3QgY3VzdG9tU2VsZWN0Rm9jdXNUZXh0ID0gY3VzdG9tU2VsZWN0Rm9jdXMucXVlcnlTZWxlY3Rvcignc3BhbicpO1xuY29uc3QgY3VzdG9tU2VsZWN0T3B0aW9uc0NvbnRhaW5lciA9IGN1c3RvbVNlbGVjdC5xdWVyeVNlbGVjdG9yKCcuY3VzdG9tLXNlbGVjdF9fb3B0aW9ucycpO1xubGV0IGN1c3RvbVNlbGVjdE9wdGlvbnMgPSBbXTtcbmNvbnN0IGN1c3RvbVNwaW5idXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuc3BpbmJ1dHRvbicpO1xuY29uc3Qgc3BpbkJ1dHRvbiA9IGN1c3RvbVNwaW5idXR0b24ucXVlcnlTZWxlY3RvcignW3JvbGU9XCJzcGluYnV0dG9uXCJdJyk7XG5jb25zdCBkZWNyZWFzZVNwaW5idXR0b24gPSBjdXN0b21TcGluYnV0dG9uLnF1ZXJ5U2VsZWN0b3IoJyNkZWNyZWFzZS1wZW9wbGUnKTtcbmNvbnN0IGluY3JlYXNlU3BpbmJ1dHRvbiA9IGN1c3RvbVNwaW5idXR0b24ucXVlcnlTZWxlY3RvcignI2luY3JlYXNlLXBlb3BsZScpO1xuY29uc3QgcmVzZXJ2YXRpb25Gb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnJlc2VydmF0aW9uLWZvcm0nKTtcbmNvbnN0IG5hbWVJbnB1dCA9IHJlc2VydmF0aW9uRm9ybS5xdWVyeVNlbGVjdG9yKCdpbnB1dFtuYW1lPVwibmFtZVwiXScpO1xuY29uc3QgZW1haWxJbnB1dCA9IHJlc2VydmF0aW9uRm9ybS5xdWVyeVNlbGVjdG9yKCdpbnB1dFtuYW1lPVwiZW1haWxcIl0nKTtcbmNvbnN0IG1vbnRoSW5wdXQgPSByZXNlcnZhdGlvbkZvcm0ucXVlcnlTZWxlY3RvcignaW5wdXRbbmFtZT1cIm1vbnRoXCJdJyk7XG5jb25zdCBkYXlJbnB1dCA9IHJlc2VydmF0aW9uRm9ybS5xdWVyeVNlbGVjdG9yKCdpbnB1dFtuYW1lPVwiZGF5XCJdJyk7XG5jb25zdCB5ZWFySW5wdXQgPSByZXNlcnZhdGlvbkZvcm0ucXVlcnlTZWxlY3RvcignaW5wdXRbbmFtZT1cInllYXJcIl0nKTtcbmNvbnN0IGhvdXJJbnB1dCA9IHJlc2VydmF0aW9uRm9ybS5xdWVyeVNlbGVjdG9yKCdpbnB1dFtuYW1lPVwiaG91clwiXScpO1xuY29uc3QgbWludXRlc0lucHV0ID0gcmVzZXJ2YXRpb25Gb3JtLnF1ZXJ5U2VsZWN0b3IoJ2lucHV0W25hbWU9XCJtaW51dGVcIl0nKTtcbmNvbnN0IHJlc2VydmF0aW9uU3VibWl0QnRuID0gcmVzZXJ2YXRpb25Gb3JtLnF1ZXJ5U2VsZWN0b3IoJ2J1dHRvblt0eXBlPVwic3VibWl0XCJdJyk7XG5jb25zdCBDSEVDS19JQ09OX1VSTCA9ICcuL2Rpc3QvYXNzZXRzL2ltYWdlcy9pY29ucy9pY29uLWNoZWNrLnN2Zyc7XG5jb25zdCBFTUFJTF9SRUdFWCA9IC9eKChbXjw+KClbXFxdXFxcXC4sOzpcXHNAXCJdKyhcXC5bXjw+KClbXFxdXFxcXC4sOzpcXHNAXCJdKykqKXwoXCIuK1wiKSlAKChcXFtbMC05XXsxLDN9XFwuWzAtOV17MSwzfVxcLlswLTldezEsM31cXC5bMC05XXsxLDN9XFxdKXwoKFthLXpBLVpcXC0wLTldK1xcLikrW2EtekEtWl17Mix9KSkkLztcbmNvbnN0IERBWV9SRUdFWCA9IC9eKDBbMS05XSl8KFsxLTJdXFxkKXwoM1swLTFdKSQvO1xuY29uc3QgTUFYX0RBWVNfSU5fTU9OVEggPSAzMTtcbmNvbnN0IE1PTlRIX1JFR0VYID0gL14oMFsxLTldKXwoMVswLTJdKSQvO1xuY29uc3QgWUVBUl9SRUdFWCA9IC9eXFxkezR9JC87XG5jb25zdCBIT1VSX1JFR0VYID0gL14oMFsxLTldKXwoMVswLTJdKSQvO1xuY29uc3QgTUlOVVRFU19SRUdFWCA9IC9eKFswLTVdXFxkKSQvO1xuY29uc3QgTU9OREFZX0NPREUgPSAxO1xuY29uc3QgRlJJREFZX0NPREUgPSA1O1xuY29uc3QgU0FUVVJEQVlfQ09ERSA9IDY7XG5jb25zdCBTVU5EQVlfQ09ERSA9IDA7XG5jcmVhdGVDdXN0b21TZWxlY3RPcHRpb25zKCk7XG5vcmlnaW5hbFNlbGVjdC5hZGRFdmVudExpc3RlbmVyKCdrZXl1cCcsIChlKSA9PiB7XG4gICAgc3dpdGNoIChlLmtleSkge1xuICAgICAgICBjYXNlICdBcnJvd1VwJzpcbiAgICAgICAgY2FzZSAnQXJyb3dEb3duJzpcbiAgICAgICAgY2FzZSAnQXJyb3dMZWZ0JzpcbiAgICAgICAgY2FzZSAnQXJyb3dSaWdodCc6XG4gICAgICAgICAgICBoYW5kbGVTZWxlY3Rpb24oKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICdFbnRlcic6XG4gICAgICAgICAgICBoYW5kbGVTZWxlY3Rpb24oKTtcbiAgICAgICAgICAgIGNsb3NlQ3VzdG9tU2VsZWN0KCk7XG4gICAgICAgICAgICBicmVhaztcbiAgICB9XG59KTtcbmN1c3RvbVNlbGVjdEZvY3VzLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHtcbiAgICBvcmlnaW5hbFNlbGVjdC5mb2N1cygpO1xufSk7XG5vcmlnaW5hbFNlbGVjdC5hZGRFdmVudExpc3RlbmVyKCdmb2N1c2luJywgb3BlbkN1c3RvbVNlbGVjdCk7XG5zcGluQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCBoYW5kbGVTcGluQnV0dG9uKTtcbmluY3JlYXNlU3BpbmJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGluY3JlYXNlUGVvcGxlKTtcbmRlY3JlYXNlU3BpbmJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGRlY3JlYXNlUGVvcGxlKTtcbnJlc2VydmF0aW9uU3VibWl0QnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHtcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgY29uc3QgaXNOYW1lVmFsaWQgPSB2YWxpZGF0ZU5hbWUoKTtcbiAgICBjb25zdCBpc0VtYWlsVmFsaWQgPSB2YWxpZGF0ZUVtYWlsKCk7XG4gICAgY29uc3QgaXNEYXRlVmFsaWQgPSB2YWxpZGF0ZURhdGUoKTtcbiAgICBjb25zdCBpc1RpbWVWYWxpZCA9IHZhbGlkYXRlVGltZSgpO1xuICAgIGlmIChpc05hbWVWYWxpZCAmJiBpc0VtYWlsVmFsaWQgJiYgaXNEYXRlVmFsaWQgJiYgaXNUaW1lVmFsaWQpIHtcbiAgICAgICAgcmVzZXJ2YXRpb25Gb3JtLnNldEF0dHJpYnV0ZSgnZGF0YS12YWxpZCcsICd0cnVlJyk7XG4gICAgfVxufSk7XG5mdW5jdGlvbiBjcmVhdGVDdXN0b21TZWxlY3RPcHRpb25zKCkge1xuICAgIG9yaWdpbmFsU2VsZWN0T3B0aW9ucy5mb3JFYWNoKG9wdGlvbiA9PiB7XG4gICAgICAgIGNvbnN0IGN1c3RvbU9wdGlvbiA9IGNyZWF0ZUN1c3RvbU9wdGlvbihvcHRpb24pO1xuICAgICAgICBjdXN0b21TZWxlY3RPcHRpb25zLnB1c2goY3VzdG9tT3B0aW9uKTtcbiAgICAgICAgY3VzdG9tU2VsZWN0T3B0aW9uc0NvbnRhaW5lci5hcHBlbmRDaGlsZChjdXN0b21PcHRpb24pO1xuICAgIH0pO1xufVxuZnVuY3Rpb24gY3JlYXRlQ3VzdG9tT3B0aW9uKG9wdGlvbikge1xuICAgIGNvbnN0IG9wdGlvbldyYXBwZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7XG4gICAgb3B0aW9uV3JhcHBlci5jbGFzc0xpc3QuYWRkKCdjdXN0b20tc2VsZWN0X19vcHRpb24nKTtcbiAgICBvcHRpb25XcmFwcGVyLnNldEF0dHJpYnV0ZSgnZGF0YS1zZWxlY3RlZCcsIG9wdGlvbi5zZWxlY3RlZC50b1N0cmluZygpKTtcbiAgICBvcHRpb25XcmFwcGVyLnNldEF0dHJpYnV0ZSgnZGF0YS12YWx1ZScsIG9wdGlvbi52YWx1ZSk7XG4gICAgb3B0aW9uV3JhcHBlci5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGhhbmRsZUN1c3RvbU9wdGlvbik7XG4gICAgY29uc3QgY2hlY2tJbWFnZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2ltZycpO1xuICAgIGNoZWNrSW1hZ2Uuc2V0QXR0cmlidXRlKCdzcmMnLCBDSEVDS19JQ09OX1VSTCk7XG4gICAgY2hlY2tJbWFnZS5zZXRBdHRyaWJ1dGUoJ2FsdCcsICcnKTtcbiAgICBjb25zdCBvcHRpb25UZXh0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpO1xuICAgIG9wdGlvblRleHQuaW5uZXJUZXh0ID0gb3B0aW9uLmlubmVyVGV4dDtcbiAgICBvcHRpb25XcmFwcGVyLmFwcGVuZENoaWxkKGNoZWNrSW1hZ2UpO1xuICAgIG9wdGlvbldyYXBwZXIuYXBwZW5kQ2hpbGQob3B0aW9uVGV4dCk7XG4gICAgcmV0dXJuIG9wdGlvbldyYXBwZXI7XG59XG5mdW5jdGlvbiBoYW5kbGVDdXN0b21PcHRpb24oZSkge1xuICAgIGNvbnN0IG9wdGlvbiA9IGUudGFyZ2V0O1xuICAgIG9yaWdpbmFsU2VsZWN0T3B0aW9ucy5mb3JFYWNoKG9wdCA9PiAob3B0LnNlbGVjdGVkID0gb3B0LnZhbHVlID09PSBvcHRpb24uZGF0YXNldC52YWx1ZSkpO1xuICAgIGhhbmRsZVNlbGVjdGlvbigpO1xuICAgIGNsb3NlQ3VzdG9tU2VsZWN0KCk7XG59XG5mdW5jdGlvbiBoYW5kbGVTZWxlY3Rpb24oKSB7XG4gICAgY29uc3Qgc2VsZWN0ZWRWYWx1ZSA9IG9yaWdpbmFsU2VsZWN0T3B0aW9ucy5maWx0ZXIob3B0ID0+IG9wdC5zZWxlY3RlZClbMF0udmFsdWU7XG4gICAgY3VzdG9tU2VsZWN0Rm9jdXNUZXh0LmlubmVyVGV4dCA9IHNlbGVjdGVkVmFsdWUudG9VcHBlckNhc2UoKTtcbiAgICBjdXN0b21TZWxlY3RPcHRpb25zLmZvckVhY2gob3B0aW9uID0+IHtcbiAgICAgICAgb3B0aW9uLmRhdGFzZXQuc2VsZWN0ZWQgPSAob3B0aW9uLmRhdGFzZXQudmFsdWUgPT09IHNlbGVjdGVkVmFsdWUpLnRvU3RyaW5nKCk7XG4gICAgfSk7XG59XG5mdW5jdGlvbiBvcGVuQ3VzdG9tU2VsZWN0KCkge1xuICAgIGN1c3RvbVNlbGVjdC5kYXRhc2V0Lm9wZW4gPSAndHJ1ZSc7XG59XG5mdW5jdGlvbiBjbG9zZUN1c3RvbVNlbGVjdCgpIHtcbiAgICBjdXN0b21TZWxlY3QuZGF0YXNldC5vcGVuID0gJ2ZhbHNlJztcbn1cbmZ1bmN0aW9uIGhhbmRsZVNwaW5CdXR0b24oZSkge1xuICAgIHN3aXRjaCAoZS5rZXkpIHtcbiAgICAgICAgY2FzZSAnQXJyb3dVcCc6XG4gICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICBpbmNyZWFzZVBlb3BsZSgpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgJ0Fycm93RG93bic6XG4gICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICBkZWNyZWFzZVBlb3BsZSgpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgJ0hvbWUnOlxuICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgc2V0TWluUGVvcGxlKCk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAnRW5kJzpcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIHNldE1heFBlb3BsZSgpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgfVxufVxuZnVuY3Rpb24gaW5jcmVhc2VQZW9wbGUoKSB7XG4gICAgY29uc3QgY3VycmVudFZhbHVlID0gTnVtYmVyKHNwaW5CdXR0b24uZ2V0QXR0cmlidXRlKCdhcmlhLXZhbHVlbm93JykpO1xuICAgIGNvbnN0IG1heFZhbHVlID0gTnVtYmVyKHNwaW5CdXR0b24uZ2V0QXR0cmlidXRlKCdhcmlhLXZhbHVlbWF4JykpO1xuICAgIGNvbnN0IG5ld1ZhbHVlID0gTWF0aC5taW4oY3VycmVudFZhbHVlICsgMSwgbWF4VmFsdWUpO1xuICAgIHVwZGF0ZVNwaW5CdXR0b24obmV3VmFsdWUpO1xufVxuZnVuY3Rpb24gZGVjcmVhc2VQZW9wbGUoKSB7XG4gICAgY29uc3QgY3VycmVudFZhbHVlID0gTnVtYmVyKHNwaW5CdXR0b24uZ2V0QXR0cmlidXRlKCdhcmlhLXZhbHVlbm93JykpO1xuICAgIGNvbnN0IG1pblZhbHVlID0gTnVtYmVyKHNwaW5CdXR0b24uZ2V0QXR0cmlidXRlKCdhcmlhLXZhbHVlbWluJykpO1xuICAgIGNvbnN0IG5ld1ZhbHVlID0gTWF0aC5tYXgoY3VycmVudFZhbHVlIC0gMSwgbWluVmFsdWUpO1xuICAgIHVwZGF0ZVNwaW5CdXR0b24obmV3VmFsdWUpO1xufVxuZnVuY3Rpb24gc2V0TWF4UGVvcGxlKCkge1xuICAgIGNvbnN0IG1heFZhbHVlID0gTnVtYmVyKHNwaW5CdXR0b24uZ2V0QXR0cmlidXRlKCdhcmlhLXZhbHVlbWF4JykpO1xuICAgIHVwZGF0ZVNwaW5CdXR0b24obWF4VmFsdWUpO1xufVxuZnVuY3Rpb24gc2V0TWluUGVvcGxlKCkge1xuICAgIGNvbnN0IG1pblZhbHVlID0gTnVtYmVyKHNwaW5CdXR0b24uZ2V0QXR0cmlidXRlKCdhcmlhLXZhbHVlbWluJykpO1xuICAgIHVwZGF0ZVNwaW5CdXR0b24obWluVmFsdWUpO1xufVxuZnVuY3Rpb24gdXBkYXRlU3BpbkJ1dHRvbihuZXdWYWx1ZSkge1xuICAgIHNwaW5CdXR0b24uc2V0QXR0cmlidXRlKCdhcmlhLXZhbHVlbm93JywgbmV3VmFsdWUudG9TdHJpbmcoKSk7XG4gICAgc3BpbkJ1dHRvbi5zZXRBdHRyaWJ1dGUoJ2FyaWEtdmFsdWV0ZXh0JywgYCR7bmV3VmFsdWV9IHBlb3BsZWApO1xuICAgIHNwaW5CdXR0b24uaW5uZXJUZXh0ID0gYCR7bmV3VmFsdWV9IHBlb3BsZWA7XG59XG5mdW5jdGlvbiB2YWxpZGF0ZU5hbWUoKSB7XG4gICAgY29uc3QgbmFtZVZhbHVlID0gbmFtZUlucHV0LnZhbHVlO1xuICAgIGlmIChpc0JsYW5rKG5hbWVWYWx1ZSkpXG4gICAgICAgIHJldHVybiBkaXNwbGF5Rm9ybUVycm9yKG5hbWVJbnB1dCwgJ1RoaXMgZmllbGQgaXMgcmVxdWlyZWQnKTtcbiAgICByZXR1cm4gcmVtb3ZlRm9ybUVycm9yKG5hbWVJbnB1dCk7XG59XG5mdW5jdGlvbiB2YWxpZGF0ZUVtYWlsKCkge1xuICAgIGNvbnN0IGVtYWlsVmFsdWUgPSBlbWFpbElucHV0LnZhbHVlO1xuICAgIGlmIChpc0JsYW5rKGVtYWlsVmFsdWUpKVxuICAgICAgICByZXR1cm4gZGlzcGxheUZvcm1FcnJvcihlbWFpbElucHV0LCAnVGhpcyBmaWVsZCBpcyByZXF1aXJlZCcpO1xuICAgIGlmICghaXNWYWxpZEVtYWlsKGVtYWlsVmFsdWUpKVxuICAgICAgICByZXR1cm4gZGlzcGxheUZvcm1FcnJvcihlbWFpbElucHV0LCAnUHJvdmlkZSBhIHZhbGlkIGVtYWlsIGFkZHJlc3MnKTtcbiAgICByZXR1cm4gcmVtb3ZlRm9ybUVycm9yKGVtYWlsSW5wdXQpO1xufVxuZnVuY3Rpb24gaXNWYWxpZEVtYWlsKGVtYWlsKSB7XG4gICAgcmV0dXJuIEVNQUlMX1JFR0VYLnRlc3QoZW1haWwpO1xufVxuZnVuY3Rpb24gdmFsaWRhdGVEYXRlKCkge1xuICAgIGlmICh2YWxpZGF0ZURheSgpICYmIHZhbGlkYXRlTW9udGgoKSAmJiB2YWxpZGF0ZVllYXIoKSkge1xuICAgICAgICBjb25zdCBkYXkgPSBOdW1iZXIoZGF5SW5wdXQudmFsdWUpO1xuICAgICAgICBjb25zdCBtb250aCA9IE51bWJlcihtb250aElucHV0LnZhbHVlKTtcbiAgICAgICAgY29uc3QgeWVhciA9IE51bWJlcih5ZWFySW5wdXQudmFsdWUpO1xuICAgICAgICBpZiAoIWlzRGF0ZUFmdGVyVG9kYXkoeWVhciwgbW9udGgsIGRheSkpXG4gICAgICAgICAgICByZXR1cm4gZGlzcGxheUZvcm1FcnJvcih5ZWFySW5wdXQsICdJbnNlcnQgZGF0ZSBhZnRlciB0b2RheScpO1xuICAgICAgICByZXR1cm4gcmVtb3ZlRm9ybUVycm9yKHllYXJJbnB1dCk7XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcbn1cbmZ1bmN0aW9uIHZhbGlkYXRlRGF5KCkge1xuICAgIGNvbnN0IGRheVZhbHVlID0gZGF5SW5wdXQudmFsdWU7XG4gICAgaWYgKGlzQmxhbmsoZGF5VmFsdWUpKVxuICAgICAgICByZXR1cm4gZGlzcGxheUZvcm1FcnJvcihkYXlJbnB1dCwgJ1RoaXMgZmllbGQgaXMgaW5jb21wbGV0ZScpO1xuICAgIGlmICghaXNWYWxpZERheShkYXlWYWx1ZSkpXG4gICAgICAgIHJldHVybiBkaXNwbGF5Rm9ybUVycm9yKGRheUlucHV0LCAnSW5zZXJ0IHZhbGlkIGRheSB2YWx1ZSAoMDEgLSAzMSknKTtcbiAgICBpZiAoIWlzRGF5V2l0aGluTW9udGhSYW5nZShkYXlWYWx1ZSkpXG4gICAgICAgIHJldHVybiBkaXNwbGF5Rm9ybUVycm9yKGRheUlucHV0LCAnSW5zZXJ0IGRheSBpbiByYW5nZSBvZiBzZWxlY3RlZCBtb250aC4nKTtcbiAgICByZXR1cm4gcmVtb3ZlRm9ybUVycm9yKGRheUlucHV0KTtcbn1cbmZ1bmN0aW9uIGlzRGF0ZUFmdGVyVG9kYXkoeWVhciwgbW9udGgsIGRheSkge1xuICAgIHJldHVybiBuZXcgRGF0ZSh5ZWFyLCBtb250aCAtIDEsIGRheSkgPiBuZXcgRGF0ZSgpO1xufVxuZnVuY3Rpb24gaXNEYXlXaXRoaW5Nb250aFJhbmdlKGRheSkge1xuICAgIGNvbnN0IG1vbnRoID0gbW9udGhJbnB1dC52YWx1ZTtcbiAgICBjb25zdCB5ZWFyID0geWVhcklucHV0LnZhbHVlO1xuICAgIGlmICgheWVhciB8fCAhbW9udGgpXG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIGNvbnN0IG1vbnRoRGF5cyA9IG5ldyBEYXRlKE51bWJlcih5ZWFyKSwgTnVtYmVyKG1vbnRoKSwgMCkuZ2V0RGF0ZSgpIHx8IE1BWF9EQVlTX0lOX01PTlRIO1xuICAgIHJldHVybiBOdW1iZXIoZGF5KSA8PSBtb250aERheXM7XG59XG5mdW5jdGlvbiB2YWxpZGF0ZU1vbnRoKCkge1xuICAgIGNvbnN0IG1vbnRoVmFsdWUgPSBtb250aElucHV0LnZhbHVlO1xuICAgIGlmIChpc0JsYW5rKG1vbnRoVmFsdWUpKVxuICAgICAgICByZXR1cm4gZGlzcGxheUZvcm1FcnJvcihtb250aElucHV0LCAnVGhpcyBmaWVsZCBpcyBpbmNvbXBsZXRlJyk7XG4gICAgaWYgKCFpc1ZhbGlkTW9udGgobW9udGhWYWx1ZSkpXG4gICAgICAgIHJldHVybiBkaXNwbGF5Rm9ybUVycm9yKG1vbnRoSW5wdXQsICdJbnNlcnQgdmFsaWQgbW9udGggdmFsdWUgKDAxIC0gMTIpJyk7XG4gICAgcmV0dXJuIHJlbW92ZUZvcm1FcnJvcihtb250aElucHV0KTtcbn1cbmZ1bmN0aW9uIHZhbGlkYXRlWWVhcigpIHtcbiAgICBjb25zdCB5ZWFyVmFsdWUgPSB5ZWFySW5wdXQudmFsdWU7XG4gICAgaWYgKGlzQmxhbmsoeWVhclZhbHVlKSlcbiAgICAgICAgcmV0dXJuIGRpc3BsYXlGb3JtRXJyb3IoeWVhcklucHV0LCAnVGhpcyBmaWVsZCBpcyBpbmNvbXBsZXRlJyk7XG4gICAgaWYgKCFpc1ZhbGlkWWVhcih5ZWFyVmFsdWUpKVxuICAgICAgICByZXR1cm4gZGlzcGxheUZvcm1FcnJvcih5ZWFySW5wdXQsICdJbnNlcnQgdmFsaWQgeWVhciAoNCBkaWdpdCBudW1iZXIpJyk7XG4gICAgcmV0dXJuIHJlbW92ZUZvcm1FcnJvcih5ZWFySW5wdXQpO1xufVxuZnVuY3Rpb24gaXNWYWxpZERheShkYXkpIHtcbiAgICByZXR1cm4gREFZX1JFR0VYLnRlc3QoZGF5KTtcbn1cbmZ1bmN0aW9uIGlzVmFsaWRNb250aChtb250aCkge1xuICAgIHJldHVybiBNT05USF9SRUdFWC50ZXN0KG1vbnRoKTtcbn1cbmZ1bmN0aW9uIGlzVmFsaWRZZWFyKHllYXIpIHtcbiAgICByZXR1cm4gWUVBUl9SRUdFWC50ZXN0KHllYXIpO1xufVxuZnVuY3Rpb24gdmFsaWRhdGVUaW1lKCkge1xuICAgIGlmICh2YWxpZGF0ZUhvdXIoKSAmJiB2YWxpZGF0ZU1pbnV0ZXMoKSkge1xuICAgICAgICBpZiAoIWlzVGltZUJldHdlZW5PcGVuSG91cnMoKSlcbiAgICAgICAgICAgIHJldHVybiBkaXNwbGF5Rm9ybUVycm9yKGhvdXJJbnB1dCwgJ0luc2VydCB0aW1lIGJldHdlZW4gb3BlbiBob3VycycpO1xuICAgICAgICByZXR1cm4gcmVtb3ZlRm9ybUVycm9yKGhvdXJJbnB1dCk7XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcbn1cbmZ1bmN0aW9uIGlzVGltZUJldHdlZW5PcGVuSG91cnMoKSB7XG4gICAgY29uc3QgaG91ciA9IE51bWJlcihob3VySW5wdXQudmFsdWUpO1xuICAgIGNvbnN0IG1pbnV0ZXMgPSBOdW1iZXIobWludXRlc0lucHV0LnZhbHVlKTtcbiAgICBjb25zdCBkYXRlID0gbmV3IERhdGUoTnVtYmVyKHllYXJJbnB1dC52YWx1ZSksIE51bWJlcihtb250aElucHV0LnZhbHVlKSAtIDEsIE51bWJlcihkYXlJbnB1dC52YWx1ZSkpO1xuICAgIGNvbnN0IHdlZWtEYXkgPSBkYXRlLmdldERheSgpO1xuICAgIGNvbnN0IGRheVRpbWUgPSBvcmlnaW5hbFNlbGVjdC52YWx1ZTtcbiAgICBpZiAoTnVtYmVyLmlzTmFOKGhvdXIpIHx8IE51bWJlci5pc05hTihtaW51dGVzKSlcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIGlmIChOdW1iZXIuaXNOYU4od2Vla0RheSkpXG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICBpZiAoZGF5VGltZSA9PT0gJ2FtJylcbiAgICAgICAgcmV0dXJuIGlzQmV0d2Vlbk1vcm5pbmdIb3Vycyhob3VyKTtcbiAgICBlbHNlXG4gICAgICAgIHJldHVybiBpc0JldHdlZW5BZnRlcm5vb25Ib3Vycyhob3VyLCBtaW51dGVzLCB3ZWVrRGF5KTtcbn1cbmZ1bmN0aW9uIGlzQmV0d2Vlbk1vcm5pbmdIb3Vycyhob3VyKSB7XG4gICAgcmV0dXJuIGhvdXIgPj0gOSAmJiBob3VyIDwgMTI7XG59XG5mdW5jdGlvbiBpc0JldHdlZW5BZnRlcm5vb25Ib3Vycyhob3VyLCBtaW51dGVzLCB3ZWVrRGF5Q29kZSkge1xuICAgIGlmICh3ZWVrRGF5Q29kZSA8PSBGUklEQVlfQ09ERSAmJiB3ZWVrRGF5Q29kZSA+PSBNT05EQVlfQ09ERSkge1xuICAgICAgICByZXR1cm4gaG91ciA9PT0gMTIgfHwgaG91ciA8IDEwO1xuICAgIH1cbiAgICBpZiAod2Vla0RheUNvZGUgPT09IFNBVFVSREFZX0NPREUgfHwgd2Vla0RheUNvZGUgPT09IFNVTkRBWV9DT0RFKSB7XG4gICAgICAgIHJldHVybiBob3VyID09PSAxMiB8fCBob3VyIDwgMTEgfHwgKGhvdXIgPT09IDExICYmIG1pbnV0ZXMgPCAzMCk7XG4gICAgfVxuICAgIHJldHVybiB0cnVlO1xufVxuZnVuY3Rpb24gdmFsaWRhdGVIb3VyKCkge1xuICAgIGNvbnN0IGhvdXJWYWx1ZSA9IGhvdXJJbnB1dC52YWx1ZTtcbiAgICBpZiAoaXNCbGFuayhob3VyVmFsdWUpKVxuICAgICAgICByZXR1cm4gZGlzcGxheUZvcm1FcnJvcihob3VySW5wdXQsICdUaGlzIGZpZWxkIGlzIGluY29tcGxldGUnKTtcbiAgICBpZiAoIWlzVmFsaWRIb3VyKGhvdXJWYWx1ZSkpXG4gICAgICAgIHJldHVybiBkaXNwbGF5Rm9ybUVycm9yKGhvdXJJbnB1dCwgJ0luc2VydCB2YWxpZCBob3VyIGZvcm1hdCAoMDEgLSAxMiknKTtcbiAgICByZXR1cm4gcmVtb3ZlRm9ybUVycm9yKGhvdXJJbnB1dCk7XG59XG5mdW5jdGlvbiB2YWxpZGF0ZU1pbnV0ZXMoKSB7XG4gICAgY29uc3QgbWludXRlc1ZhbHVlID0gbWludXRlc0lucHV0LnZhbHVlO1xuICAgIGlmIChpc0JsYW5rKG1pbnV0ZXNWYWx1ZSkpXG4gICAgICAgIHJldHVybiBkaXNwbGF5Rm9ybUVycm9yKG1pbnV0ZXNJbnB1dCwgJ1RoaXMgZmllbGQgaXMgaW5jb21wbGV0ZScpO1xuICAgIGlmICghYXJlVmFsaWRNaW51dGVzKG1pbnV0ZXNWYWx1ZSkpXG4gICAgICAgIHJldHVybiBkaXNwbGF5Rm9ybUVycm9yKG1pbnV0ZXNJbnB1dCwgJ0luc2VydCB2YWxpZCBtaW51dGVzIGZvcm1hdCAoMDAgLSA1OSknKTtcbiAgICByZXR1cm4gcmVtb3ZlRm9ybUVycm9yKG1pbnV0ZXNJbnB1dCk7XG59XG5mdW5jdGlvbiBpc1ZhbGlkSG91cihob3VyKSB7XG4gICAgcmV0dXJuIEhPVVJfUkVHRVgudGVzdChob3VyKTtcbn1cbmZ1bmN0aW9uIGFyZVZhbGlkTWludXRlcyhtaW51dGVzKSB7XG4gICAgcmV0dXJuIE1JTlVURVNfUkVHRVgudGVzdChtaW51dGVzKTtcbn1cbmZ1bmN0aW9uIGlzQmxhbmsodmFsdWUpIHtcbiAgICByZXR1cm4gdmFsdWUgPT09ICcnO1xufVxuZnVuY3Rpb24gZGlzcGxheUZvcm1FcnJvcihpbnB1dCwgbWVzc2FnZSkge1xuICAgIGxldCBmb3JtR3JvdXAgPSBpbnB1dC5jbG9zZXN0KCcuZm9ybS1ncm91cCcpO1xuICAgIGxldCBmb3JtRXJyb3I7XG4gICAgd2hpbGUgKGZvcm1Hcm91cCkge1xuICAgICAgICBmb3JtR3JvdXAuY2xhc3NMaXN0LmFkZCgnZXJyb3InKTtcbiAgICAgICAgZm9ybUVycm9yID0gZm9ybUdyb3VwLnF1ZXJ5U2VsZWN0b3IoJy5mb3JtLWVycm9yJyk7XG4gICAgICAgIGlmIChmb3JtRXJyb3IpIHtcbiAgICAgICAgICAgIGZvcm1FcnJvci5pbm5lclRleHQgPSBtZXNzYWdlO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgZm9ybUdyb3VwID0gZm9ybUdyb3VwLnBhcmVudEVsZW1lbnQuY2xvc2VzdCgnLmZvcm0tZ3JvdXAnKTtcbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlO1xufVxuZnVuY3Rpb24gcmVtb3ZlRm9ybUVycm9yKGlucHV0KSB7XG4gICAgbGV0IGZvcm1Hcm91cCA9IGlucHV0LmNsb3Nlc3QoJy5mb3JtLWdyb3VwJyk7XG4gICAgbGV0IGZvcm1FcnJvcjtcbiAgICB3aGlsZSAoZm9ybUdyb3VwKSB7XG4gICAgICAgIGZvcm1Hcm91cC5jbGFzc0xpc3QucmVtb3ZlKCdlcnJvcicpO1xuICAgICAgICBmb3JtRXJyb3IgPSBmb3JtR3JvdXAucXVlcnlTZWxlY3RvcignLmZvcm0tZXJyb3InKTtcbiAgICAgICAgaWYgKGZvcm1FcnJvcilcbiAgICAgICAgICAgIGZvcm1FcnJvci5pbm5lclRleHQgPSAnJztcbiAgICAgICAgZm9ybUdyb3VwID0gZm9ybUdyb3VwLnBhcmVudEVsZW1lbnQuY2xvc2VzdCgnLmZvcm0tZ3JvdXAnKTtcbiAgICB9XG4gICAgcmV0dXJuIHRydWU7XG59XG4iXX0=
