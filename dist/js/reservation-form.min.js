"use strict";var customSelect=document.querySelector(".custom-select"),originalSelect=customSelect.querySelector("select"),originalSelectOptions=Array.from(originalSelect.querySelectorAll("option")),customSelectFocus=customSelect.querySelector(".custom-select__focus"),customSelectFocusText=customSelectFocus.querySelector("span"),customSelectOptionsContainer=customSelect.querySelector(".custom-select__options"),customSelectOptions=[],customSpinbutton=document.querySelector(".spinbutton"),spinButton=customSpinbutton.querySelector('[role="spinbutton"]'),decreaseSpinbutton=customSpinbutton.querySelector("#decrease-people"),increaseSpinbutton=customSpinbutton.querySelector("#increase-people"),reservationForm=document.querySelector(".reservation-form"),nameInput=reservationForm.querySelector('input[name="name"]'),emailInput=reservationForm.querySelector('input[name="email"]'),monthInput=reservationForm.querySelector('input[name="month"]'),dayInput=reservationForm.querySelector('input[name="day"]'),yearInput=reservationForm.querySelector('input[name="year"]'),hourInput=reservationForm.querySelector('input[name="hour"]'),minutesInput=reservationForm.querySelector('input[name="minute"]'),reservationSubmitBtn=reservationForm.querySelector('button[type="submit"]'),CHECK_ICON_URL="./dist/assets/images/icons/icon-check.svg",EMAIL_REGEX=/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,DAY_REGEX=/^(0[1-9])|([1-2]\d)|(3[0-1])$/,MAX_DAYS_IN_MONTH=31,MONTH_REGEX=/^(0[1-9])|(1[0-2])$/,YEAR_REGEX=/^\d{4}$/,HOUR_REGEX=/^(0[1-9])|(1[0-2])$/,MINUTES_REGEX=/^([0-5]\d)$/,MONDAY_CODE=1,FRIDAY_CODE=5,SATURDAY_CODE=6,SUNDAY_CODE=0;function createCustomSelectOptions(){originalSelectOptions.forEach(function(e){e=createCustomOption(e);customSelectOptions.push(e),customSelectOptionsContainer.appendChild(e)})}function createCustomOption(e){var t=document.createElement("span"),r=(t.classList.add("custom-select__option"),t.setAttribute("data-selected",e.selected.toString()),t.setAttribute("data-value",e.value),t.addEventListener("click",handleCustomOption),document.createElement("img")),n=(r.setAttribute("src",CHECK_ICON_URL),r.setAttribute("alt",""),document.createElement("span"));return n.innerText=e.innerText,t.appendChild(r),t.appendChild(n),t}function handleCustomOption(e){var t=e.target;originalSelectOptions.forEach(function(e){return e.selected=e.value===t.dataset.value}),handleSelection(),closeCustomSelect()}function handleSelection(){var t=originalSelectOptions.filter(function(e){return e.selected})[0].value;customSelectFocusText.innerText=t.toUpperCase(),customSelectOptions.forEach(function(e){e.dataset.selected=(e.dataset.value===t).toString()})}function openCustomSelect(){customSelect.dataset.open="true"}function closeCustomSelect(){customSelect.dataset.open="false"}function handleSpinButton(e){switch(e.key){case"ArrowUp":e.preventDefault(),increasePeople();break;case"ArrowDown":e.preventDefault(),decreasePeople();break;case"Home":e.preventDefault(),setMinPeople();break;case"End":e.preventDefault(),setMaxPeople()}}function increasePeople(){var e=Number(spinButton.getAttribute("aria-valuenow")),t=Number(spinButton.getAttribute("aria-valuemax"));updateSpinButton(Math.min(e+1,t))}function decreasePeople(){var e=Number(spinButton.getAttribute("aria-valuenow")),t=Number(spinButton.getAttribute("aria-valuemin"));updateSpinButton(Math.max(e-1,t))}function setMaxPeople(){updateSpinButton(Number(spinButton.getAttribute("aria-valuemax")))}function setMinPeople(){updateSpinButton(Number(spinButton.getAttribute("aria-valuemin")))}function updateSpinButton(e){spinButton.setAttribute("aria-valuenow",e.toString()),spinButton.setAttribute("aria-valuetext","".concat(e," people")),spinButton.innerText="".concat(e," people")}function validateName(){return isBlank(nameInput.value)?displayFormError(nameInput,"This field is required"):removeFormError(nameInput)}function validateEmail(){var e=emailInput.value;return isBlank(e)?displayFormError(emailInput,"This field is required"):isValidEmail(e)?removeFormError(emailInput):displayFormError(emailInput,"Provide a valid email address")}function isValidEmail(e){return EMAIL_REGEX.test(e)}function validateDate(){var e,t;return!!(validateDay()&&validateMonth()&&validateYear())&&(e=Number(dayInput.value),t=Number(monthInput.value),isDateAfterToday(Number(yearInput.value),t,e)?removeFormError(yearInput):displayFormError(yearInput,"Insert date after today"))}function validateDay(){var e=dayInput.value;return isBlank(e)?displayFormError(dayInput,"This field is incomplete"):isValidDay(e)?isDayWithinMonthRange(e)?removeFormError(dayInput):displayFormError(dayInput,"Insert day in range of selected month."):displayFormError(dayInput,"Insert valid day value (01 - 31)")}function isDateAfterToday(e,t,r){return new Date(e,t-1,r)>new Date}function isDayWithinMonthRange(e){var t=monthInput.value,r=yearInput.value;return!r||!t||(r=new Date(Number(r),Number(t),0).getDate()||MAX_DAYS_IN_MONTH,Number(e)<=r)}function validateMonth(){var e=monthInput.value;return isBlank(e)?displayFormError(monthInput,"This field is incomplete"):isValidMonth(e)?removeFormError(monthInput):displayFormError(monthInput,"Insert valid month value (01 - 12)")}function validateYear(){var e=yearInput.value;return isBlank(e)?displayFormError(yearInput,"This field is incomplete"):isValidYear(e)?removeFormError(yearInput):displayFormError(yearInput,"Insert valid year (4 digit number)")}function isValidDay(e){return DAY_REGEX.test(e)}function isValidMonth(e){return MONTH_REGEX.test(e)}function isValidYear(e){return YEAR_REGEX.test(e)}function validateTime(){return!(!validateHour()||!validateMinutes())&&(isTimeBetweenOpenHours()?removeFormError(hourInput):displayFormError(hourInput,"Insert time between open hours"))}function isTimeBetweenOpenHours(){var e=Number(hourInput.value),t=Number(minutesInput.value),r=new Date(Number(yearInput.value),Number(monthInput.value)-1,Number(dayInput.value)).getDay(),n=originalSelect.value;return!Number.isNaN(e)&&!Number.isNaN(t)&&!Number.isNaN(r)&&("am"===n?isBetweenMorningHours(e):isBetweenAfternoonHours(e,t,r))}function isBetweenMorningHours(e){return 9<=e&&e<12}function isBetweenAfternoonHours(e,t,r){return r<=FRIDAY_CODE&&MONDAY_CODE<=r?12===e||e<10:r!==SATURDAY_CODE&&r!==SUNDAY_CODE||12===e||e<11||11===e&&t<30}function validateHour(){var e=hourInput.value;return isBlank(e)?displayFormError(hourInput,"This field is incomplete"):isValidHour(e)?removeFormError(hourInput):displayFormError(hourInput,"Insert valid hour format (01 - 12)")}function validateMinutes(){var e=minutesInput.value;return isBlank(e)?displayFormError(minutesInput,"This field is incomplete"):areValidMinutes(e)?removeFormError(minutesInput):displayFormError(minutesInput,"Insert valid minutes format (00 - 59)")}function isValidHour(e){return HOUR_REGEX.test(e)}function areValidMinutes(e){return MINUTES_REGEX.test(e)}function isBlank(e){return""===e}function displayFormError(e,t){for(var r,n=e.closest(".form-group");n;){if(n.classList.add("error"),r=n.querySelector(".form-error")){r.innerText=t;break}n=n.parentElement.closest(".form-group")}return!1}function removeFormError(e){for(var t,r=e.closest(".form-group");r;)r.classList.remove("error"),(t=r.querySelector(".form-error"))&&(t.innerText=""),r=r.parentElement.closest(".form-group");return!0}createCustomSelectOptions(),originalSelect.addEventListener("keyup",function(e){switch(e.key){case"ArrowUp":case"ArrowDown":handleSelection();break;case"Enter":handleSelection(),closeCustomSelect()}}),customSelectFocus.addEventListener("click",function(e){originalSelect.focus()}),originalSelect.addEventListener("focusin",openCustomSelect),spinButton.addEventListener("keydown",handleSpinButton),increaseSpinbutton.addEventListener("click",increasePeople),decreaseSpinbutton.addEventListener("click",decreasePeople),reservationSubmitBtn.addEventListener("click",function(e){e.preventDefault(),validateName(),validateEmail(),validateDate(),validateTime()});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInJlc2VydmF0aW9uLWZvcm0udHMiLCJyZXNlcnZhdGlvbi1mb3JtLmpzIl0sIm5hbWVzIjpbImN1c3RvbVNlbGVjdCIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsIm9yaWdpbmFsU2VsZWN0Iiwib3JpZ2luYWxTZWxlY3RPcHRpb25zIiwiQXJyYXkiLCJmcm9tIiwicXVlcnlTZWxlY3RvckFsbCIsImN1c3RvbVNlbGVjdEZvY3VzIiwiY3VzdG9tU2VsZWN0Rm9jdXNUZXh0IiwiY3VzdG9tU2VsZWN0T3B0aW9uc0NvbnRhaW5lciIsImN1c3RvbVNlbGVjdE9wdGlvbnMiLCJjdXN0b21TcGluYnV0dG9uIiwic3BpbkJ1dHRvbiIsImRlY3JlYXNlU3BpbmJ1dHRvbiIsImluY3JlYXNlU3BpbmJ1dHRvbiIsInJlc2VydmF0aW9uRm9ybSIsIm5hbWVJbnB1dCIsImVtYWlsSW5wdXQiLCJtb250aElucHV0IiwiZGF5SW5wdXQiLCJ5ZWFySW5wdXQiLCJob3VySW5wdXQiLCJtaW51dGVzSW5wdXQiLCJyZXNlcnZhdGlvblN1Ym1pdEJ0biIsIkNIRUNLX0lDT05fVVJMIiwiRU1BSUxfUkVHRVgiLCJEQVlfUkVHRVgiLCJNQVhfREFZU19JTl9NT05USCIsIk1PTlRIX1JFR0VYIiwiWUVBUl9SRUdFWCIsIkhPVVJfUkVHRVgiLCJNSU5VVEVTX1JFR0VYIiwiTU9OREFZX0NPREUiLCJGUklEQVlfQ09ERSIsIlNBVFVSREFZX0NPREUiLCJTVU5EQVlfQ09ERSIsImNyZWF0ZUN1c3RvbVNlbGVjdE9wdGlvbnMiLCJmb3JFYWNoIiwib3B0aW9uIiwiY3VzdG9tT3B0aW9uIiwiY3JlYXRlQ3VzdG9tT3B0aW9uIiwicHVzaCIsImFwcGVuZENoaWxkIiwib3B0aW9uV3JhcHBlciIsImNyZWF0ZUVsZW1lbnQiLCJjaGVja0ltYWdlIiwiY2xhc3NMaXN0IiwiYWRkIiwic2V0QXR0cmlidXRlIiwic2VsZWN0ZWQiLCJ0b1N0cmluZyIsInZhbHVlIiwiYWRkRXZlbnRMaXN0ZW5lciIsImhhbmRsZUN1c3RvbU9wdGlvbiIsIm9wdGlvblRleHQiLCJpbm5lclRleHQiLCJlIiwidGFyZ2V0Iiwib3B0IiwiZGF0YXNldCIsImhhbmRsZVNlbGVjdGlvbiIsImNsb3NlQ3VzdG9tU2VsZWN0Iiwic2VsZWN0ZWRWYWx1ZSIsImZpbHRlciIsInRvVXBwZXJDYXNlIiwib3BlbkN1c3RvbVNlbGVjdCIsIm9wZW4iLCJoYW5kbGVTcGluQnV0dG9uIiwia2V5IiwicHJldmVudERlZmF1bHQiLCJpbmNyZWFzZVBlb3BsZSIsImRlY3JlYXNlUGVvcGxlIiwic2V0TWluUGVvcGxlIiwic2V0TWF4UGVvcGxlIiwiY3VycmVudFZhbHVlIiwiTnVtYmVyIiwiZ2V0QXR0cmlidXRlIiwibWF4VmFsdWUiLCJ1cGRhdGVTcGluQnV0dG9uIiwiTWF0aCIsIm1pbiIsIm1pblZhbHVlIiwibWF4IiwibmV3VmFsdWUiLCJjb25jYXQiLCJ2YWxpZGF0ZU5hbWUiLCJpc0JsYW5rIiwiZGlzcGxheUZvcm1FcnJvciIsInJlbW92ZUZvcm1FcnJvciIsInZhbGlkYXRlRW1haWwiLCJlbWFpbFZhbHVlIiwiaXNWYWxpZEVtYWlsIiwiZW1haWwiLCJ0ZXN0IiwidmFsaWRhdGVEYXRlIiwiZGF5IiwibW9udGgiLCJ2YWxpZGF0ZURheSIsInZhbGlkYXRlTW9udGgiLCJ2YWxpZGF0ZVllYXIiLCJpc0RhdGVBZnRlclRvZGF5IiwiZGF5VmFsdWUiLCJpc1ZhbGlkRGF5IiwiaXNEYXlXaXRoaW5Nb250aFJhbmdlIiwieWVhciIsIkRhdGUiLCJtb250aERheXMiLCJnZXREYXRlIiwibW9udGhWYWx1ZSIsImlzVmFsaWRNb250aCIsInllYXJWYWx1ZSIsImlzVmFsaWRZZWFyIiwidmFsaWRhdGVUaW1lIiwidmFsaWRhdGVIb3VyIiwidmFsaWRhdGVNaW51dGVzIiwiaXNUaW1lQmV0d2Vlbk9wZW5Ib3VycyIsImhvdXIiLCJtaW51dGVzIiwid2Vla0RheSIsImdldERheSIsImRheVRpbWUiLCJpc05hTiIsImlzQmV0d2Vlbk1vcm5pbmdIb3VycyIsImlzQmV0d2VlbkFmdGVybm9vbkhvdXJzIiwid2Vla0RheUNvZGUiLCJob3VyVmFsdWUiLCJpc1ZhbGlkSG91ciIsIm1pbnV0ZXNWYWx1ZSIsImFyZVZhbGlkTWludXRlcyIsImlucHV0IiwibWVzc2FnZSIsImZvcm1FcnJvciIsImZvcm1Hcm91cCIsImNsb3Nlc3QiLCJwYXJlbnRFbGVtZW50IiwicmVtb3ZlIiwiZm9jdXMiXSwibWFwcGluZ3MiOiJhQUNBLElBQU1BLGFBQTRCQyxTQUFTQyxjQUFjLGdCQUFnQixFQUNuRUMsZUFBb0NILGFBQWFFLGNBQWMsUUFBUSxFQUN2RUUsc0JBQWtEQyxNQUFNQyxLQUFLSCxlQUFlSSxpQkFBaUIsUUFBUSxDQUFDLEVBQ3RHQyxrQkFBaUNSLGFBQWFFLGNBQWMsdUJBQXVCLEVBQ25GTyxzQkFBcUNELGtCQUFrQk4sY0FBYyxNQUFNLEVBQzNFUSw2QkFBNENWLGFBQWFFLGNBQWMseUJBQXlCLEVBQ2xHUyxvQkFBMEMsR0FHeENDLGlCQUFnQ1gsU0FBU0MsY0FBYyxhQUFhLEVBQ3BFVyxXQUEwQkQsaUJBQWlCVixjQUFjLHFCQUFxQixFQUM5RVksbUJBQXdDRixpQkFBaUJWLGNBQWMsa0JBQWtCLEVBQ3pGYSxtQkFBd0NILGlCQUFpQlYsY0FBYyxrQkFBa0IsRUFHekZjLGdCQUFtQ2YsU0FBU0MsY0FBYyxtQkFBbUIsRUFDN0VlLFVBQThCRCxnQkFBZ0JkLGNBQWMsb0JBQW9CLEVBQ2hGZ0IsV0FBK0JGLGdCQUFnQmQsY0FBYyxxQkFBcUIsRUFDbEZpQixXQUErQkgsZ0JBQWdCZCxjQUFjLHFCQUFxQixFQUNsRmtCLFNBQTZCSixnQkFBZ0JkLGNBQWMsbUJBQW1CLEVBQzlFbUIsVUFBOEJMLGdCQUFnQmQsY0FBYyxvQkFBb0IsRUFDaEZvQixVQUE4Qk4sZ0JBQWdCZCxjQUFjLG9CQUFvQixFQUNoRnFCLGFBQWlDUCxnQkFBZ0JkLGNBQWMsc0JBQXNCLEVBQ3JGc0IscUJBQTBDUixnQkFBZ0JkLGNBQWMsdUJBQXVCLEVBRy9GdUIsZUFBeUIsNENB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QUNKQSxnQkFBZSxFQUNmQyxrQkFBaUIsQ0FDWCxDQUVULENBQUMsRUFFRHRELGtCQUFrQjZDLGlCQUFpQixRQUFTLFNBQUNJLEdBQzVDdEQsZUFBZXNJLE1BQUssQ0FDckIsQ0FBQyxFQUVEdEksZUFBZWtELGlCQUFpQixVQUFXYSxnQkFBZ0IsRUFHM0RyRCxXQUFXd0MsaUJBQWlCLFVBQVdlLGdCQUFnQixFQUN2RHJELG1CQUFtQnNDLGlCQUFpQixRQUFTa0IsY0FBYyxFQUMzRHpELG1CQUFtQnVDLGlCQUFpQixRQUFTbUIsY0FBYyxFQUczRGhELHFCQUFxQjZCLGlCQUFpQixRQUFTLFNBQUNJLEdBQy9DQSxFQUFFYSxlQUFjLEVBQ2hCZ0IsYUFBWSxFQUNaSSxjQUFhLEVBQ2JLLGFBQVksRUFDWmtCLGFBQVksQ0FDYixDQUFDIiwiZmlsZSI6InJlc2VydmF0aW9uLWZvcm0ubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyogY3VzdG9tIHNlbGVjdCBlbGVtZW50cyAqL1xyXG5jb25zdCBjdXN0b21TZWxlY3Q6IEhUTUxFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmN1c3RvbS1zZWxlY3QnKTtcclxuY29uc3Qgb3JpZ2luYWxTZWxlY3Q6IEhUTUxTZWxlY3RFbGVtZW50ID0gY3VzdG9tU2VsZWN0LnF1ZXJ5U2VsZWN0b3IoJ3NlbGVjdCcpO1xyXG5jb25zdCBvcmlnaW5hbFNlbGVjdE9wdGlvbnM6IEFycmF5PEhUTUxPcHRpb25FbGVtZW50PiA9IEFycmF5LmZyb20ob3JpZ2luYWxTZWxlY3QucXVlcnlTZWxlY3RvckFsbCgnb3B0aW9uJykpO1xyXG5jb25zdCBjdXN0b21TZWxlY3RGb2N1czogSFRNTEVsZW1lbnQgPSBjdXN0b21TZWxlY3QucXVlcnlTZWxlY3RvcignLmN1c3RvbS1zZWxlY3RfX2ZvY3VzJyk7XHJcbmNvbnN0IGN1c3RvbVNlbGVjdEZvY3VzVGV4dDogSFRNTEVsZW1lbnQgPSBjdXN0b21TZWxlY3RGb2N1cy5xdWVyeVNlbGVjdG9yKCdzcGFuJyk7XHJcbmNvbnN0IGN1c3RvbVNlbGVjdE9wdGlvbnNDb250YWluZXI6IEhUTUxFbGVtZW50ID0gY3VzdG9tU2VsZWN0LnF1ZXJ5U2VsZWN0b3IoJy5jdXN0b20tc2VsZWN0X19vcHRpb25zJyk7XHJcbmxldCBjdXN0b21TZWxlY3RPcHRpb25zOiBBcnJheTxIVE1MRWxlbWVudD4gPSBbXTtcclxuXHJcbi8qIHNwaW5idXR0b24gZWxlbWVudHMgKi9cclxuY29uc3QgY3VzdG9tU3BpbmJ1dHRvbjogSFRNTEVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuc3BpbmJ1dHRvbicpO1xyXG5jb25zdCBzcGluQnV0dG9uOiBIVE1MRWxlbWVudCA9IGN1c3RvbVNwaW5idXR0b24ucXVlcnlTZWxlY3RvcignW3JvbGU9XCJzcGluYnV0dG9uXCJdJyk7XHJcbmNvbnN0IGRlY3JlYXNlU3BpbmJ1dHRvbjogSFRNTEJ1dHRvbkVsZW1lbnQgPSBjdXN0b21TcGluYnV0dG9uLnF1ZXJ5U2VsZWN0b3IoJyNkZWNyZWFzZS1wZW9wbGUnKTtcclxuY29uc3QgaW5jcmVhc2VTcGluYnV0dG9uOiBIVE1MQnV0dG9uRWxlbWVudCA9IGN1c3RvbVNwaW5idXR0b24ucXVlcnlTZWxlY3RvcignI2luY3JlYXNlLXBlb3BsZScpO1xyXG5cclxuLyogZm9ybSBlbGVtZW50cyAqL1xyXG5jb25zdCByZXNlcnZhdGlvbkZvcm06IEhUTUxGb3JtRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5yZXNlcnZhdGlvbi1mb3JtJyk7XHJcbmNvbnN0IG5hbWVJbnB1dDogSFRNTElucHV0RWxlbWVudCA9IHJlc2VydmF0aW9uRm9ybS5xdWVyeVNlbGVjdG9yKCdpbnB1dFtuYW1lPVwibmFtZVwiXScpO1xyXG5jb25zdCBlbWFpbElucHV0OiBIVE1MSW5wdXRFbGVtZW50ID0gcmVzZXJ2YXRpb25Gb3JtLnF1ZXJ5U2VsZWN0b3IoJ2lucHV0W25hbWU9XCJlbWFpbFwiXScpO1xyXG5jb25zdCBtb250aElucHV0OiBIVE1MSW5wdXRFbGVtZW50ID0gcmVzZXJ2YXRpb25Gb3JtLnF1ZXJ5U2VsZWN0b3IoJ2lucHV0W25hbWU9XCJtb250aFwiXScpO1xyXG5jb25zdCBkYXlJbnB1dDogSFRNTElucHV0RWxlbWVudCA9IHJlc2VydmF0aW9uRm9ybS5xdWVyeVNlbGVjdG9yKCdpbnB1dFtuYW1lPVwiZGF5XCJdJyk7XHJcbmNvbnN0IHllYXJJbnB1dDogSFRNTElucHV0RWxlbWVudCA9IHJlc2VydmF0aW9uRm9ybS5xdWVyeVNlbGVjdG9yKCdpbnB1dFtuYW1lPVwieWVhclwiXScpO1xyXG5jb25zdCBob3VySW5wdXQ6IEhUTUxJbnB1dEVsZW1lbnQgPSByZXNlcnZhdGlvbkZvcm0ucXVlcnlTZWxlY3RvcignaW5wdXRbbmFtZT1cImhvdXJcIl0nKTtcclxuY29uc3QgbWludXRlc0lucHV0OiBIVE1MSW5wdXRFbGVtZW50ID0gcmVzZXJ2YXRpb25Gb3JtLnF1ZXJ5U2VsZWN0b3IoJ2lucHV0W25hbWU9XCJtaW51dGVcIl0nKTtcclxuY29uc3QgcmVzZXJ2YXRpb25TdWJtaXRCdG46IEhUTUxCdXR0b25FbGVtZW50ID0gcmVzZXJ2YXRpb25Gb3JtLnF1ZXJ5U2VsZWN0b3IoJ2J1dHRvblt0eXBlPVwic3VibWl0XCJdJyk7XHJcblxyXG4vKiBjb25zdGFudHMgKi9cclxuY29uc3QgQ0hFQ0tfSUNPTl9VUkw6IHN0cmluZyA9ICcuL2Rpc3QvYXNzZXRzL2ltYWdlcy9pY29ucy9pY29uLWNoZWNrLnN2Zyc7XHJcbmNvbnN0IEVNQUlMX1JFR0VYID1cclxuXHQvXigoW148PigpW1xcXVxcXFwuLDs6XFxzQFwiXSsoXFwuW148PigpW1xcXVxcXFwuLDs6XFxzQFwiXSspKil8KFwiLitcIikpQCgoXFxbWzAtOV17MSwzfVxcLlswLTldezEsM31cXC5bMC05XXsxLDN9XFwuWzAtOV17MSwzfVxcXSl8KChbYS16QS1aXFwtMC05XStcXC4pK1thLXpBLVpdezIsfSkpJC87XHJcbmNvbnN0IERBWV9SRUdFWCA9IC9eKDBbMS05XSl8KFsxLTJdXFxkKXwoM1swLTFdKSQvO1xyXG5jb25zdCBNQVhfREFZU19JTl9NT05USCA9IDMxO1xyXG5jb25zdCBNT05USF9SRUdFWCA9IC9eKDBbMS05XSl8KDFbMC0yXSkkLztcclxuY29uc3QgWUVBUl9SRUdFWCA9IC9eXFxkezR9JC87XHJcbmNvbnN0IEhPVVJfUkVHRVggPSAvXigwWzEtOV0pfCgxWzAtMl0pJC87XHJcbmNvbnN0IE1JTlVURVNfUkVHRVggPSAvXihbMC01XVxcZCkkLztcclxuY29uc3QgTU9OREFZX0NPREUgPSAxO1xyXG5jb25zdCBGUklEQVlfQ09ERSA9IDU7XHJcbmNvbnN0IFNBVFVSREFZX0NPREUgPSA2O1xyXG5jb25zdCBTVU5EQVlfQ09ERSA9IDA7XHJcblxyXG5jcmVhdGVDdXN0b21TZWxlY3RPcHRpb25zKCk7XHJcblxyXG4vKiBldmVudCBsaXN0ZW5lcnMgKi9cclxuLyogLS0tIGZvciBjdXN0b20gc2VsZWN0ICovXHJcbm9yaWdpbmFsU2VsZWN0LmFkZEV2ZW50TGlzdGVuZXIoJ2tleXVwJywgKGU6IEtleWJvYXJkRXZlbnQpID0+IHtcclxuXHRzd2l0Y2ggKGUua2V5KSB7XHJcblx0XHRjYXNlICdBcnJvd1VwJzpcclxuXHRcdGNhc2UgJ0Fycm93RG93bic6XHJcblx0XHRcdGhhbmRsZVNlbGVjdGlvbigpO1xyXG5cdFx0XHRicmVhaztcclxuXHRcdGNhc2UgJ0VudGVyJzpcclxuXHRcdFx0aGFuZGxlU2VsZWN0aW9uKCk7XHJcblx0XHRcdGNsb3NlQ3VzdG9tU2VsZWN0KCk7XHJcblx0XHRcdGJyZWFrO1xyXG5cdH1cclxufSk7XHJcblxyXG5jdXN0b21TZWxlY3RGb2N1cy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlOiBFdmVudCkgPT4ge1xyXG5cdG9yaWdpbmFsU2VsZWN0LmZvY3VzKCk7XHJcbn0pO1xyXG5cclxub3JpZ2luYWxTZWxlY3QuYWRkRXZlbnRMaXN0ZW5lcignZm9jdXNpbicsIG9wZW5DdXN0b21TZWxlY3QpO1xyXG5cclxuLyogLS0tIGZvciBzcGluYnV0dG9uICovXHJcbnNwaW5CdXR0b24uYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIGhhbmRsZVNwaW5CdXR0b24pO1xyXG5pbmNyZWFzZVNwaW5idXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBpbmNyZWFzZVBlb3BsZSk7XHJcbmRlY3JlYXNlU3BpbmJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGRlY3JlYXNlUGVvcGxlKTtcclxuXHJcbi8qIC0tLSBmb3IgcmVzZXJ2YXRpb24gZm9ybSAqL1xyXG5yZXNlcnZhdGlvblN1Ym1pdEJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlOiBFdmVudCkgPT4ge1xyXG5cdGUucHJldmVudERlZmF1bHQoKTtcclxuXHR2YWxpZGF0ZU5hbWUoKTtcclxuXHR2YWxpZGF0ZUVtYWlsKCk7XHJcblx0dmFsaWRhdGVEYXRlKCk7XHJcblx0dmFsaWRhdGVUaW1lKCk7XHJcbn0pO1xyXG5cclxuLyogaGVscGVyIGZ1bmN0aW9ucyAqL1xyXG4vKiAtLS0gZm9yIGN1c3RvbSBzZWxlY3QgKi9cclxuZnVuY3Rpb24gY3JlYXRlQ3VzdG9tU2VsZWN0T3B0aW9ucygpOiB2b2lkIHtcclxuXHRvcmlnaW5hbFNlbGVjdE9wdGlvbnMuZm9yRWFjaChvcHRpb24gPT4ge1xyXG5cdFx0Y29uc3QgY3VzdG9tT3B0aW9uOiBIVE1MRWxlbWVudCA9IGNyZWF0ZUN1c3RvbU9wdGlvbihvcHRpb24pO1xyXG5cdFx0Y3VzdG9tU2VsZWN0T3B0aW9ucy5wdXNoKGN1c3RvbU9wdGlvbik7XHJcblx0XHRjdXN0b21TZWxlY3RPcHRpb25zQ29udGFpbmVyLmFwcGVuZENoaWxkKGN1c3RvbU9wdGlvbik7XHJcblx0fSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGNyZWF0ZUN1c3RvbU9wdGlvbihvcHRpb246IEhUTUxPcHRpb25FbGVtZW50KTogSFRNTEVsZW1lbnQge1xyXG5cdGNvbnN0IG9wdGlvbldyYXBwZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7XHJcblx0b3B0aW9uV3JhcHBlci5jbGFzc0xpc3QuYWRkKCdjdXN0b20tc2VsZWN0X19vcHRpb24nKTtcclxuXHRvcHRpb25XcmFwcGVyLnNldEF0dHJpYnV0ZSgnZGF0YS1zZWxlY3RlZCcsIG9wdGlvbi5zZWxlY3RlZC50b1N0cmluZygpKTtcclxuXHRvcHRpb25XcmFwcGVyLnNldEF0dHJpYnV0ZSgnZGF0YS12YWx1ZScsIG9wdGlvbi52YWx1ZSk7XHJcblx0b3B0aW9uV3JhcHBlci5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGhhbmRsZUN1c3RvbU9wdGlvbik7XHJcblxyXG5cdGNvbnN0IGNoZWNrSW1hZ2UgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbWcnKTtcclxuXHRjaGVja0ltYWdlLnNldEF0dHJpYnV0ZSgnc3JjJywgQ0hFQ0tfSUNPTl9VUkwpO1xyXG5cdGNoZWNrSW1hZ2Uuc2V0QXR0cmlidXRlKCdhbHQnLCAnJyk7XHJcblxyXG5cdGNvbnN0IG9wdGlvblRleHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7XHJcblx0b3B0aW9uVGV4dC5pbm5lclRleHQgPSBvcHRpb24uaW5uZXJUZXh0O1xyXG5cclxuXHRvcHRpb25XcmFwcGVyLmFwcGVuZENoaWxkKGNoZWNrSW1hZ2UpO1xyXG5cdG9wdGlvbldyYXBwZXIuYXBwZW5kQ2hpbGQob3B0aW9uVGV4dCk7XHJcblxyXG5cdHJldHVybiBvcHRpb25XcmFwcGVyO1xyXG59XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVDdXN0b21PcHRpb24oZTogRXZlbnQpOiB2b2lkIHtcclxuXHRjb25zdCBvcHRpb246IEhUTUxFbGVtZW50ID0gZS50YXJnZXQgYXMgSFRNTEVsZW1lbnQ7XHJcblx0b3JpZ2luYWxTZWxlY3RPcHRpb25zLmZvckVhY2gob3B0ID0+IChvcHQuc2VsZWN0ZWQgPSBvcHQudmFsdWUgPT09IG9wdGlvbi5kYXRhc2V0LnZhbHVlKSk7XHJcblx0aGFuZGxlU2VsZWN0aW9uKCk7XHJcblx0Y2xvc2VDdXN0b21TZWxlY3QoKTtcclxufVxyXG5cclxuZnVuY3Rpb24gaGFuZGxlU2VsZWN0aW9uKCk6IHZvaWQge1xyXG5cdGNvbnN0IHNlbGVjdGVkVmFsdWU6IHN0cmluZyA9IG9yaWdpbmFsU2VsZWN0T3B0aW9ucy5maWx0ZXIob3B0ID0+IG9wdC5zZWxlY3RlZClbMF0udmFsdWU7XHJcblx0Y3VzdG9tU2VsZWN0Rm9jdXNUZXh0LmlubmVyVGV4dCA9IHNlbGVjdGVkVmFsdWUudG9VcHBlckNhc2UoKTtcclxuXHRjdXN0b21TZWxlY3RPcHRpb25zLmZvckVhY2gob3B0aW9uID0+IHtcclxuXHRcdG9wdGlvbi5kYXRhc2V0LnNlbGVjdGVkID0gKG9wdGlvbi5kYXRhc2V0LnZhbHVlID09PSBzZWxlY3RlZFZhbHVlKS50b1N0cmluZygpO1xyXG5cdH0pO1xyXG59XHJcblxyXG5mdW5jdGlvbiBvcGVuQ3VzdG9tU2VsZWN0KCk6IHZvaWQge1xyXG5cdGN1c3RvbVNlbGVjdC5kYXRhc2V0Lm9wZW4gPSAndHJ1ZSc7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGNsb3NlQ3VzdG9tU2VsZWN0KCk6IHZvaWQge1xyXG5cdGN1c3RvbVNlbGVjdC5kYXRhc2V0Lm9wZW4gPSAnZmFsc2UnO1xyXG59XHJcblxyXG4vKiAtLS0gZm9yIHNwaW5idXR0b24gKi9cclxuZnVuY3Rpb24gaGFuZGxlU3BpbkJ1dHRvbihlOiBLZXlib2FyZEV2ZW50KTogdm9pZCB7XHJcblx0c3dpdGNoIChlLmtleSkge1xyXG5cdFx0Y2FzZSAnQXJyb3dVcCc6XHJcblx0XHRcdGUucHJldmVudERlZmF1bHQoKTtcclxuXHRcdFx0aW5jcmVhc2VQZW9wbGUoKTtcclxuXHRcdFx0YnJlYWs7XHJcblx0XHRjYXNlICdBcnJvd0Rvd24nOlxyXG5cdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XHJcblx0XHRcdGRlY3JlYXNlUGVvcGxlKCk7XHJcblx0XHRcdGJyZWFrO1xyXG5cdFx0Y2FzZSAnSG9tZSc6XHJcblx0XHRcdGUucHJldmVudERlZmF1bHQoKTtcclxuXHRcdFx0c2V0TWluUGVvcGxlKCk7XHJcblx0XHRcdGJyZWFrO1xyXG5cdFx0Y2FzZSAnRW5kJzpcclxuXHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cdFx0XHRzZXRNYXhQZW9wbGUoKTtcclxuXHRcdFx0YnJlYWs7XHJcblx0fVxyXG59XHJcblxyXG5mdW5jdGlvbiBpbmNyZWFzZVBlb3BsZSgpOiB2b2lkIHtcclxuXHRjb25zdCBjdXJyZW50VmFsdWU6IG51bWJlciA9IE51bWJlcihzcGluQnV0dG9uLmdldEF0dHJpYnV0ZSgnYXJpYS12YWx1ZW5vdycpKTtcclxuXHRjb25zdCBtYXhWYWx1ZTogbnVtYmVyID0gTnVtYmVyKHNwaW5CdXR0b24uZ2V0QXR0cmlidXRlKCdhcmlhLXZhbHVlbWF4JykpO1xyXG5cdGNvbnN0IG5ld1ZhbHVlOiBudW1iZXIgPSBNYXRoLm1pbihjdXJyZW50VmFsdWUgKyAxLCBtYXhWYWx1ZSk7XHJcblx0dXBkYXRlU3BpbkJ1dHRvbihuZXdWYWx1ZSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGRlY3JlYXNlUGVvcGxlKCk6IHZvaWQge1xyXG5cdGNvbnN0IGN1cnJlbnRWYWx1ZTogbnVtYmVyID0gTnVtYmVyKHNwaW5CdXR0b24uZ2V0QXR0cmlidXRlKCdhcmlhLXZhbHVlbm93JykpO1xyXG5cdGNvbnN0IG1pblZhbHVlOiBudW1iZXIgPSBOdW1iZXIoc3BpbkJ1dHRvbi5nZXRBdHRyaWJ1dGUoJ2FyaWEtdmFsdWVtaW4nKSk7XHJcblx0Y29uc3QgbmV3VmFsdWU6IG51bWJlciA9IE1hdGgubWF4KGN1cnJlbnRWYWx1ZSAtIDEsIG1pblZhbHVlKTtcclxuXHR1cGRhdGVTcGluQnV0dG9uKG5ld1ZhbHVlKTtcclxufVxyXG5cclxuZnVuY3Rpb24gc2V0TWF4UGVvcGxlKCk6IHZvaWQge1xyXG5cdGNvbnN0IG1heFZhbHVlOiBudW1iZXIgPSBOdW1iZXIoc3BpbkJ1dHRvbi5nZXRBdHRyaWJ1dGUoJ2FyaWEtdmFsdWVtYXgnKSk7XHJcblx0dXBkYXRlU3BpbkJ1dHRvbihtYXhWYWx1ZSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHNldE1pblBlb3BsZSgpOiB2b2lkIHtcclxuXHRjb25zdCBtaW5WYWx1ZTogbnVtYmVyID0gTnVtYmVyKHNwaW5CdXR0b24uZ2V0QXR0cmlidXRlKCdhcmlhLXZhbHVlbWluJykpO1xyXG5cdHVwZGF0ZVNwaW5CdXR0b24obWluVmFsdWUpO1xyXG59XHJcblxyXG5mdW5jdGlvbiB1cGRhdGVTcGluQnV0dG9uKG5ld1ZhbHVlOiBudW1iZXIpOiB2b2lkIHtcclxuXHRzcGluQnV0dG9uLnNldEF0dHJpYnV0ZSgnYXJpYS12YWx1ZW5vdycsIG5ld1ZhbHVlLnRvU3RyaW5nKCkpO1xyXG5cdHNwaW5CdXR0b24uc2V0QXR0cmlidXRlKCdhcmlhLXZhbHVldGV4dCcsIGAke25ld1ZhbHVlfSBwZW9wbGVgKTtcclxuXHRzcGluQnV0dG9uLmlubmVyVGV4dCA9IGAke25ld1ZhbHVlfSBwZW9wbGVgO1xyXG59XHJcblxyXG4vKiAtLS0gZm9yIGZvcm0gdmFsaWRhdGlvbiAqL1xyXG4vKiAtLS0gLS0tIG5hbWUgdmFsaWRhdGlvbiAqL1xyXG5mdW5jdGlvbiB2YWxpZGF0ZU5hbWUoKTogYm9vbGVhbiB7XHJcblx0Y29uc3QgbmFtZVZhbHVlOiBzdHJpbmcgPSBuYW1lSW5wdXQudmFsdWU7XHJcblxyXG5cdGlmIChpc0JsYW5rKG5hbWVWYWx1ZSkpIHJldHVybiBkaXNwbGF5Rm9ybUVycm9yKG5hbWVJbnB1dCwgJ1RoaXMgZmllbGQgaXMgcmVxdWlyZWQnKTtcclxuXHJcblx0cmV0dXJuIHJlbW92ZUZvcm1FcnJvcihuYW1lSW5wdXQpO1xyXG59XHJcblxyXG4vKiAtLS0gLS0tIGVtYWlsIHZhbGlkYXRpb24gKi9cclxuZnVuY3Rpb24gdmFsaWRhdGVFbWFpbCgpOiBib29sZWFuIHtcclxuXHRjb25zdCBlbWFpbFZhbHVlOiBzdHJpbmcgPSBlbWFpbElucHV0LnZhbHVlO1xyXG5cclxuXHRpZiAoaXNCbGFuayhlbWFpbFZhbHVlKSkgcmV0dXJuIGRpc3BsYXlGb3JtRXJyb3IoZW1haWxJbnB1dCwgJ1RoaXMgZmllbGQgaXMgcmVxdWlyZWQnKTtcclxuXHRpZiAoIWlzVmFsaWRFbWFpbChlbWFpbFZhbHVlKSkgcmV0dXJuIGRpc3BsYXlGb3JtRXJyb3IoZW1haWxJbnB1dCwgJ1Byb3ZpZGUgYSB2YWxpZCBlbWFpbCBhZGRyZXNzJyk7XHJcblxyXG5cdHJldHVybiByZW1vdmVGb3JtRXJyb3IoZW1haWxJbnB1dCk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGlzVmFsaWRFbWFpbChlbWFpbDogc3RyaW5nKTogYm9vbGVhbiB7XHJcblx0cmV0dXJuIEVNQUlMX1JFR0VYLnRlc3QoZW1haWwpO1xyXG59XHJcblxyXG4vKiAtLS0gLS0tIGRhdGUgdmFsaWRhdGlvbiAqL1xyXG5mdW5jdGlvbiB2YWxpZGF0ZURhdGUoKTogYm9vbGVhbiB7XHJcblx0aWYgKHZhbGlkYXRlRGF5KCkgJiYgdmFsaWRhdGVNb250aCgpICYmIHZhbGlkYXRlWWVhcigpKSB7XHJcblx0XHRjb25zdCBkYXk6IG51bWJlciA9IE51bWJlcihkYXlJbnB1dC52YWx1ZSk7XHJcblx0XHRjb25zdCBtb250aDogbnVtYmVyID0gTnVtYmVyKG1vbnRoSW5wdXQudmFsdWUpO1xyXG5cdFx0Y29uc3QgeWVhcjogbnVtYmVyID0gTnVtYmVyKHllYXJJbnB1dC52YWx1ZSk7XHJcblxyXG5cdFx0aWYgKCFpc0RhdGVBZnRlclRvZGF5KHllYXIsIG1vbnRoLCBkYXkpKSByZXR1cm4gZGlzcGxheUZvcm1FcnJvcih5ZWFySW5wdXQsICdJbnNlcnQgZGF0ZSBhZnRlciB0b2RheScpO1xyXG5cclxuXHRcdHJldHVybiByZW1vdmVGb3JtRXJyb3IoeWVhcklucHV0KTtcclxuXHR9XHJcblxyXG5cdHJldHVybiBmYWxzZTtcclxufVxyXG5cclxuZnVuY3Rpb24gdmFsaWRhdGVEYXkoKTogYm9vbGVhbiB7XHJcblx0Y29uc3QgZGF5VmFsdWU6IHN0cmluZyA9IGRheUlucHV0LnZhbHVlO1xyXG5cclxuXHRpZiAoaXNCbGFuayhkYXlWYWx1ZSkpIHJldHVybiBkaXNwbGF5Rm9ybUVycm9yKGRheUlucHV0LCAnVGhpcyBmaWVsZCBpcyBpbmNvbXBsZXRlJyk7XHJcblx0aWYgKCFpc1ZhbGlkRGF5KGRheVZhbHVlKSkgcmV0dXJuIGRpc3BsYXlGb3JtRXJyb3IoZGF5SW5wdXQsICdJbnNlcnQgdmFsaWQgZGF5IHZhbHVlICgwMSAtIDMxKScpO1xyXG5cdGlmICghaXNEYXlXaXRoaW5Nb250aFJhbmdlKGRheVZhbHVlKSkgcmV0dXJuIGRpc3BsYXlGb3JtRXJyb3IoZGF5SW5wdXQsICdJbnNlcnQgZGF5IGluIHJhbmdlIG9mIHNlbGVjdGVkIG1vbnRoLicpO1xyXG5cclxuXHRyZXR1cm4gcmVtb3ZlRm9ybUVycm9yKGRheUlucHV0KTtcclxufVxyXG5cclxuZnVuY3Rpb24gaXNEYXRlQWZ0ZXJUb2RheSh5ZWFyOiBudW1iZXIsIG1vbnRoOiBudW1iZXIsIGRheTogbnVtYmVyKTogYm9vbGVhbiB7XHJcblx0cmV0dXJuIG5ldyBEYXRlKHllYXIsIG1vbnRoIC0gMSwgZGF5KSA+IG5ldyBEYXRlKCk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGlzRGF5V2l0aGluTW9udGhSYW5nZShkYXk6IHN0cmluZyk6IGJvb2xlYW4ge1xyXG5cdGNvbnN0IG1vbnRoOiBzdHJpbmcgPSBtb250aElucHV0LnZhbHVlO1xyXG5cdGNvbnN0IHllYXI6IHN0cmluZyA9IHllYXJJbnB1dC52YWx1ZTtcclxuXHJcblx0aWYgKCF5ZWFyIHx8ICFtb250aCkgcmV0dXJuIHRydWU7XHJcblx0Y29uc3QgbW9udGhEYXlzOiBudW1iZXIgPSBuZXcgRGF0ZShOdW1iZXIoeWVhciksIE51bWJlcihtb250aCksIDApLmdldERhdGUoKSB8fCBNQVhfREFZU19JTl9NT05USDtcclxuXHRyZXR1cm4gTnVtYmVyKGRheSkgPD0gbW9udGhEYXlzO1xyXG59XHJcblxyXG5mdW5jdGlvbiB2YWxpZGF0ZU1vbnRoKCk6IGJvb2xlYW4ge1xyXG5cdGNvbnN0IG1vbnRoVmFsdWU6IHN0cmluZyA9IG1vbnRoSW5wdXQudmFsdWU7XHJcblxyXG5cdGlmIChpc0JsYW5rKG1vbnRoVmFsdWUpKSByZXR1cm4gZGlzcGxheUZvcm1FcnJvcihtb250aElucHV0LCAnVGhpcyBmaWVsZCBpcyBpbmNvbXBsZXRlJyk7XHJcblx0aWYgKCFpc1ZhbGlkTW9udGgobW9udGhWYWx1ZSkpIHJldHVybiBkaXNwbGF5Rm9ybUVycm9yKG1vbnRoSW5wdXQsICdJbnNlcnQgdmFsaWQgbW9udGggdmFsdWUgKDAxIC0gMTIpJyk7XHJcblxyXG5cdHJldHVybiByZW1vdmVGb3JtRXJyb3IobW9udGhJbnB1dCk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHZhbGlkYXRlWWVhcigpOiBib29sZWFuIHtcclxuXHRjb25zdCB5ZWFyVmFsdWU6IHN0cmluZyA9IHllYXJJbnB1dC52YWx1ZTtcclxuXHJcblx0aWYgKGlzQmxhbmsoeWVhclZhbHVlKSkgcmV0dXJuIGRpc3BsYXlGb3JtRXJyb3IoeWVhcklucHV0LCAnVGhpcyBmaWVsZCBpcyBpbmNvbXBsZXRlJyk7XHJcblx0aWYgKCFpc1ZhbGlkWWVhcih5ZWFyVmFsdWUpKSByZXR1cm4gZGlzcGxheUZvcm1FcnJvcih5ZWFySW5wdXQsICdJbnNlcnQgdmFsaWQgeWVhciAoNCBkaWdpdCBudW1iZXIpJyk7XHJcblxyXG5cdHJldHVybiByZW1vdmVGb3JtRXJyb3IoeWVhcklucHV0KTtcclxufVxyXG5cclxuZnVuY3Rpb24gaXNWYWxpZERheShkYXk6IHN0cmluZyk6IGJvb2xlYW4ge1xyXG5cdHJldHVybiBEQVlfUkVHRVgudGVzdChkYXkpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBpc1ZhbGlkTW9udGgobW9udGg6IHN0cmluZyk6IGJvb2xlYW4ge1xyXG5cdHJldHVybiBNT05USF9SRUdFWC50ZXN0KG1vbnRoKTtcclxufVxyXG5cclxuZnVuY3Rpb24gaXNWYWxpZFllYXIoeWVhcjogc3RyaW5nKTogYm9vbGVhbiB7XHJcblx0cmV0dXJuIFlFQVJfUkVHRVgudGVzdCh5ZWFyKTtcclxufVxyXG5cclxuLyogLS0tIC0tLSB0aW1lIHZhbGlkYXRpb24gKi9cclxuZnVuY3Rpb24gdmFsaWRhdGVUaW1lKCk6IGJvb2xlYW4ge1xyXG5cdGlmICh2YWxpZGF0ZUhvdXIoKSAmJiB2YWxpZGF0ZU1pbnV0ZXMoKSkge1xyXG5cdFx0aWYgKCFpc1RpbWVCZXR3ZWVuT3BlbkhvdXJzKCkpIHJldHVybiBkaXNwbGF5Rm9ybUVycm9yKGhvdXJJbnB1dCwgJ0luc2VydCB0aW1lIGJldHdlZW4gb3BlbiBob3VycycpO1xyXG5cclxuXHRcdHJldHVybiByZW1vdmVGb3JtRXJyb3IoaG91cklucHV0KTtcclxuXHR9XHJcblxyXG5cdHJldHVybiBmYWxzZTtcclxufVxyXG5cclxuZnVuY3Rpb24gaXNUaW1lQmV0d2Vlbk9wZW5Ib3VycygpOiBib29sZWFuIHtcclxuXHRjb25zdCBob3VyOiBudW1iZXIgPSBOdW1iZXIoaG91cklucHV0LnZhbHVlKTtcclxuXHRjb25zdCBtaW51dGVzOiBudW1iZXIgPSBOdW1iZXIobWludXRlc0lucHV0LnZhbHVlKTtcclxuXHRjb25zdCBkYXRlOiBEYXRlID0gbmV3IERhdGUoTnVtYmVyKHllYXJJbnB1dC52YWx1ZSksIE51bWJlcihtb250aElucHV0LnZhbHVlKSAtIDEsIE51bWJlcihkYXlJbnB1dC52YWx1ZSkpO1xyXG5cdGNvbnN0IHdlZWtEYXk6IG51bWJlciA9IGRhdGUuZ2V0RGF5KCk7XHJcblx0Y29uc3QgZGF5VGltZTogc3RyaW5nID0gb3JpZ2luYWxTZWxlY3QudmFsdWU7XHJcblxyXG5cdGlmIChOdW1iZXIuaXNOYU4oaG91cikgfHwgTnVtYmVyLmlzTmFOKG1pbnV0ZXMpKSByZXR1cm4gZmFsc2U7XHJcblx0aWYgKE51bWJlci5pc05hTih3ZWVrRGF5KSkgcmV0dXJuIGZhbHNlO1xyXG5cclxuXHRpZiAoZGF5VGltZSA9PT0gJ2FtJykgcmV0dXJuIGlzQmV0d2Vlbk1vcm5pbmdIb3Vycyhob3VyKTtcclxuXHRlbHNlIHJldHVybiBpc0JldHdlZW5BZnRlcm5vb25Ib3Vycyhob3VyLCBtaW51dGVzLCB3ZWVrRGF5KTtcclxufVxyXG5cclxuZnVuY3Rpb24gaXNCZXR3ZWVuTW9ybmluZ0hvdXJzKGhvdXI6IG51bWJlcik6IGJvb2xlYW4ge1xyXG5cdHJldHVybiBob3VyID49IDkgJiYgaG91ciA8IDEyO1xyXG59XHJcblxyXG5mdW5jdGlvbiBpc0JldHdlZW5BZnRlcm5vb25Ib3Vycyhob3VyOiBudW1iZXIsIG1pbnV0ZXM6IG51bWJlciwgd2Vla0RheUNvZGU6IG51bWJlcik6IGJvb2xlYW4ge1xyXG5cdGlmICh3ZWVrRGF5Q29kZSA8PSBGUklEQVlfQ09ERSAmJiB3ZWVrRGF5Q29kZSA+PSBNT05EQVlfQ09ERSkge1xyXG5cdFx0cmV0dXJuIGhvdXIgPT09IDEyIHx8IGhvdXIgPCAxMDtcclxuXHR9XHJcblx0aWYgKHdlZWtEYXlDb2RlID09PSBTQVRVUkRBWV9DT0RFIHx8IHdlZWtEYXlDb2RlID09PSBTVU5EQVlfQ09ERSkge1xyXG5cdFx0cmV0dXJuIGhvdXIgPT09IDEyIHx8IGhvdXIgPCAxMSB8fCAoaG91ciA9PT0gMTEgJiYgbWludXRlcyA8IDMwKTtcclxuXHR9XHJcblxyXG5cdHJldHVybiB0cnVlO1xyXG59XHJcblxyXG5mdW5jdGlvbiB2YWxpZGF0ZUhvdXIoKTogYm9vbGVhbiB7XHJcblx0Y29uc3QgaG91clZhbHVlOiBzdHJpbmcgPSBob3VySW5wdXQudmFsdWU7XHJcblxyXG5cdGlmIChpc0JsYW5rKGhvdXJWYWx1ZSkpIHJldHVybiBkaXNwbGF5Rm9ybUVycm9yKGhvdXJJbnB1dCwgJ1RoaXMgZmllbGQgaXMgaW5jb21wbGV0ZScpO1xyXG5cdGlmICghaXNWYWxpZEhvdXIoaG91clZhbHVlKSkgcmV0dXJuIGRpc3BsYXlGb3JtRXJyb3IoaG91cklucHV0LCAnSW5zZXJ0IHZhbGlkIGhvdXIgZm9ybWF0ICgwMSAtIDEyKScpO1xyXG5cclxuXHRyZXR1cm4gcmVtb3ZlRm9ybUVycm9yKGhvdXJJbnB1dCk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHZhbGlkYXRlTWludXRlcygpOiBib29sZWFuIHtcclxuXHRjb25zdCBtaW51dGVzVmFsdWU6IHN0cmluZyA9IG1pbnV0ZXNJbnB1dC52YWx1ZTtcclxuXHJcblx0aWYgKGlzQmxhbmsobWludXRlc1ZhbHVlKSkgcmV0dXJuIGRpc3BsYXlGb3JtRXJyb3IobWludXRlc0lucHV0LCAnVGhpcyBmaWVsZCBpcyBpbmNvbXBsZXRlJyk7XHJcblx0aWYgKCFhcmVWYWxpZE1pbnV0ZXMobWludXRlc1ZhbHVlKSkgcmV0dXJuIGRpc3BsYXlGb3JtRXJyb3IobWludXRlc0lucHV0LCAnSW5zZXJ0IHZhbGlkIG1pbnV0ZXMgZm9ybWF0ICgwMCAtIDU5KScpO1xyXG5cclxuXHRyZXR1cm4gcmVtb3ZlRm9ybUVycm9yKG1pbnV0ZXNJbnB1dCk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGlzVmFsaWRIb3VyKGhvdXI6IHN0cmluZyk6IGJvb2xlYW4ge1xyXG5cdHJldHVybiBIT1VSX1JFR0VYLnRlc3QoaG91cik7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGFyZVZhbGlkTWludXRlcyhtaW51dGVzOiBzdHJpbmcpOiBib29sZWFuIHtcclxuXHRyZXR1cm4gTUlOVVRFU19SRUdFWC50ZXN0KG1pbnV0ZXMpO1xyXG59XHJcblxyXG4vKiAtLS0gLS0tIGdlbmVyYWwgZm9ybSB2YWxpZGF0aW9uICovXHJcbmZ1bmN0aW9uIGlzQmxhbmsodmFsdWU6IHN0cmluZyk6IGJvb2xlYW4ge1xyXG5cdHJldHVybiB2YWx1ZSA9PT0gJyc7XHJcbn1cclxuLyogLS0tIC0tLSBmb3JtIGVycm9yIGRpc3BsYXlpbmcgKi9cclxuZnVuY3Rpb24gZGlzcGxheUZvcm1FcnJvcihpbnB1dDogSFRNTElucHV0RWxlbWVudCwgbWVzc2FnZTogc3RyaW5nKTogYm9vbGVhbiB7XHJcblx0bGV0IGZvcm1Hcm91cDogSFRNTEVsZW1lbnQgPSBpbnB1dC5jbG9zZXN0KCcuZm9ybS1ncm91cCcpO1xyXG5cdGxldCBmb3JtRXJyb3I6IEhUTUxFbGVtZW50O1xyXG5cclxuXHR3aGlsZSAoZm9ybUdyb3VwKSB7XHJcblx0XHRmb3JtR3JvdXAuY2xhc3NMaXN0LmFkZCgnZXJyb3InKTtcclxuXHRcdGZvcm1FcnJvciA9IGZvcm1Hcm91cC5xdWVyeVNlbGVjdG9yKCcuZm9ybS1lcnJvcicpO1xyXG5cclxuXHRcdGlmIChmb3JtRXJyb3IpIHtcclxuXHRcdFx0Zm9ybUVycm9yLmlubmVyVGV4dCA9IG1lc3NhZ2U7XHJcblx0XHRcdGJyZWFrO1xyXG5cdFx0fVxyXG5cclxuXHRcdGZvcm1Hcm91cCA9IGZvcm1Hcm91cC5wYXJlbnRFbGVtZW50LmNsb3Nlc3QoJy5mb3JtLWdyb3VwJyk7XHJcblx0fVxyXG5cclxuXHRyZXR1cm4gZmFsc2U7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHJlbW92ZUZvcm1FcnJvcihpbnB1dDogSFRNTElucHV0RWxlbWVudCk6IGJvb2xlYW4ge1xyXG5cdGxldCBmb3JtR3JvdXA6IEhUTUxFbGVtZW50ID0gaW5wdXQuY2xvc2VzdCgnLmZvcm0tZ3JvdXAnKTtcclxuXHRsZXQgZm9ybUVycm9yOiBIVE1MRWxlbWVudDtcclxuXHJcblx0d2hpbGUgKGZvcm1Hcm91cCkge1xyXG5cdFx0Zm9ybUdyb3VwLmNsYXNzTGlzdC5yZW1vdmUoJ2Vycm9yJyk7XHJcblx0XHRmb3JtRXJyb3IgPSBmb3JtR3JvdXAucXVlcnlTZWxlY3RvcignLmZvcm0tZXJyb3InKTtcclxuXHJcblx0XHRpZiAoZm9ybUVycm9yKSBmb3JtRXJyb3IuaW5uZXJUZXh0ID0gJyc7XHJcblxyXG5cdFx0Zm9ybUdyb3VwID0gZm9ybUdyb3VwLnBhcmVudEVsZW1lbnQuY2xvc2VzdCgnLmZvcm0tZ3JvdXAnKTtcclxuXHR9XHJcblxyXG5cdHJldHVybiB0cnVlO1xyXG59XHJcbiIsImNvbnN0IGN1c3RvbVNlbGVjdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jdXN0b20tc2VsZWN0Jyk7XG5jb25zdCBvcmlnaW5hbFNlbGVjdCA9IGN1c3RvbVNlbGVjdC5xdWVyeVNlbGVjdG9yKCdzZWxlY3QnKTtcbmNvbnN0IG9yaWdpbmFsU2VsZWN0T3B0aW9ucyA9IEFycmF5LmZyb20ob3JpZ2luYWxTZWxlY3QucXVlcnlTZWxlY3RvckFsbCgnb3B0aW9uJykpO1xuY29uc3QgY3VzdG9tU2VsZWN0Rm9jdXMgPSBjdXN0b21TZWxlY3QucXVlcnlTZWxlY3RvcignLmN1c3RvbS1zZWxlY3RfX2ZvY3VzJyk7XG5jb25zdCBjdXN0b21TZWxlY3RGb2N1c1RleHQgPSBjdXN0b21TZWxlY3RGb2N1cy5xdWVyeVNlbGVjdG9yKCdzcGFuJyk7XG5jb25zdCBjdXN0b21TZWxlY3RPcHRpb25zQ29udGFpbmVyID0gY3VzdG9tU2VsZWN0LnF1ZXJ5U2VsZWN0b3IoJy5jdXN0b20tc2VsZWN0X19vcHRpb25zJyk7XG5sZXQgY3VzdG9tU2VsZWN0T3B0aW9ucyA9IFtdO1xuY29uc3QgY3VzdG9tU3BpbmJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5zcGluYnV0dG9uJyk7XG5jb25zdCBzcGluQnV0dG9uID0gY3VzdG9tU3BpbmJ1dHRvbi5xdWVyeVNlbGVjdG9yKCdbcm9sZT1cInNwaW5idXR0b25cIl0nKTtcbmNvbnN0IGRlY3JlYXNlU3BpbmJ1dHRvbiA9IGN1c3RvbVNwaW5idXR0b24ucXVlcnlTZWxlY3RvcignI2RlY3JlYXNlLXBlb3BsZScpO1xuY29uc3QgaW5jcmVhc2VTcGluYnV0dG9uID0gY3VzdG9tU3BpbmJ1dHRvbi5xdWVyeVNlbGVjdG9yKCcjaW5jcmVhc2UtcGVvcGxlJyk7XG5jb25zdCByZXNlcnZhdGlvbkZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucmVzZXJ2YXRpb24tZm9ybScpO1xuY29uc3QgbmFtZUlucHV0ID0gcmVzZXJ2YXRpb25Gb3JtLnF1ZXJ5U2VsZWN0b3IoJ2lucHV0W25hbWU9XCJuYW1lXCJdJyk7XG5jb25zdCBlbWFpbElucHV0ID0gcmVzZXJ2YXRpb25Gb3JtLnF1ZXJ5U2VsZWN0b3IoJ2lucHV0W25hbWU9XCJlbWFpbFwiXScpO1xuY29uc3QgbW9udGhJbnB1dCA9IHJlc2VydmF0aW9uRm9ybS5xdWVyeVNlbGVjdG9yKCdpbnB1dFtuYW1lPVwibW9udGhcIl0nKTtcbmNvbnN0IGRheUlucHV0ID0gcmVzZXJ2YXRpb25Gb3JtLnF1ZXJ5U2VsZWN0b3IoJ2lucHV0W25hbWU9XCJkYXlcIl0nKTtcbmNvbnN0IHllYXJJbnB1dCA9IHJlc2VydmF0aW9uRm9ybS5xdWVyeVNlbGVjdG9yKCdpbnB1dFtuYW1lPVwieWVhclwiXScpO1xuY29uc3QgaG91cklucHV0ID0gcmVzZXJ2YXRpb25Gb3JtLnF1ZXJ5U2VsZWN0b3IoJ2lucHV0W25hbWU9XCJob3VyXCJdJyk7XG5jb25zdCBtaW51dGVzSW5wdXQgPSByZXNlcnZhdGlvbkZvcm0ucXVlcnlTZWxlY3RvcignaW5wdXRbbmFtZT1cIm1pbnV0ZVwiXScpO1xuY29uc3QgcmVzZXJ2YXRpb25TdWJtaXRCdG4gPSByZXNlcnZhdGlvbkZvcm0ucXVlcnlTZWxlY3RvcignYnV0dG9uW3R5cGU9XCJzdWJtaXRcIl0nKTtcbmNvbnN0IENIRUNLX0lDT05fVVJMID0gJy4vZGlzdC9hc3NldHMvaW1hZ2VzL2ljb25zL2ljb24tY2hlY2suc3ZnJztcbmNvbnN0IEVNQUlMX1JFR0VYID0gL14oKFtePD4oKVtcXF1cXFxcLiw7Olxcc0BcIl0rKFxcLltePD4oKVtcXF1cXFxcLiw7Olxcc0BcIl0rKSopfChcIi4rXCIpKUAoKFxcW1swLTldezEsM31cXC5bMC05XXsxLDN9XFwuWzAtOV17MSwzfVxcLlswLTldezEsM31cXF0pfCgoW2EtekEtWlxcLTAtOV0rXFwuKStbYS16QS1aXXsyLH0pKSQvO1xuY29uc3QgREFZX1JFR0VYID0gL14oMFsxLTldKXwoWzEtMl1cXGQpfCgzWzAtMV0pJC87XG5jb25zdCBNQVhfREFZU19JTl9NT05USCA9IDMxO1xuY29uc3QgTU9OVEhfUkVHRVggPSAvXigwWzEtOV0pfCgxWzAtMl0pJC87XG5jb25zdCBZRUFSX1JFR0VYID0gL15cXGR7NH0kLztcbmNvbnN0IEhPVVJfUkVHRVggPSAvXigwWzEtOV0pfCgxWzAtMl0pJC87XG5jb25zdCBNSU5VVEVTX1JFR0VYID0gL14oWzAtNV1cXGQpJC87XG5jb25zdCBNT05EQVlfQ09ERSA9IDE7XG5jb25zdCBGUklEQVlfQ09ERSA9IDU7XG5jb25zdCBTQVRVUkRBWV9DT0RFID0gNjtcbmNvbnN0IFNVTkRBWV9DT0RFID0gMDtcbmNyZWF0ZUN1c3RvbVNlbGVjdE9wdGlvbnMoKTtcbm9yaWdpbmFsU2VsZWN0LmFkZEV2ZW50TGlzdGVuZXIoJ2tleXVwJywgKGUpID0+IHtcbiAgICBzd2l0Y2ggKGUua2V5KSB7XG4gICAgICAgIGNhc2UgJ0Fycm93VXAnOlxuICAgICAgICBjYXNlICdBcnJvd0Rvd24nOlxuICAgICAgICAgICAgaGFuZGxlU2VsZWN0aW9uKCk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAnRW50ZXInOlxuICAgICAgICAgICAgaGFuZGxlU2VsZWN0aW9uKCk7XG4gICAgICAgICAgICBjbG9zZUN1c3RvbVNlbGVjdCgpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgfVxufSk7XG5jdXN0b21TZWxlY3RGb2N1cy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7XG4gICAgb3JpZ2luYWxTZWxlY3QuZm9jdXMoKTtcbn0pO1xub3JpZ2luYWxTZWxlY3QuYWRkRXZlbnRMaXN0ZW5lcignZm9jdXNpbicsIG9wZW5DdXN0b21TZWxlY3QpO1xuc3BpbkJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgaGFuZGxlU3BpbkJ1dHRvbik7XG5pbmNyZWFzZVNwaW5idXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBpbmNyZWFzZVBlb3BsZSk7XG5kZWNyZWFzZVNwaW5idXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBkZWNyZWFzZVBlb3BsZSk7XG5yZXNlcnZhdGlvblN1Ym1pdEJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7XG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIHZhbGlkYXRlTmFtZSgpO1xuICAgIHZhbGlkYXRlRW1haWwoKTtcbiAgICB2YWxpZGF0ZURhdGUoKTtcbiAgICB2YWxpZGF0ZVRpbWUoKTtcbn0pO1xuZnVuY3Rpb24gY3JlYXRlQ3VzdG9tU2VsZWN0T3B0aW9ucygpIHtcbiAgICBvcmlnaW5hbFNlbGVjdE9wdGlvbnMuZm9yRWFjaChvcHRpb24gPT4ge1xuICAgICAgICBjb25zdCBjdXN0b21PcHRpb24gPSBjcmVhdGVDdXN0b21PcHRpb24ob3B0aW9uKTtcbiAgICAgICAgY3VzdG9tU2VsZWN0T3B0aW9ucy5wdXNoKGN1c3RvbU9wdGlvbik7XG4gICAgICAgIGN1c3RvbVNlbGVjdE9wdGlvbnNDb250YWluZXIuYXBwZW5kQ2hpbGQoY3VzdG9tT3B0aW9uKTtcbiAgICB9KTtcbn1cbmZ1bmN0aW9uIGNyZWF0ZUN1c3RvbU9wdGlvbihvcHRpb24pIHtcbiAgICBjb25zdCBvcHRpb25XcmFwcGVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpO1xuICAgIG9wdGlvbldyYXBwZXIuY2xhc3NMaXN0LmFkZCgnY3VzdG9tLXNlbGVjdF9fb3B0aW9uJyk7XG4gICAgb3B0aW9uV3JhcHBlci5zZXRBdHRyaWJ1dGUoJ2RhdGEtc2VsZWN0ZWQnLCBvcHRpb24uc2VsZWN0ZWQudG9TdHJpbmcoKSk7XG4gICAgb3B0aW9uV3JhcHBlci5zZXRBdHRyaWJ1dGUoJ2RhdGEtdmFsdWUnLCBvcHRpb24udmFsdWUpO1xuICAgIG9wdGlvbldyYXBwZXIuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBoYW5kbGVDdXN0b21PcHRpb24pO1xuICAgIGNvbnN0IGNoZWNrSW1hZ2UgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbWcnKTtcbiAgICBjaGVja0ltYWdlLnNldEF0dHJpYnV0ZSgnc3JjJywgQ0hFQ0tfSUNPTl9VUkwpO1xuICAgIGNoZWNrSW1hZ2Uuc2V0QXR0cmlidXRlKCdhbHQnLCAnJyk7XG4gICAgY29uc3Qgb3B0aW9uVGV4dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTtcbiAgICBvcHRpb25UZXh0LmlubmVyVGV4dCA9IG9wdGlvbi5pbm5lclRleHQ7XG4gICAgb3B0aW9uV3JhcHBlci5hcHBlbmRDaGlsZChjaGVja0ltYWdlKTtcbiAgICBvcHRpb25XcmFwcGVyLmFwcGVuZENoaWxkKG9wdGlvblRleHQpO1xuICAgIHJldHVybiBvcHRpb25XcmFwcGVyO1xufVxuZnVuY3Rpb24gaGFuZGxlQ3VzdG9tT3B0aW9uKGUpIHtcbiAgICBjb25zdCBvcHRpb24gPSBlLnRhcmdldDtcbiAgICBvcmlnaW5hbFNlbGVjdE9wdGlvbnMuZm9yRWFjaChvcHQgPT4gKG9wdC5zZWxlY3RlZCA9IG9wdC52YWx1ZSA9PT0gb3B0aW9uLmRhdGFzZXQudmFsdWUpKTtcbiAgICBoYW5kbGVTZWxlY3Rpb24oKTtcbiAgICBjbG9zZUN1c3RvbVNlbGVjdCgpO1xufVxuZnVuY3Rpb24gaGFuZGxlU2VsZWN0aW9uKCkge1xuICAgIGNvbnN0IHNlbGVjdGVkVmFsdWUgPSBvcmlnaW5hbFNlbGVjdE9wdGlvbnMuZmlsdGVyKG9wdCA9PiBvcHQuc2VsZWN0ZWQpWzBdLnZhbHVlO1xuICAgIGN1c3RvbVNlbGVjdEZvY3VzVGV4dC5pbm5lclRleHQgPSBzZWxlY3RlZFZhbHVlLnRvVXBwZXJDYXNlKCk7XG4gICAgY3VzdG9tU2VsZWN0T3B0aW9ucy5mb3JFYWNoKG9wdGlvbiA9PiB7XG4gICAgICAgIG9wdGlvbi5kYXRhc2V0LnNlbGVjdGVkID0gKG9wdGlvbi5kYXRhc2V0LnZhbHVlID09PSBzZWxlY3RlZFZhbHVlKS50b1N0cmluZygpO1xuICAgIH0pO1xufVxuZnVuY3Rpb24gb3BlbkN1c3RvbVNlbGVjdCgpIHtcbiAgICBjdXN0b21TZWxlY3QuZGF0YXNldC5vcGVuID0gJ3RydWUnO1xufVxuZnVuY3Rpb24gY2xvc2VDdXN0b21TZWxlY3QoKSB7XG4gICAgY3VzdG9tU2VsZWN0LmRhdGFzZXQub3BlbiA9ICdmYWxzZSc7XG59XG5mdW5jdGlvbiBoYW5kbGVTcGluQnV0dG9uKGUpIHtcbiAgICBzd2l0Y2ggKGUua2V5KSB7XG4gICAgICAgIGNhc2UgJ0Fycm93VXAnOlxuICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgaW5jcmVhc2VQZW9wbGUoKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICdBcnJvd0Rvd24nOlxuICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgZGVjcmVhc2VQZW9wbGUoKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICdIb21lJzpcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIHNldE1pblBlb3BsZSgpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgJ0VuZCc6XG4gICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICBzZXRNYXhQZW9wbGUoKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgIH1cbn1cbmZ1bmN0aW9uIGluY3JlYXNlUGVvcGxlKCkge1xuICAgIGNvbnN0IGN1cnJlbnRWYWx1ZSA9IE51bWJlcihzcGluQnV0dG9uLmdldEF0dHJpYnV0ZSgnYXJpYS12YWx1ZW5vdycpKTtcbiAgICBjb25zdCBtYXhWYWx1ZSA9IE51bWJlcihzcGluQnV0dG9uLmdldEF0dHJpYnV0ZSgnYXJpYS12YWx1ZW1heCcpKTtcbiAgICBjb25zdCBuZXdWYWx1ZSA9IE1hdGgubWluKGN1cnJlbnRWYWx1ZSArIDEsIG1heFZhbHVlKTtcbiAgICB1cGRhdGVTcGluQnV0dG9uKG5ld1ZhbHVlKTtcbn1cbmZ1bmN0aW9uIGRlY3JlYXNlUGVvcGxlKCkge1xuICAgIGNvbnN0IGN1cnJlbnRWYWx1ZSA9IE51bWJlcihzcGluQnV0dG9uLmdldEF0dHJpYnV0ZSgnYXJpYS12YWx1ZW5vdycpKTtcbiAgICBjb25zdCBtaW5WYWx1ZSA9IE51bWJlcihzcGluQnV0dG9uLmdldEF0dHJpYnV0ZSgnYXJpYS12YWx1ZW1pbicpKTtcbiAgICBjb25zdCBuZXdWYWx1ZSA9IE1hdGgubWF4KGN1cnJlbnRWYWx1ZSAtIDEsIG1pblZhbHVlKTtcbiAgICB1cGRhdGVTcGluQnV0dG9uKG5ld1ZhbHVlKTtcbn1cbmZ1bmN0aW9uIHNldE1heFBlb3BsZSgpIHtcbiAgICBjb25zdCBtYXhWYWx1ZSA9IE51bWJlcihzcGluQnV0dG9uLmdldEF0dHJpYnV0ZSgnYXJpYS12YWx1ZW1heCcpKTtcbiAgICB1cGRhdGVTcGluQnV0dG9uKG1heFZhbHVlKTtcbn1cbmZ1bmN0aW9uIHNldE1pblBlb3BsZSgpIHtcbiAgICBjb25zdCBtaW5WYWx1ZSA9IE51bWJlcihzcGluQnV0dG9uLmdldEF0dHJpYnV0ZSgnYXJpYS12YWx1ZW1pbicpKTtcbiAgICB1cGRhdGVTcGluQnV0dG9uKG1pblZhbHVlKTtcbn1cbmZ1bmN0aW9uIHVwZGF0ZVNwaW5CdXR0b24obmV3VmFsdWUpIHtcbiAgICBzcGluQnV0dG9uLnNldEF0dHJpYnV0ZSgnYXJpYS12YWx1ZW5vdycsIG5ld1ZhbHVlLnRvU3RyaW5nKCkpO1xuICAgIHNwaW5CdXR0b24uc2V0QXR0cmlidXRlKCdhcmlhLXZhbHVldGV4dCcsIGAke25ld1ZhbHVlfSBwZW9wbGVgKTtcbiAgICBzcGluQnV0dG9uLmlubmVyVGV4dCA9IGAke25ld1ZhbHVlfSBwZW9wbGVgO1xufVxuZnVuY3Rpb24gdmFsaWRhdGVOYW1lKCkge1xuICAgIGNvbnN0IG5hbWVWYWx1ZSA9IG5hbWVJbnB1dC52YWx1ZTtcbiAgICBpZiAoaXNCbGFuayhuYW1lVmFsdWUpKVxuICAgICAgICByZXR1cm4gZGlzcGxheUZvcm1FcnJvcihuYW1lSW5wdXQsICdUaGlzIGZpZWxkIGlzIHJlcXVpcmVkJyk7XG4gICAgcmV0dXJuIHJlbW92ZUZvcm1FcnJvcihuYW1lSW5wdXQpO1xufVxuZnVuY3Rpb24gdmFsaWRhdGVFbWFpbCgpIHtcbiAgICBjb25zdCBlbWFpbFZhbHVlID0gZW1haWxJbnB1dC52YWx1ZTtcbiAgICBpZiAoaXNCbGFuayhlbWFpbFZhbHVlKSlcbiAgICAgICAgcmV0dXJuIGRpc3BsYXlGb3JtRXJyb3IoZW1haWxJbnB1dCwgJ1RoaXMgZmllbGQgaXMgcmVxdWlyZWQnKTtcbiAgICBpZiAoIWlzVmFsaWRFbWFpbChlbWFpbFZhbHVlKSlcbiAgICAgICAgcmV0dXJuIGRpc3BsYXlGb3JtRXJyb3IoZW1haWxJbnB1dCwgJ1Byb3ZpZGUgYSB2YWxpZCBlbWFpbCBhZGRyZXNzJyk7XG4gICAgcmV0dXJuIHJlbW92ZUZvcm1FcnJvcihlbWFpbElucHV0KTtcbn1cbmZ1bmN0aW9uIGlzVmFsaWRFbWFpbChlbWFpbCkge1xuICAgIHJldHVybiBFTUFJTF9SRUdFWC50ZXN0KGVtYWlsKTtcbn1cbmZ1bmN0aW9uIHZhbGlkYXRlRGF0ZSgpIHtcbiAgICBpZiAodmFsaWRhdGVEYXkoKSAmJiB2YWxpZGF0ZU1vbnRoKCkgJiYgdmFsaWRhdGVZZWFyKCkpIHtcbiAgICAgICAgY29uc3QgZGF5ID0gTnVtYmVyKGRheUlucHV0LnZhbHVlKTtcbiAgICAgICAgY29uc3QgbW9udGggPSBOdW1iZXIobW9udGhJbnB1dC52YWx1ZSk7XG4gICAgICAgIGNvbnN0IHllYXIgPSBOdW1iZXIoeWVhcklucHV0LnZhbHVlKTtcbiAgICAgICAgaWYgKCFpc0RhdGVBZnRlclRvZGF5KHllYXIsIG1vbnRoLCBkYXkpKVxuICAgICAgICAgICAgcmV0dXJuIGRpc3BsYXlGb3JtRXJyb3IoeWVhcklucHV0LCAnSW5zZXJ0IGRhdGUgYWZ0ZXIgdG9kYXknKTtcbiAgICAgICAgcmV0dXJuIHJlbW92ZUZvcm1FcnJvcih5ZWFySW5wdXQpO1xuICAgIH1cbiAgICByZXR1cm4gZmFsc2U7XG59XG5mdW5jdGlvbiB2YWxpZGF0ZURheSgpIHtcbiAgICBjb25zdCBkYXlWYWx1ZSA9IGRheUlucHV0LnZhbHVlO1xuICAgIGlmIChpc0JsYW5rKGRheVZhbHVlKSlcbiAgICAgICAgcmV0dXJuIGRpc3BsYXlGb3JtRXJyb3IoZGF5SW5wdXQsICdUaGlzIGZpZWxkIGlzIGluY29tcGxldGUnKTtcbiAgICBpZiAoIWlzVmFsaWREYXkoZGF5VmFsdWUpKVxuICAgICAgICByZXR1cm4gZGlzcGxheUZvcm1FcnJvcihkYXlJbnB1dCwgJ0luc2VydCB2YWxpZCBkYXkgdmFsdWUgKDAxIC0gMzEpJyk7XG4gICAgaWYgKCFpc0RheVdpdGhpbk1vbnRoUmFuZ2UoZGF5VmFsdWUpKVxuICAgICAgICByZXR1cm4gZGlzcGxheUZvcm1FcnJvcihkYXlJbnB1dCwgJ0luc2VydCBkYXkgaW4gcmFuZ2Ugb2Ygc2VsZWN0ZWQgbW9udGguJyk7XG4gICAgcmV0dXJuIHJlbW92ZUZvcm1FcnJvcihkYXlJbnB1dCk7XG59XG5mdW5jdGlvbiBpc0RhdGVBZnRlclRvZGF5KHllYXIsIG1vbnRoLCBkYXkpIHtcbiAgICByZXR1cm4gbmV3IERhdGUoeWVhciwgbW9udGggLSAxLCBkYXkpID4gbmV3IERhdGUoKTtcbn1cbmZ1bmN0aW9uIGlzRGF5V2l0aGluTW9udGhSYW5nZShkYXkpIHtcbiAgICBjb25zdCBtb250aCA9IG1vbnRoSW5wdXQudmFsdWU7XG4gICAgY29uc3QgeWVhciA9IHllYXJJbnB1dC52YWx1ZTtcbiAgICBpZiAoIXllYXIgfHwgIW1vbnRoKVxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICBjb25zdCBtb250aERheXMgPSBuZXcgRGF0ZShOdW1iZXIoeWVhciksIE51bWJlcihtb250aCksIDApLmdldERhdGUoKSB8fCBNQVhfREFZU19JTl9NT05USDtcbiAgICByZXR1cm4gTnVtYmVyKGRheSkgPD0gbW9udGhEYXlzO1xufVxuZnVuY3Rpb24gdmFsaWRhdGVNb250aCgpIHtcbiAgICBjb25zdCBtb250aFZhbHVlID0gbW9udGhJbnB1dC52YWx1ZTtcbiAgICBpZiAoaXNCbGFuayhtb250aFZhbHVlKSlcbiAgICAgICAgcmV0dXJuIGRpc3BsYXlGb3JtRXJyb3IobW9udGhJbnB1dCwgJ1RoaXMgZmllbGQgaXMgaW5jb21wbGV0ZScpO1xuICAgIGlmICghaXNWYWxpZE1vbnRoKG1vbnRoVmFsdWUpKVxuICAgICAgICByZXR1cm4gZGlzcGxheUZvcm1FcnJvcihtb250aElucHV0LCAnSW5zZXJ0IHZhbGlkIG1vbnRoIHZhbHVlICgwMSAtIDEyKScpO1xuICAgIHJldHVybiByZW1vdmVGb3JtRXJyb3IobW9udGhJbnB1dCk7XG59XG5mdW5jdGlvbiB2YWxpZGF0ZVllYXIoKSB7XG4gICAgY29uc3QgeWVhclZhbHVlID0geWVhcklucHV0LnZhbHVlO1xuICAgIGlmIChpc0JsYW5rKHllYXJWYWx1ZSkpXG4gICAgICAgIHJldHVybiBkaXNwbGF5Rm9ybUVycm9yKHllYXJJbnB1dCwgJ1RoaXMgZmllbGQgaXMgaW5jb21wbGV0ZScpO1xuICAgIGlmICghaXNWYWxpZFllYXIoeWVhclZhbHVlKSlcbiAgICAgICAgcmV0dXJuIGRpc3BsYXlGb3JtRXJyb3IoeWVhcklucHV0LCAnSW5zZXJ0IHZhbGlkIHllYXIgKDQgZGlnaXQgbnVtYmVyKScpO1xuICAgIHJldHVybiByZW1vdmVGb3JtRXJyb3IoeWVhcklucHV0KTtcbn1cbmZ1bmN0aW9uIGlzVmFsaWREYXkoZGF5KSB7XG4gICAgcmV0dXJuIERBWV9SRUdFWC50ZXN0KGRheSk7XG59XG5mdW5jdGlvbiBpc1ZhbGlkTW9udGgobW9udGgpIHtcbiAgICByZXR1cm4gTU9OVEhfUkVHRVgudGVzdChtb250aCk7XG59XG5mdW5jdGlvbiBpc1ZhbGlkWWVhcih5ZWFyKSB7XG4gICAgcmV0dXJuIFlFQVJfUkVHRVgudGVzdCh5ZWFyKTtcbn1cbmZ1bmN0aW9uIHZhbGlkYXRlVGltZSgpIHtcbiAgICBpZiAodmFsaWRhdGVIb3VyKCkgJiYgdmFsaWRhdGVNaW51dGVzKCkpIHtcbiAgICAgICAgaWYgKCFpc1RpbWVCZXR3ZWVuT3BlbkhvdXJzKCkpXG4gICAgICAgICAgICByZXR1cm4gZGlzcGxheUZvcm1FcnJvcihob3VySW5wdXQsICdJbnNlcnQgdGltZSBiZXR3ZWVuIG9wZW4gaG91cnMnKTtcbiAgICAgICAgcmV0dXJuIHJlbW92ZUZvcm1FcnJvcihob3VySW5wdXQpO1xuICAgIH1cbiAgICByZXR1cm4gZmFsc2U7XG59XG5mdW5jdGlvbiBpc1RpbWVCZXR3ZWVuT3BlbkhvdXJzKCkge1xuICAgIGNvbnN0IGhvdXIgPSBOdW1iZXIoaG91cklucHV0LnZhbHVlKTtcbiAgICBjb25zdCBtaW51dGVzID0gTnVtYmVyKG1pbnV0ZXNJbnB1dC52YWx1ZSk7XG4gICAgY29uc3QgZGF0ZSA9IG5ldyBEYXRlKE51bWJlcih5ZWFySW5wdXQudmFsdWUpLCBOdW1iZXIobW9udGhJbnB1dC52YWx1ZSkgLSAxLCBOdW1iZXIoZGF5SW5wdXQudmFsdWUpKTtcbiAgICBjb25zdCB3ZWVrRGF5ID0gZGF0ZS5nZXREYXkoKTtcbiAgICBjb25zdCBkYXlUaW1lID0gb3JpZ2luYWxTZWxlY3QudmFsdWU7XG4gICAgaWYgKE51bWJlci5pc05hTihob3VyKSB8fCBOdW1iZXIuaXNOYU4obWludXRlcykpXG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICBpZiAoTnVtYmVyLmlzTmFOKHdlZWtEYXkpKVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgaWYgKGRheVRpbWUgPT09ICdhbScpXG4gICAgICAgIHJldHVybiBpc0JldHdlZW5Nb3JuaW5nSG91cnMoaG91cik7XG4gICAgZWxzZVxuICAgICAgICByZXR1cm4gaXNCZXR3ZWVuQWZ0ZXJub29uSG91cnMoaG91ciwgbWludXRlcywgd2Vla0RheSk7XG59XG5mdW5jdGlvbiBpc0JldHdlZW5Nb3JuaW5nSG91cnMoaG91cikge1xuICAgIHJldHVybiBob3VyID49IDkgJiYgaG91ciA8IDEyO1xufVxuZnVuY3Rpb24gaXNCZXR3ZWVuQWZ0ZXJub29uSG91cnMoaG91ciwgbWludXRlcywgd2Vla0RheUNvZGUpIHtcbiAgICBpZiAod2Vla0RheUNvZGUgPD0gRlJJREFZX0NPREUgJiYgd2Vla0RheUNvZGUgPj0gTU9OREFZX0NPREUpIHtcbiAgICAgICAgcmV0dXJuIGhvdXIgPT09IDEyIHx8IGhvdXIgPCAxMDtcbiAgICB9XG4gICAgaWYgKHdlZWtEYXlDb2RlID09PSBTQVRVUkRBWV9DT0RFIHx8IHdlZWtEYXlDb2RlID09PSBTVU5EQVlfQ09ERSkge1xuICAgICAgICByZXR1cm4gaG91ciA9PT0gMTIgfHwgaG91ciA8IDExIHx8IChob3VyID09PSAxMSAmJiBtaW51dGVzIDwgMzApO1xuICAgIH1cbiAgICByZXR1cm4gdHJ1ZTtcbn1cbmZ1bmN0aW9uIHZhbGlkYXRlSG91cigpIHtcbiAgICBjb25zdCBob3VyVmFsdWUgPSBob3VySW5wdXQudmFsdWU7XG4gICAgaWYgKGlzQmxhbmsoaG91clZhbHVlKSlcbiAgICAgICAgcmV0dXJuIGRpc3BsYXlGb3JtRXJyb3IoaG91cklucHV0LCAnVGhpcyBmaWVsZCBpcyBpbmNvbXBsZXRlJyk7XG4gICAgaWYgKCFpc1ZhbGlkSG91cihob3VyVmFsdWUpKVxuICAgICAgICByZXR1cm4gZGlzcGxheUZvcm1FcnJvcihob3VySW5wdXQsICdJbnNlcnQgdmFsaWQgaG91ciBmb3JtYXQgKDAxIC0gMTIpJyk7XG4gICAgcmV0dXJuIHJlbW92ZUZvcm1FcnJvcihob3VySW5wdXQpO1xufVxuZnVuY3Rpb24gdmFsaWRhdGVNaW51dGVzKCkge1xuICAgIGNvbnN0IG1pbnV0ZXNWYWx1ZSA9IG1pbnV0ZXNJbnB1dC52YWx1ZTtcbiAgICBpZiAoaXNCbGFuayhtaW51dGVzVmFsdWUpKVxuICAgICAgICByZXR1cm4gZGlzcGxheUZvcm1FcnJvcihtaW51dGVzSW5wdXQsICdUaGlzIGZpZWxkIGlzIGluY29tcGxldGUnKTtcbiAgICBpZiAoIWFyZVZhbGlkTWludXRlcyhtaW51dGVzVmFsdWUpKVxuICAgICAgICByZXR1cm4gZGlzcGxheUZvcm1FcnJvcihtaW51dGVzSW5wdXQsICdJbnNlcnQgdmFsaWQgbWludXRlcyBmb3JtYXQgKDAwIC0gNTkpJyk7XG4gICAgcmV0dXJuIHJlbW92ZUZvcm1FcnJvcihtaW51dGVzSW5wdXQpO1xufVxuZnVuY3Rpb24gaXNWYWxpZEhvdXIoaG91cikge1xuICAgIHJldHVybiBIT1VSX1JFR0VYLnRlc3QoaG91cik7XG59XG5mdW5jdGlvbiBhcmVWYWxpZE1pbnV0ZXMobWludXRlcykge1xuICAgIHJldHVybiBNSU5VVEVTX1JFR0VYLnRlc3QobWludXRlcyk7XG59XG5mdW5jdGlvbiBpc0JsYW5rKHZhbHVlKSB7XG4gICAgcmV0dXJuIHZhbHVlID09PSAnJztcbn1cbmZ1bmN0aW9uIGRpc3BsYXlGb3JtRXJyb3IoaW5wdXQsIG1lc3NhZ2UpIHtcbiAgICBsZXQgZm9ybUdyb3VwID0gaW5wdXQuY2xvc2VzdCgnLmZvcm0tZ3JvdXAnKTtcbiAgICBsZXQgZm9ybUVycm9yO1xuICAgIHdoaWxlIChmb3JtR3JvdXApIHtcbiAgICAgICAgZm9ybUdyb3VwLmNsYXNzTGlzdC5hZGQoJ2Vycm9yJyk7XG4gICAgICAgIGZvcm1FcnJvciA9IGZvcm1Hcm91cC5xdWVyeVNlbGVjdG9yKCcuZm9ybS1lcnJvcicpO1xuICAgICAgICBpZiAoZm9ybUVycm9yKSB7XG4gICAgICAgICAgICBmb3JtRXJyb3IuaW5uZXJUZXh0ID0gbWVzc2FnZTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIGZvcm1Hcm91cCA9IGZvcm1Hcm91cC5wYXJlbnRFbGVtZW50LmNsb3Nlc3QoJy5mb3JtLWdyb3VwJyk7XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcbn1cbmZ1bmN0aW9uIHJlbW92ZUZvcm1FcnJvcihpbnB1dCkge1xuICAgIGxldCBmb3JtR3JvdXAgPSBpbnB1dC5jbG9zZXN0KCcuZm9ybS1ncm91cCcpO1xuICAgIGxldCBmb3JtRXJyb3I7XG4gICAgd2hpbGUgKGZvcm1Hcm91cCkge1xuICAgICAgICBmb3JtR3JvdXAuY2xhc3NMaXN0LnJlbW92ZSgnZXJyb3InKTtcbiAgICAgICAgZm9ybUVycm9yID0gZm9ybUdyb3VwLnF1ZXJ5U2VsZWN0b3IoJy5mb3JtLWVycm9yJyk7XG4gICAgICAgIGlmIChmb3JtRXJyb3IpXG4gICAgICAgICAgICBmb3JtRXJyb3IuaW5uZXJUZXh0ID0gJyc7XG4gICAgICAgIGZvcm1Hcm91cCA9IGZvcm1Hcm91cC5wYXJlbnRFbGVtZW50LmNsb3Nlc3QoJy5mb3JtLWdyb3VwJyk7XG4gICAgfVxuICAgIHJldHVybiB0cnVlO1xufVxuIl19
